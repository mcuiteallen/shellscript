CREATE USER 'root'@'%' IDENTIFIED BY 'InSnergyDB66073888';
GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;
FLUSH PRIVILEGES;

CREATE USER 'insnergydb'@'localhost' IDENTIFIED BY 'InSnergyDB66073888';
GRANT ALL PRIVILEGES ON *.* TO 'insnergydb'@'localhost' WITH GRANT OPTION;
FLUSH PRIVILEGES;

CREATE USER 'insnergydb'@'%' IDENTIFIED BY 'InSnergyDB66073888';
GRANT ALL PRIVILEGES ON *.* TO 'insnergydb'@'%' WITH GRANT OPTION;
FLUSH PRIVILEGES;



DROP DATABASE IF EXISTS insnergydb;
CREATE DATABASE IF NOT EXISTS insnergydb DEFAULT CHARACTER SET UTF8 COLLATE utf8_general_ci;
USE `insnergydb`;

SET FOREIGN_KEY_CHECKS=0;
-- APPCONFIG
CREATE TABLE APPCONFIG (
       CONFIGKEY VARCHAR(20) NOT NULL
     , CONFIGVALUE VARCHAR(256)
     , CONFIGMEMO VARCHAR(256)
     , CONSTRAINT PK_APPCONFIG PRIMARY KEY (CONFIGKEY)
);

-- APPLOGINLOG
CREATE TABLE APPLOGINLOG (
       SEQUENCEID BIGINT NOT NULL AUTO_INCREMENT
     , CUSTOMERID VARCHAR(80) NOT NULL
     , LOGINTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , STATUS CHAR(1) NOT NULL
     , REMOTEIP VARCHAR(39) NOT NULL
     , SERVERIP VARCHAR(39) NOT NULL
     , CONTEXTPATH VARCHAR(15) NOT NULL
     , USERID BIGINT NULL
     , CONSTRAINT PK_APPLOGINLOG PRIMARY KEY (SEQUENCEID)
);
CREATE INDEX IX_APPLOGINLOG_1 ON APPLOGINLOG (LOGINTIME ASC, CUSTOMERID ASC, STATUS ASC);

-- DOMAININFO
CREATE TABLE DOMAININFO(
     DOMAIN VARCHAR(64) NOT NULL
   , PREFIX VARCHAR(20) NOT NULL
   , DEFAULT_THEME INT DEFAULT 1
   , CUSTOMER_PIC INT DEFAULT 0
   , INDEX_TEMP INT DEFAULT 1
   , INDEX_URL VARCHAR(256)
   , LOGIN_INDEX_URL VARCHAR(20)
   , LANGUAGE VARCHAR(20)
   , ISFULLINDEX INT DEFAULT 0
   , TITLE VARCHAR(64)
   , MIN_HEIGHT INT
   , FB_URL VARCHAR(256)
   , FILM_URL VARCHAR(256)
   , SLOGAN VARCHAR(128)
   , CONTACT VARCHAR(64)
   , LOGIN_TYPE INT DEFAULT 1 NOT NULL
   , FOOTER_CONTENT  VARCHAR(256) NOT NULL
   , CONSTRAINT PK_DOMAININFO PRIMARY KEY (DOMAIN)
);

-- CUSTOMERINFO
CREATE TABLE CUSTOMERINFO (
	   CUSTOMERID VARCHAR(64) CHARACTER SET UTF8 COLLATE UTF8_BIN NOT NULL
	 , CUSTOMERPWD VARCHAR(32) CHARACTER SET UTF8 COLLATE UTF8_BIN DEFAULT NULL
     , CUSTOMERNAME VARCHAR(100)
     , ADDRESS VARCHAR(200)
     , MOBILEPHONE VARCHAR(15)
     , EMAIL VARCHAR(64)
     , ISEMAIL CHAR(1) DEFAULT '0'
     , ISSMS CHAR(1) DEFAULT '0'
     , ISENABLE CHAR(1)
     , ROLE CHAR(1)
     , UPDATETIME TIMESTAMP NULL DEFAULT '0000-00-00 00:00:00'
     , LASTLOGIN TIMESTAMP NULL DEFAULT '0000-00-00 00:00:00'
     , MSN VARCHAR(64)
     , ORGID VARCHAR(20)
     , CREATETIME TIMESTAMP NULL
     , ACCOUNTTYPE VARCHAR(1)
     , EXPIREDAYS INT
     , AREA_ACC_ID BIGINT
     , ACTIVECODE VARCHAR(150)
     , APTYPE VARCHAR(10)
     , TIMEZONE VARCHAR(9)
     , TELEPHONE VARCHAR(15)
     , PICTURE VARCHAR(64)
     , ORGANIZATIONNAME VARCHAR(30)
     , DEPARTMENT VARCHAR(30)
     , POSITION VARCHAR(30)
     , OFFICALPHONE VARCHAR(15)
	 , ENABLESTATUS VARCHAR(1) DEFAULT '1'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	 , STARTDAY TIMESTAMP NULL
     , ENDDAY TIMESTAMP NULL
     , WIDGETIDS VARCHAR(30) NULL
     , PIPN_EDITION VARCHAR(8) NULL
     , LOCALECODE VARCHAR(8) NULL
     , CONSTRAINT PK_CUSTOMERINFO PRIMARY KEY (CUSTOMERID)
     -- , CONSTRAINT FK_CUSTOMERINFO_1 FOREIGN KEY (ORGID) REFERENCES ORGANIZATIONINFO (ORGID)
);
-- CREATE INDEX IX_CUSTOMERINFO_1 ON CUSTOMERINFO (ORGID ASC);


-- CUSTOMERROLE
CREATE TABLE CUSTOMERROLE (
	   CUSTOMERID VARCHAR(64) CHARACTER SET UTF8 COLLATE UTF8_BIN NOT NULL
     , ROLEID BIGINT NOT NULL
     , CONSTRAINT PK_CUSTOMERROLE PRIMARY KEY (CUSTOMERID, ROLEID)
     , CONSTRAINT FK_CUSTOMERROLE_1 FOREIGN KEY (CUSTOMERID)
                  REFERENCES CUSTOMERINFO (CUSTOMERID)
     , CONSTRAINT FK_CUSTOMERROLE_2 FOREIGN KEY (ROLEID)
                  REFERENCES IN_ROLEINFO (ROLEID)
);
CREATE INDEX IX_CUSTOMERROLE_1 ON CUSTOMERROLE (CUSTOMERID ASC);
CREATE INDEX IX_CUSTOMERROLE_2 ON CUSTOMERROLE (ROLEID ASC);

-- GROUPINFO
CREATE TABLE GROUPINFO (
       GROUPID BIGINT NOT NULL AUTO_INCREMENT
     , GROUPNAME VARCHAR(100)
     , PARENTGROUP BIGINT
     , UPDATETIME TIMESTAMP
     , EDITMETERMAP CHAR(1) DEFAULT '0'
     , METERMAP VARCHAR(30)
     , ADDRESS VARCHAR(200)
     , CITY VARCHAR(20)
     , REGION VARCHAR(5)
     , TEL1 VARCHAR(15)
     , TEL2 VARCHAR(15)
     , FAX VARCHAR(15)
     , POSTCODE VARCHAR(10)
     , LATITUDE DECIMAL(20,6)
     , LONGITUDE DECIMAL(20,6)
     , APPTYPE CHAR(2) -- 01:EMS2.1 02:HEMS 03:BEMS 04:LCMS
     , GROUPDESCRIPTION VARCHAR(100)
     , GROUPTYPE CHAR(1) DEFAULT '0'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0'
     , ENABLESTATUS VARCHAR(1) DEFAULT '1' NOT NULL
     , STATE VARCHAR(100)  NULL
     , ZIPCODE VARCHAR(20) NULL
     , ADDRESS2 VARCHAR(200)
     , CREATETIME TIMESTAMP  NOT NULL
     , GROUPCATEGORY VARCHAR(1) DEFAULT '0' NOT NULL
	 , TIMEZONE VARCHAR(20) DEFAULT 'GMT+08:00' NOT NULL
     , ZONEID VARCHAR(100) DEFAULT 'ASIA/TAIPEI' NOT NULL
     , APCATEGORY VARCHAR(10) DEFAULT 'E' NOT NULL
     , CONSTRAINT PK_GROUPINFO PRIMARY KEY (GROUPID)
     , CONSTRAINT FK_GROUPINFO_1 FOREIGN KEY (PARENTGROUP)
                  REFERENCES GROUPINFO (GROUPID)
);
CREATE INDEX IX_GROUPINFO_1 ON GROUPINFO (PARENTGROUP ASC);


CREATE TABLE GROUPTARGETINFO (
       TARGETID VARCHAR(6) NOT NULL
     , TARGETCOST DECIMAL(20,6)
     , TARGETENERGY DECIMAL(20,6)
	 , GROUPID BIGINT NOT NULL
     , UPDATETIME TIMESTAMP NOT NULL
     , SETTYPE SMALLINT
     , SETPERCENT SMALLINT
     , REFYEAR VARCHAR(20)
     , GROUPTARGETID BIGINT NOT NULL
     , VIEWPOINTID BIGINT
     , TARGETCAPACITY NUMERIC(20,6) NULL
     , CONSTRAINT PK_GROUPTARGETINFO PRIMARY KEY (TARGETID,GROUPID)
     , CONSTRAINT FK_GROUPTARGETINFO_1 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
);
CREATE INDEX IX_GROUPTARGETINFO_1 ON GROUPTARGETINFO (GROUPID ASC);

-- GROUPEXTINFO
CREATE TABLE GROUPEXTINFO  (
       GROUPID BIGINT NOT NULL
     , UPDATETIME TIMESTAMP
     , ADDRESS VARCHAR(200)
     , CITY VARCHAR(30)
	 , REGION VARCHAR(300)
	 , TEL1 VARCHAR(15)
	 , TEL2 VARCHAR(15)
	 , FAX VARCHAR(15)
	 , POSTCODE VARCHAR(10)
	 , LATITUDE DECIMAL(20,6)
	 , LONGITUDE DECIMAL(20,6)
	 , GROUPDESCRIPTION VARCHAR(100)
	 , PICTURE VARCHAR(64)
	 , APPLICATION VARCHAR(60)
	 , ATLASIP VARCHAR(20) NULL
	 , CELL_NUMBER BIGINT NULL
     , CELL_CAPACITY NUMERIC(20,6) NULL
     , CARBON_EMISSION NUMERIC(20,6) NULL
     , ELECTRICITYCOST NUMERIC(20,6) NULL
	 , POSX BIGINT             NULL
	 , POSY BIGINT             NULL
	 , MAPPICTURE VARCHAR(64) NULL
	 , GUIDE  VARCHAR(64)  NULL
     , CONSTRAINT PK_GROUPEXTINFO PRIMARY KEY (GROUPID)
	 , CONSTRAINT FK_GROUPEXTINFO_1 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
);

-- GROUPPARAMETER
CREATE TABLE GROUPPARAMETER (
	  OLDGROUPID VARCHAR(20)
	, SPACE DECIMAL(20,6)
	, CONTRACTDEMAND INT
	, TARGETCOST DECIMAL(20,6)
	, TARGETENERGY DECIMAL(20,6)
	, TARGETAVGRATE  DECIMAL(20,6)
	, TARGETEUI  DECIMAL(20,6)
	, UPDATETIME TIMESTAMP
	, GROUPID BIGINT NOT NULL
	, GROUNDFLOOR VARCHAR(5) DEFAULT '0' NOT NULL
	, UNDERGROUNDFLOOR VARCHAR(5) DEFAULT '0' NOT NULL
	, USERS   BIGINT  NULL
	, CONSTRAINT PK_GROUPPARAMETER PRIMARY KEY (GROUPID)
	, CONSTRAINT FK_GROUPPARAMETER_1 FOREIGN KEY (GROUPID)
  			 REFERENCES GROUPINFO (GROUPID)
);

-- GROUPMEMBER
CREATE TABLE GROUPMEMBER (
       CUSTOMERID VARCHAR(64) CHARACTER SET UTF8 COLLATE UTF8_BIN NOT NULL
     , GROUPID BIGINT NOT NULL
     , APTYPE CHAR(2)
     , CONSTRAINT PK_GROUPMEMBER PRIMARY KEY (GROUPID, CUSTOMERID)
     , CONSTRAINT FK_GROUPMEMBER_1 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
);
CREATE INDEX IX_GROUPMEMBER_1 ON GROUPMEMBER (GROUPID ASC);
CREATE INDEX IX_GROUPMEMBER_2 ON GROUPMEMBER (CUSTOMERID ASC);




-- NEWGROUPINFO
CREATE TABLE NEWGROUPINFO(
	 ID	BIGINT	NOT NULL AUTO_INCREMENT
	,PARENTID	BIGINT	NULL
	,GROUPTYPE	INT	NULL
	,APCATEGORY	VARCHAR(10)	NOT NULL
	,APSYSTEM	VARCHAR(10)	DEFAULT '0' NOT NULL
	,NAME	VARCHAR(255)	NULL
	,DESCRIPTION	VARCHAR(100)	NULL
	,COUNTRY	CHAR(3)	NULL
	,STATE	VARCHAR(100)	NULL
	,CITY	VARCHAR(100)	NULL
	,ZIPCODE	VARCHAR(20)	NULL
	,ADDRESS1	VARCHAR(200)	NULL
	,ADDRESS2	VARCHAR(200)	NULL
	,LATITUDE	DECIMAL(20,6)	NULL
	,LONGITUDE	DECIMAL(20,6)	NULL
	,TEL1	VARCHAR(30)	NULL
	,TEL2	VARCHAR(30)	NULL
	,FAX	VARCHAR(30)	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,CREATETIME	TIMESTAMP	NOT NULL
	,CONSTRAINT PK_NEWGROUPINFO PRIMARY KEY (ID)
	,CONSTRAINT FK_NEWGROUPINFO_1 FOREIGN KEY (PARENTID)
				REFERENCES NEWGROUPINFO(ID)
);
CREATE UNIQUE INDEX UQ_NEWGROUPINFO_1 ON NEWGROUPINFO(APCATEGORY ASC,APSYSTEM ASC, NAME ASC);

CREATE TABLE PLANINFO (
   PLANID        BIGINT      NOT NULL
  ,GROUPID      BIGINT      NOT NULL
    ,PLANNAME           VARCHAR(64)   NOT NULL
    ,CONTROLTYPE        CHAR(1)  DEFAULT '1' NOT NULL
    ,SCHEDULEACCURACY   BIGINT  DEFAULT '15' NOT NULL
    ,REPORTFREQUENCY    BIGINT  DEFAULT '15' NOT NULL
    ,STATISTICS_HOUR    BIGINT  DEFAULT '1' NOT NULL
    ,STATISTICS_DAY     BIGINT  DEFAULT '1' NOT NULL
    ,STATISTICS_WEEK    BIGINT  DEFAULT '0' NOT NULL
    ,STATISTICS_MONTH   BIGINT  DEFAULT '2' NOT NULL
    ,STATISTICS_YEAR    BIGINT  DEFAULT '0' NOT NULL
    ,NOTICEMASK         BIGINT  DEFAULT '1' NOT NULL
    ,NOTICECOUNT        BIGINT  DEFAULT '1' NOT NULL
    ,PLANUPPERLIMIT     BIGINT  DEFAULT '1' NOT NULL
    ,MUTIPLECONDITION   CHAR(1)  DEFAULT '0' NOT NULL
    ,POSITION           CHAR(1)  DEFAULT '0' NOT NULL
    ,POWERSAVING        CHAR(1)  DEFAULT '0' NOT NULL
  ,CONSTRAINT PK_PLANINFO_1 PRIMARY KEY (PLANID)
  ,CONSTRAINT FK_PLANINFO_1 FOREIGN KEY (GROUPID)
          REFERENCES GROUPINFO(GROUPID)
);


-- USERINFO
CREATE TABLE USERINFO (
	 ID	BIGINT	NOT NULL AUTO_INCREMENT
	,APCATEGORY	VARCHAR(10)	NOT NULL
	,APSYSTEM	VARCHAR(10)	DEFAULT '0' NOT NULL
	,GROUPID	BIGINT NULL
	,USERNAME	VARCHAR(255) CHARACTER SET UTF8 COLLATE UTF8_BIN NOT NULL
	,PASSWORD	VARCHAR(32)	CHARACTER SET UTF8 COLLATE UTF8_BIN NOT NULL
	,ENABLESTATUS	CHAR(1)	DEFAULT '0' NOT NULL
	,ACTIVECODE	VARCHAR(150)	DEFAULT '0' NULL
	,EMAIL	VARCHAR(255)	NOT NULL
	,ALIASNAME	VARCHAR(100)	NULL
	,FIRSTNAME	VARCHAR(100)	NULL
	,LASTNAME	VARCHAR(100)	NULL
	,MOBILEPHONE	VARCHAR(30)	NULL
	,TELEPHONE	VARCHAR(30)	NULL
	,PICTUREFILE	VARCHAR(255)	NULL
	,ORGANIZATION	VARCHAR(100)	NULL
	,DEPARTMENT	VARCHAR(100)	NULL
	,TITLE	VARCHAR(100)	NULL
	,COUNTRY	CHAR(3)	NULL
	,STATE	VARCHAR(100)	NULL
	,CITY	VARCHAR(100)	NULL
	,ZIPCODE	VARCHAR(20)	NULL
	,ADDRESS	VARCHAR(200)	NULL
	,ADDRESS2	VARCHAR(200)	NULL
	,VALIDSTARTTIME	TIMESTAMP	NULL
	,VALIDENDTIME	TIMESTAMP	NULL
	,LASTLOGINTIME	TIMESTAMP	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,CREATETIME	TIMESTAMP	NOT NULL
	,NOTICEMASK TINYINT DEFAULT 0 NOT NULL
	,OFFICALPHONE VARCHAR(30) NULL
    ,TIMEZONE VARCHAR(20) DEFAULT 'GMT+08:00' NOT NULL
    ,ZONEID VARCHAR(100) DEFAULT 'ASIA/TAIPEI' NOT NULL
    ,PIPN_EDITION VARCHAR(8) NULL
    ,LOCALECODE VARCHAR(8) NULL
    ,DEPARTMENTID BIGINT NULL
    ,QRCODE VARCHAR(64) NULL
    ,USERTYPE CHAR(1) DEFAULT '1'   NOT NULL
    ,PLANID   BIGINT  NULL
    ,LASTAPIACCESSTIME   BIGINT  NULL
	,CONSTRAINT PK_USERINFO PRIMARY KEY (ID)
	,CONSTRAINT FK_USERINFO_1 FOREIGN KEY (GROUPID)
				REFERENCES GROUPINFO(GROUPID)
	,CONSTRAINT FK_USERINFO_3 FOREIGN KEY (PLANID)
				REFERENCES PLANINFO(PLANID)
);
CREATE UNIQUE INDEX UQ_USERINFO_1 ON USERINFO(APCATEGORY,APSYSTEM,USERNAME);
CREATE INDEX IX_USERINFO_1 ON USERINFO(QRCODE);



CREATE TABLE RULEINFO
(
 RULEID	BIGINT(20) NOT NULL AUTO_INCREMENT
,RULENAME	VARCHAR(64)	NOT NULL
,IMPORTANCE	INT 	DEFAULT 1 NOT NULL
,MAILTITLE	VARCHAR(64)	NULL
,MAILCONTENT	VARCHAR(500)	NULL
,SMSCONTENT	VARCHAR(200)	NULL
,CREATIME	TIMESTAMP	NOT NULL
,UPDATETIME	TIMESTAMP	NOT NULL
,DEVICETYPE VARCHAR(10) NOT NULL
,GROUPID BIGINT NOT NULL
,DEVICECATEGORY INT DEFAULT 0 NOT NULL
,DEVICEID VARCHAR(1000) NULL
,MAINID  BIGINT  NULL
,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
,MOBILE_CONTENT_TYPE BIGINT DEFAULT 0 NULL
,MOBILE_EVENT_CONTENT VARCHAR(150) NULL
,MOBILE_CONTROL_CONTENT VARCHAR(150) NULL
,TARGETID VARCHAR(36)
,DEVICENAME VARCHAR(1000) NULL
,MAIL_LOCALE VARCHAR(8) default 'en'  NOT NULL
,CONSTRAINT PK_RULEINFO PRIMARY KEY (RULEID)
,CONSTRAINT FK_RULEINFO_1 FOREIGN KEY (GROUPID)  REFERENCES GROUPINFO (GROUPID)
);
CREATE INDEX IX_RULEINFO_1 ON RULEINFO (SYNCSTATUS ASC);

CREATE TABLE RULEEVENT
(
EVENTID  BIGINT(20) NOT NULL AUTO_INCREMENT
,EVENTSTATUS  INT  DEFAULT 0 NOT NULL
,RULEID  BIGINT(20)  NOT NULL
,DEVICEID  VARCHAR(1000)  NOT NULL
,DEVICETYPE  VARCHAR(5)  NOT NULL
,DEVICECATEGORY  INT DEFAULT 0 NOT NULL
,REPORTTIME  TIMESTAMP  NOT NULL
,HANDLEDTIME  TIMESTAMP  NULL
,CONFIRMEDTIME  TIMESTAMP  NULL
,GROUPID SMALLINT(6) NULL
,MAINID  BIGINT  NULL
,EVENTTYPE INT DEFAULT 0 NOT NULL
,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
,RULENAME VARCHAR(64) NULL
,DEVICENAME VARCHAR(1000) NULL
,CONSTRAINT PK_RULEEVENT PRIMARY KEY(EVENTID)
,CONSTRAINT FK_RULEEVENT_1 FOREIGN KEY(RULEID)
      REFERENCES RULEINFO(RULEID)
);
CREATE INDEX IX_RULEEVENT_1 ON RULEEVENT (SYNCSTATUS ASC);
CREATE INDEX IX_RULEEVENT_2 ON RULEEVENT(EVENTSTATUS,GROUPID,EVENTTYPE);
CREATE INDEX IX_RULEEVENT_3 ON RULEEVENT(EVENTSTATUS,GROUPID,REPORTTIME);

-- CONTACT
CREATE TABLE CONTACT (
	   ID BIGINT NOT NULL AUTO_INCREMENT
	 , NAME VARCHAR(255) DEFAULT NULL
	 , CONSTRAINT PK_CONTACT PRIMARY KEY (ID)
);

CREATE TABLE RULECUSTOMER
(
	RULEID	BIGINT(20)	NOT NULL
	,CUSTOMERID	VARCHAR(64)	NOT NULL
	,NOTIFYTYPE	INT	DEFAULT 1 NOT NULL
	,USERID BIGINT NOT NULL
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,RULETYPE BIGINT  DEFAULT 0 NOT NULL
	,CONSTRAINT PK_RULECUSTOMER PRIMARY KEY (RULEID, NOTIFYTYPE , USERID)
	,CONSTRAINT FK_RULECUSTOMER_3 FOREIGN KEY (USERID)
				REFERENCES CONTACT (ID)
);
CREATE INDEX IX_RULECUSTOMER_1 ON RULECUSTOMER (SYNCSTATUS ASC);

-- USEROPTION
CREATE TABLE USEROPTION(
	 ID	BIGINT	NOT NULL AUTO_INCREMENT
	,APCATEGORY VARCHAR(10) NOT NULL
	,APSYSTEM VARCHAR(10) DEFAULT '0' NOT NULL
	,USERNAME VARCHAR(255) NOT NULL
	,ATTRID	INT	NOT NULL
	,VALUE	VARCHAR(500)	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,CONSTRAINT PK_USEROPTION PRIMARY KEY (ID)
);
CREATE UNIQUE INDEX UQ_USEROPTION_1 ON USEROPTION(APCATEGORY,APSYSTEM,USERNAME,ATTRID);



-- ----------------------------
-- 配合CS專用設備TABLE START
-- ----------------------------
-- DVRCVMSGLOG
CREATE TABLE DVRCVMSGLOG (
       SEQUENCEID BIGINT NOT NULL AUTO_INCREMENT
     , MSGTYPE CHAR(2)
     , GWID VARCHAR(20)
     , MSGPACKAGE VARCHAR(4000)
     , MSGRCVTIME TIMESTAMP
 	 , RESULT VARCHAR(10) DEFAULT '0' NOT NULL
	 , FINISHTIME TIMESTAMP DEFAULT '2016-11-21 00:00:00' NOT NULL
     , CONSTRAINT PK_DVRCVMSGLOG PRIMARY KEY (SEQUENCEID)
);
CREATE INDEX IX_DVRCVMSGLOG_1 ON DVRCVMSGLOG (MSGRCVTIME ASC, GWID ASC, MSGTYPE ASC);

-- DVSENDCMDLOG
CREATE TABLE DVSENDCMDLOG (
       CMDSN VARCHAR(46) NOT NULL
     , GWID VARCHAR(20)
     , DEVICEID VARCHAR(23)
     , CSRESULT VARCHAR(50)
     , GWRESULT VARCHAR(6)
     , APCMDPACKAGE VARCHAR(3000)
     , APCMDTIME TIMESTAMP
     , CSCMDPACKAGE VARCHAR(2000)
     , CSCMDTIME TIMESTAMP
     , GWRSPPACKAGE VARCHAR(2000)
     , GWRSPTIME TIMESTAMP
     , CUSTOMERID VARCHAR(255)
     , GROUPID VARCHAR(20)
     , CTRLSOURCE VARCHAR(1)
     , APRESULT VARCHAR(2)
     , APTYPE VARCHAR(100)
     , APIP VARCHAR(100)
     , CSIP VARCHAR(100)
     , CSPORT INT
     , CMDSRCIP VARCHAR(39) DEFAULT '0.0.0.0' NOT NULL
     , CMDSRCTIME TIMESTAMP DEFAULT '2016-11-18 00:00:00' NOT NULL
     , CSRESULTTIME TIMESTAMP DEFAULT '2016-11-24 00:00:00' NOT NULL
     , CONSTRAINT PK_DVSENDCMDLOG PRIMARY KEY (CMDSN)
);
CREATE INDEX IX_DVSENDCMDLOG_1 ON DVSENDCMDLOG (APCMDTIME ASC, GWID ASC, DEVICEID ASC, CUSTOMERID ASC);
CREATE INDEX IX_DVSENDCMDLOG_2 ON DVSENDCMDLOG (APIP ASC);
CREATE INDEX IX_DVSENDCMDLOG_3 ON DVSENDCMDLOG (DEVICEID ASC) ;

-- GWCONNECTIONLOG
CREATE TABLE GWCONNECTIONLOG (
       SEQUENCEID BIGINT NOT NULL AUTO_INCREMENT
     , GWIP VARCHAR(39)
     , GWID VARCHAR(20)
     , MESSAGE VARCHAR(400)
     , LOGTIME TIMESTAMP
     , CONNECTIONINFO VARCHAR(6)
     , CONSTRAINT PK_GWCONNECTIONLOG PRIMARY KEY (SEQUENCEID)
);
CREATE INDEX IX_GWCONNECTIONLOG_1 ON GWCONNECTIONLOG (LOGTIME ASC, GWID ASC, CONNECTIONINFO ASC);
-- -------------

-- -------------
-- SOLAR_PLANT_LIST
CREATE TABLE SOLAR_PLANT_LIST (
       SPL_ID BIGINT NOT NULL AUTO_INCREMENT
     , SPL_NAME VARCHAR(100)
     , SPL_ADDR VARCHAR(500)
     , SPL_COUNTRY VARCHAR(5)
     , SPL_LAT DECIMAL(20,6)
     , SPL_LNG DECIMAL(20,6)
     , SPL_CAPACITY DECIMAL(20,6)
     , SPL_TYPE CHAR(1)
     , SPL_CREATE_TIME TIMESTAMP
     , SPL_UPDATE_TIME TIMESTAMP
     , CELL_NUMBER INTEGER
     , CELL_CAPACITY DECIMAL(20,6)
     , PICS VARCHAR(100)
     , SURFACETEMPSENSORID VARCHAR(20)
     , SOLARSENSORID VARCHAR(20)
     , BACKTEMPSENSORID VARCHAR(20)
     , GROUPID SMALLINT
     , PYRHELIOMETER	CHAR(1)	DEFAULT '0' NULL
	 , THERMOMETER	CHAR(1)	DEFAULT '0' NULL
	 , INVERTER_INPUT_V 	DECIMAL(20,6)	NULL
	 , INVERTER_OUTPUT_V 	DECIMAL(20,6)	NULL
	 , USE_ELECTRICITY	CHAR(1)	DEFAULT '0' NULL
	 , SELL_ELECTRICITY	CHAR(1)	DEFAULT '0' NULL
	 , LOAD_NAME	VARCHAR(100)	NULL
	 , LOAD_POWER	DECIMAL(20,6)	NULL
	 , BATTERY_TYPE	VARCHAR(100)	NULL
	 , BATTERY_LIFE	DECIMAL(20,6)	NULL
	 , BATTERY_VOLTAGE 	DECIMAL(20,6)	NULL
	 , BATTERY_CAPACITY 	DECIMAL(20,6)	NULL
	 , BATTERY_TIMES	INT	NULL
	 , SETUP_COMPLETED 	CHAR(1)	DEFAULT '0' NULL
	 , EFFICIENCY INT NULL
     , CONSTRAINT PK_SOLAR_PLANT_LIST PRIMARY KEY (SPL_ID)
);

-- DEVICEMODEL
CREATE TABLE DEVICEMODEL (
       MODELID SMALLINT NOT NULL AUTO_INCREMENT
     , MODEL_NAME VARCHAR(4) NOT NULL
     , MANUCODE VARCHAR(2) NOT NULL
     , DEVICETYPE VARCHAR(2) NOT NULL
     , VERSION SMALLINT DEFAULT 1 NOT NULL
     , CONSTRAINT PK_DEVICEMODEL PRIMARY KEY (MODELID)
);

-- DEVICETAG
CREATE TABLE DEVICETAG (
       TAGID SMALLINT NOT NULL AUTO_INCREMENT
     , TAG_NAME VARCHAR(20) NOT NULL
     , VERSION SMALLINT DEFAULT 1 NOT NULL
     , CONSTRAINT PK_DEVICETAG PRIMARY KEY (TAGID)
);

-- DEVICE_MODEL_TAG
CREATE TABLE DEVICE_MODEL_TAG (
       MODELID SMALLINT
	 , TAGID SMALLINT
     , CONSTRAINT PK_DEVICE_MODEL_TAG PRIMARY KEY (MODELID, TAGID)
     , CONSTRAINT FK_DEVICE_MODEL_TAG_1 FOREIGN KEY (MODELID)
                  REFERENCES DEVICEMODEL (MODELID)
     , CONSTRAINT FK_DEVICE_MODEL_TAG_2 FOREIGN KEY (TAGID)
                  REFERENCES DEVICETAG (TAGID)
);

CREATE TABLE MODELINFO (
	MODELID  BIGINT NOT NULL AUTO_INCREMENT
	,MODELNAME VARCHAR(256) NOT NULL
	,MODELTYPE SMALLINT NOT NULL
	,DEVICETYPE VARCHAR(5) NOT NULL
	,MANUCODE VARCHAR(2) NOT NULL
	,MANUNAME VARCHAR(500) NULL
	,ENABLESTATUS VARCHAR(1)  DEFAULT '1' NOT NULL
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CREATETIME TIMESTAMP NULL
	,UPDATETIME TIMESTAMP NULL
	,CONSTRAINT PK_MODELINFO PRIMARY KEY (MODELID)
);

CREATE TABLE MODELATTR (
	MODELATTRID  BIGINT NOT NULL AUTO_INCREMENT
	,MODELID BIGINT NOT NULL
	,ATTRID BIGINT NOT NULL
	,ATTRTYPE SMALLINT NOT NULL
	,VALUEMIN DECIMAL(20,6) DEFAULT 0 NULL
	,VALUEMAX DECIMAL(20,6) DEFAULT 0 NULL
	,VALUESTEP DECIMAL(20,6) DEFAULT 0 NULL
	,ENABLESTATUS VARCHAR(1) DEFAULT '1' NOT NULL
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CREATETIME TIMESTAMP NULL
	,UPDATETIME TIMESTAMP NULL
	,CONSTRAINT PK_MODELATTR PRIMARY KEY (MODELATTRID)
	,CONSTRAINT FK_MODELATTR_1 FOREIGN KEY (MODELID)
					  REFERENCES MODELINFO (MODELID)
);
CREATE UNIQUE INDEX UQ_MODELATTR_1 ON MODELATTR (MODELID ASC,ATTRID ASC,ATTRTYPE ASC);

-- DEVICE
-- DEVICELIST
CREATE TABLE DEVICELIST (
       LISTID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICEID VARCHAR(25) NOT NULL
     , PARENTID BIGINT
     , GATEWAYID VARCHAR(20)
     , MANUCODE CHAR(2) NOT NULL
     , DEVICETYPE VARCHAR(5) NOT NULL
     , SYNCSTATUS VARCHAR(1) NOT NULL DEFAULT '0'    -- 0: 尚未同步, 1: 同步完全
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CREATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , ENABLESTATUS CHAR(1) NOT NULL DEFAULT '1'
     , ROOTID BIGINT NULL
     , CONNECTIONSTATUS VARCHAR(1) DEFAULT '2' NOT NULL
     , CONSTRAINT PK_DEVICELIST PRIMARY KEY (LISTID)
     , CONSTRAINT FK_DEVICELIST_1 FOREIGN KEY (PARENTID)
                  REFERENCES DEVICELIST (LISTID)
	 , CONSTRAINT FK_DEVICELIST_2 FOREIGN KEY (ROOTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_DEVICELIST_1 ON DEVICELIST (DEVICEID ASC);
CREATE INDEX IX_DEVICELIST_2 ON DEVICELIST (PARENTID ASC);
CREATE INDEX IX_DEVICELIST_3 ON DEVICELIST (GATEWAYID ASC);
CREATE INDEX IX_DEVICELIST_4 ON DEVICELIST (ROOTID ASC);
CREATE INDEX IX_DEVICELIST_5 ON DEVICELIST (CONNECTIONSTATUS ASC);
CREATE INDEX IX_DEVICELIST_6 ON DEVICELIST (DEVICETYPE ASC);

-- 閘道器
-- GWPROFILE
CREATE TABLE GWPROFILE (
       GWID VARCHAR(20) NOT NULL
     , CUSTOMERID VARCHAR(64) CHARACTER SET UTF8 COLLATE UTF8_BIN
     , OLDGROUPID VARCHAR(20)
     , GWIP VARCHAR(39)
     , OLAMOUNT INT
     , GWSTATUS CHAR(2)
     , GWTRANSPERIOD INT
     , GWPLACE VARCHAR(300)
     , EMSPASSWORD VARCHAR(12)
     , EMSSERVERIP VARCHAR(39)
     , EMSSERVERPORT INT
     , ISENABLE CHAR(1) DEFAULT '1'
     , UPDATETIME TIMESTAMP
     , MANUCODE VARCHAR(2)
     , DEVICETYPE VARCHAR(5)
     , GWREGION VARCHAR(5)
     , COSTRATE DECIMAL(20,6)
     , RATEUNIT CHAR(1)
     , EMISSIONFACTOR DECIMAL(20,6)
     , FACTORUNIT CHAR(1)
     , SOLARPLANTID BIGINT
     , TIMEZONE VARCHAR(9)
     , ADDRESS VARCHAR(200)
     , LATITUDE DECIMAL(20,6)
     , LONGITUDE DECIMAL(20,6)
     , CREATETIME TIMESTAMP NULL
     , CONNECTIONSTATUS CHAR(1) DEFAULT '0' NOT NULL
     , ISSYNC VARCHAR(1) DEFAULT '0'
     , TZSOURCE CHAR(1)
     , MODELNAME VARCHAR(32)
     , EHOMEID VARCHAR(50)
     , OFFLINENOTIFY CHAR(1) DEFAULT '1'
     , GROUPID BIGINT
     , VERSION VARCHAR(50)
     , ENABLESTATUS VARCHAR(1) DEFAULT '1' NOT NULL
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , MODELID BIGINT NULL
     , USERID BIGINT NULL
     , CONSTRAINT PK_GWPROFILE PRIMARY KEY (GWID)
     , CONSTRAINT FK_GWPROFILE_1 FOREIGN KEY (CUSTOMERID)
                  REFERENCES CUSTOMERINFO (CUSTOMERID)
     , CONSTRAINT FK_GWPROFILE_2 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
     , CONSTRAINT FK_GWPROFILE_3 FOREIGN KEY (SOLARPLANTID)
      			  REFERENCES SOLAR_PLANT_LIST (SPL_ID)
     , CONSTRAINT FK_GWPROFILE_4 FOREIGN KEY (MODELID)
     			  REFERENCES MODELINFO (MODELID)
     , CONSTRAINT FK_GWPROFILE_5 FOREIGN KEY (USERID)
     			  REFERENCES USERINFO (ID)

);
CREATE INDEX IX_GWPROFILE_1 ON GWPROFILE (CUSTOMERID ASC);
CREATE INDEX IX_GWPROFILE_2 ON GWPROFILE (GROUPID ASC);
CREATE INDEX IX_GWPROFILE_3 ON GWPROFILE (SOLARPLANTID ASC);
CREATE UNIQUE INDEX IX_GWPROFILE_4 ON GWPROFILE (EHOMEID ASC);

-- GATEWAYPROFILE
CREATE TABLE GATEWAYPROFILE (
       PROFILEID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , ATTRTYPE CHAR(1) NOT NULL
     , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0'  NOT NULL
     , CONSTRAINT PK_GATEWAYPROFILE PRIMARY KEY (PROFILEID)
     , CONSTRAINT FK_GATEWAYPROFILE_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_GATEWAYPROFILE_1 ON GATEWAYPROFILE (DEVICELISTID ASC, ATTRID ASC);

CREATE TABLE GATEWAYNUMBERINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE DECIMAL(20,6)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_GATEWAYNUMBERINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_GATEWAYNUMBERINFO_3 ON GATEWAYNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_GATEWAYNUMBERINFO_4 ON GATEWAYNUMBERINFO (SYNCSTATUS ASC);

CREATE TABLE GATEWAYSTRINGINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_GATEWAYSTRINGINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_GATEWAYSTRINGINFO_3 ON GATEWAYSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_GATEWAYSTRINGINFO_4 ON GATEWAYSTRINGINFO (SYNCSTATUS ASC);

CREATE TABLE GATEWAYEVENT (
       EVENTID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_GATEWAYEVENT PRIMARY KEY (EVENTID)
     , CONSTRAINT FK_GATEWAYEVENT_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_GATEWAYEVENT_1 ON GATEWAYEVENT (DEVICELISTID ASC, ATTRID ASC);
CREATE INDEX IX_GATEWAYEVENT_1 ON GATEWAYEVENT(SYNCSTATUS ASC);

CREATE TABLE GATEWAYEVENTINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , EVENTID BIGINT NOT NULL
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_GATEWAYEVENTINFO PRIMARY KEY (EVENTID, REPORTTIME)
);
CREATE INDEX IX_GATEWAYEVENTINFO_3 ON GATEWAYEVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_GATEWAYEVENTINFO_4 ON GATEWAYEVENTINFO (SYNCSTATUS ASC);

-- 電力計
CREATE TABLE OLPROFILE (
       OLID VARCHAR(23)
     , GWID VARCHAR(20)
     , CUSTOMERID VARCHAR(64) CHARACTER SET UTF8 COLLATE UTF8_BIN
     , OLDGROUPID VARCHAR(20)
     , OLSTATUS CHAR(2)
     , UPDATETIME TIMESTAMP
     , REPORTTIME TIMESTAMP
     , OLVOLTAGE DECIMAL(20,6)
     , OLCURRENT DECIMAL(20,6)
     , OLFREQUENCY DECIMAL(20,6)
     , OLPOWERFACTOR DECIMAL(20,6)
     , OLACTIVEPOWER DECIMAL(20,6)
     , OLAPPARENTPOWER DECIMAL(20,6)
     , OLMAINENERGY DECIMAL(20,6)
     , OLNEGATIVEENERGY DECIMAL(20,6)
     , OLSHORTMAINENERGY DECIMAL(20,6)
     , OLSHORTNEGATIVEENERGY DECIMAL(20,6)
     , OLSHORTTIME DECIMAL(20,6)
     , OLRELAYSTATUS CHAR(1)
     , OLRESTARTTIME TIMESTAMP
     , OLSAMPLINGPERIOD INT
     , OLTRANSPERIOD INT
     , OLPOWERTHRESHOLD INT
     , OLAPPLIANCE VARCHAR(100)
     , OLTYPE CHAR(2)
     , OLPLACE VARCHAR(300)
     , LATITUDE DECIMAL(20,6)
     , LONGITUDE DECIMAL(20,6)
     , SHOWONMAP CHAR(1) DEFAULT '0'
     , CHANNEL VARCHAR(2)
     , MANUCODE VARCHAR(2)
     , DEVICETYPE VARCHAR(5)
     , BUDGET DECIMAL(20,6)
     , SURGEDETECT INT
     , ISHIDDEN CHAR(1)
     , CREATETIME TIMESTAMP
     , SUBID VARCHAR(2)  DEFAULT '00'
     , CAPABILITY DECIMAL(20,6) DEFAULT 0
     , PARENTID VARCHAR(20)
     , NETTYPE VARCHAR(2)
     , CONNECTIONSTATUS VARCHAR(1) DEFAULT '0'
     , MODELNAME VARCHAR(32)
     , OFFLINENOTIFY CHAR(1) DEFAULT '1'
     , GROUPID BIGINT
     , DEVICELISTID BIGINT
	 , AREAID	BIGINT	NULL
	 , POSX DECIMAL(20,6)	NULL
	 , POSY	DECIMAL(20,6)	NULL
	 , AREABLOCKID	BIGINT	NULL
	 , USERID	BIGINT NULL
     , CONSTRAINT PK_OLPROFILE PRIMARY KEY (OLID)
     , CONSTRAINT FK_OLPROFILE_2 FOREIGN KEY (CUSTOMERID)
                  REFERENCES CUSTOMERINFO (CUSTOMERID)
     , CONSTRAINT FK_OLPROFILE_3 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
	 , CONSTRAINT FK_OLPROFILE_5 FOREIGN KEY (AREAID)
	 			  REFERENCES AREAINFO(AREAID)
	 , CONSTRAINT FK_OLPROFILE_6 FOREIGN KEY (AREABLOCKID)
	 			  REFERENCES AREAINFO(AREAID)
	 , CONSTRAINT FK_OLPROFILE_7 FOREIGN KEY (USERID)
	 			  REFERENCES USERINFO(ID)
);
CREATE INDEX IX_OLPROFILE_1 ON OLPROFILE (GWID ASC);
CREATE INDEX IX_OLPROFILE_2 ON OLPROFILE (CUSTOMERID ASC);
CREATE INDEX IX_OLPROFILE_3 ON OLPROFILE (GROUPID ASC);
CREATE INDEX IX_OLPROFILE_4 ON OLPROFILE (DEVICELISTID ASC);

CREATE TABLE OLPOWERINFO (
       OLID VARCHAR(23) NOT NULL
     , UPDATETIME TIMESTAMP
     , REPORTTIME TIMESTAMP
     , OLVOLTAGE DECIMAL(20,6)
     , OLCURRENT DECIMAL(20,6)
     , OLFREQUENCY DECIMAL(20,6)
     , OLPOWERFACTOR DECIMAL(20,6)
     , OLACTIVEPOWER DECIMAL(20,6)
     , OLAPPARENTPOWER DECIMAL(20,6)
     , OLMAINENERGY DECIMAL(20,6)
     , OLNEGATIVEENERGY DECIMAL(20,6)
     , OLSHORTMAINENERGY DECIMAL(20,6)
     , OLSHORTNEGATIVEENERGY DECIMAL(20,6)
     , OLSHORTTIME DECIMAL(20,6)
     , OLRELAYSTATUS CHAR(1)
     , CONSTRAINT UQ_OLPOWERINFO_1 UNIQUE (OLID, REPORTTIME)
);
CREATE INDEX IX_OLPOWERINFO_1 ON OLPOWERINFO (REPORTTIME ASC);

CREATE TABLE OLPOWERSTATUS (
       OLID VARCHAR(23) NOT NULL
     , STARTTIME VARCHAR(12) NOT NULL
     , ENDTIME VARCHAR(12)
     , POWERSTATUS CHAR(1)
     , EFFECTIVEPOWER DECIMAL(20,6)
     , UPDATETIME TIMESTAMP
     , CONSTRAINT PK_OLPOWERSTATUS PRIMARY KEY (OLID, STARTTIME)
);
CREATE INDEX IX_OLPOWERSTATUS_1 ON OLPOWERSTATUS (OLID ASC);

CREATE TABLE OLSTATISTICSDAY (
       OLID VARCHAR(23) NOT NULL
     , STATSTIME VARCHAR(8) NOT NULL
     , STATSTYPE CHAR(1)
     , UPDATETIME TIMESTAMP
     , TOTALENERGY DECIMAL(20,6) DEFAULT 0
     , MAXPOWER DECIMAL(20,6) DEFAULT 0
     , POWERRATE DECIMAL(20,6) DEFAULT 0
     , CO2 DECIMAL(20,6) DEFAULT 0
     , DEMAND DECIMAL(20,6) DEFAULT 0
     , MAXKWH DECIMAL(20,6) DEFAULT 0
     , MINKWH DECIMAL(20,6) DEFAULT 0
     , CONSTRAINT PK_OLSTATISTICSDAY PRIMARY KEY (OLID, STATSTIME)
);
CREATE INDEX IX_OLSTATISTICSDAY_1 ON OLSTATISTICSDAY (STATSTIME ASC, STATSTYPE ASC);

CREATE TABLE OLSTATISTICSHOUR (
       OLID VARCHAR(23) NOT NULL
     , STATSTIME VARCHAR(12) NOT NULL
     , STATSTYPE CHAR(1)
     , UPDATETIME TIMESTAMP
     , TOTALENERGY DECIMAL(20,6) DEFAULT 0
     , MAXPOWER DECIMAL(20,6) DEFAULT 0
     , POWERRATE DECIMAL(20,6) DEFAULT 0
     , CO2 DECIMAL(20,6) DEFAULT 0
     , DEMAND DECIMAL(20,6) DEFAULT 0
     , MAXKWH DECIMAL(20,6) DEFAULT 0
     , MINKWH DECIMAL(20,6) DEFAULT 0
     , CONSTRAINT PK_OLSTATISTICSHOUR PRIMARY KEY (OLID, STATSTIME)
);

CREATE TABLE POWEROFFREMINDER (
       OCCURDAY VARCHAR(8) NOT NULL
     , OLID VARCHAR(23) NOT NULL
     , POWERTYPE CHAR(1)
     , MAILTO VARCHAR(50)
     , SUBJECT VARCHAR(50)
     , TEXT VARCHAR(4000)
     , UPDATETIME TIMESTAMP
     , TOTALENERGY DECIMAL(20,6)
     , POWERRATE DECIMAL(20,6)
     , CO2 DECIMAL(20,6)
     , CONSTRAINT PK_POWEROFFREMINDER PRIMARY KEY (OCCURDAY, OLID)
);
CREATE INDEX IX_POWEROFFREMINDER_1 ON POWEROFFREMINDER (OLID ASC);

CREATE TABLE OLMAP (
       GWID VARCHAR(20) NOT NULL
     , ICONNAME VARCHAR(20) NOT NULL
     , OLID VARCHAR(23) NOT NULL
     , POSX INT DEFAULT 0
     , POSY INT DEFAULT 0
     , CONSTRAINT PK_OLMAP PRIMARY KEY (GWID, ICONNAME, OLID)
);
CREATE INDEX IX_OLMAP_1 ON OLMAP (GWID ASC);
CREATE INDEX IX_OLMAP_2 ON OLMAP (OLID ASC);


-- 空調
-- AIRCONDPROFILE
CREATE TABLE AIRCONDPROFILE (
       AIRCONDID VARCHAR(20) NOT NULL
     , MASTERIP VARCHAR(2)
     , UPDATETIME TIMESTAMP
     , POWERSTATUS INT
     , LOCKSTATUS INT DEFAULT 0
     , SETMODE INT
     , SETFANSPEED INT
     , ALARMSTATUS INT
     , VALVECONTACT INT
     , FANSPEEDCONTACT INT
     , CHILLCONTACT INT
     , HEATINGCONTACT INT
     , ROOMTEMP DECIMAL(20,6)
     , SETPOINT DECIMAL(20,6)
     , PMV DECIMAL(20,6)
     , GWID VARCHAR(20)
     , OLDGROUPID VARCHAR(20)
     , REPORTTIME TIMESTAMP
     , MANUCODE VARCHAR(2)
     , DEVICETYPE VARCHAR(2)
     , UVCONTACT INT
     , PLACE VARCHAR(100)
     , CREATETIME TIMESTAMP
     , AIRVERTSTATUS DECIMAL(20,6)
     , AIRHORIZSTATUS DECIMAL(20,6)
     , BUZZERSTATUS DECIMAL(20,6)
     , INDOORFUNCTION DECIMAL(20,6)
     , INDOORTYPE DECIMAL(20,6)
     , INDOORCAPACITY DECIMAL(20,6)
     , SETCHILLTEMP DECIMAL(20,6)
     , SETHEATTEMP DECIMAL(20,6)
     , OUTDOORTYPE DECIMAL(20,6)
     , OUTDOORCAPACITY DECIMAL(20,6)
     , OUTDOORCURRENT DECIMAL(20,6)
     , OUTDOORRPM DECIMAL(20,6)
     , OUTDOORTEMP DECIMAL(20,6)
     , ANTIMOLD DECIMAL(20,6)
     , MOISTURIZE DECIMAL(20,6)
     , RESTORE DECIMAL(20,6)
     , DISPLAYMODE DECIMAL(20,6)
     , CONNECTIONSTATUS CHAR(1) DEFAULT '0'
     , GROUPID BIGINT
     , DEVICELISTID BIGINT
     , CONSTRAINT PK_AIRCONDPROFILE PRIMARY KEY (AIRCONDID)
     , CONSTRAINT FK_AIRCONDPROFILE_2 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
);
CREATE INDEX IX_AIRCONDPROFILE_1 ON AIRCONDPROFILE (GWID ASC);
CREATE INDEX IX_AIRCONDPROFILE_2 ON AIRCONDPROFILE (GROUPID ASC);
CREATE INDEX IX_AIRCONDPROFILE_3 ON AIRCONDPROFILE (DEVICELISTID ASC);

CREATE TABLE AIRCONDINFO (
       AIRCONDID VARCHAR(20) NOT NULL
     , MASTERIP VARCHAR(2)
     , UPDATETIME TIMESTAMP DEFAULT '0000-00-00 00:00:00'
     , POWERSTATUS INT
     , LOCKSTATUS INT
     , SETMODE INT
     , SETFANSPEED INT
     , ALARMSTATUS INT
     , VALVECONTACT INT
     , FANSPEEDCONTACT INT
     , CHILLCONTACT INT
     , HEATINGCONTACT INT
     , ROOMTEMP DECIMAL(20,6)
     , SETPOINT DECIMAL(20,6)
     , PMV DECIMAL(20,6)
     , REPORTTIME TIMESTAMP DEFAULT '0000-00-00 00:00:00'
     , UVCONTACT INT
     , AIRVERTSTATUS DECIMAL(20,6)
     , AIRHORIZSTATUS DECIMAL(20,6)
     , BUZZERSTATUS DECIMAL(20,6)
     , INDOORFUNCTION DECIMAL(20,6)
     , INDOORTYPE DECIMAL(20,6)
     , INDOORCAPACITY DECIMAL(20,6)
     , SETCHILLTEMP DECIMAL(20,6)
     , SETHEATTEMP DECIMAL(20,6)
     , OUTDOORTYPE DECIMAL(20,6)
     , OUTDOORCAPACITY DECIMAL(20,6)
     , ANTIMOLD DECIMAL(20,6)
     , MOISTURIZE DECIMAL(20,6)
     , RESTORE DECIMAL(20,6)
     , DISPLAYMODE DECIMAL(20,6)
     , OUTDOORCURRENT DECIMAL(20,6)
     , OUTDOORRPM DECIMAL(20,6)
     , OUTDOORTEMP DECIMAL(20,6)
     , CONSTRAINT PK_AIRCONDINFO PRIMARY KEY (AIRCONDID, REPORTTIME)
     , CONSTRAINT FK_AIRCONDINFO_1 FOREIGN KEY (AIRCONDID)
                  REFERENCES AIRCONDPROFILE (AIRCONDID)
);
CREATE INDEX IX_AIRCONDINFO_1 ON AIRCONDINFO (AIRCONDID ASC);
CREATE INDEX IX_AIRCONDINFO_2 ON AIRCONDINFO (REPORTTIME);

CREATE TABLE APPLIANCESTATUSPROFILE (
       ASPID BIGINT NOT NULL AUTO_INCREMENT
     , ASPNAME VARCHAR(20)
     , STATUSNAME VARCHAR(20)
     , POWERMAX DECIMAL(20,6)
     , POWERMIN DECIMAL(20,6)
     , VOLTAGE DECIMAL(20,6)
     , ASPSTATUS CHAR(1)
     , ASPSTATUSPRBB CHAR(1)
     , UPDATETIME TIMESTAMP
     , CONSTRAINT PK_ASPROFILE PRIMARY KEY (ASPID)
);

CREATE TABLE APPLIANCESTATUSINFO (
       ASPID BIGINT NOT NULL
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , POWER DECIMAL(20,6)
     , VOLTAGE DECIMAL(20,6)
     , ASPSTATUS CHAR(1)
     , ASPSTATUSPRBB CHAR(1)
     , CONSTRAINT PK_ASINFO PRIMARY KEY (ASPID, UPDATETIME)
     , CONSTRAINT FK_APPLIANCESTATUSINFO_1 FOREIGN KEY (ASPID)
                  REFERENCES APPLIANCESTATUSPROFILE (ASPID)
);
CREATE INDEX IX_APPLIANCESTATUSINFO_1 ON APPLIANCESTATUSINFO (ASPID ASC);

CREATE TABLE APPLIANCEPRBBPROFILE (
       ASPID BIGINT NOT NULL
     , POWER DECIMAL(20,6) NOT NULL
     , COUNT INT
     , UPDATETIME TIMESTAMP
     , CONSTRAINT PK_APPROFILE PRIMARY KEY (ASPID, POWER)
     , CONSTRAINT FK_APPLIANCEPRBBPROFILE_1 FOREIGN KEY (ASPID)
                  REFERENCES APPLIANCESTATUSPROFILE (ASPID)
);
CREATE INDEX IX_APPLIANCEPRBBPROFILE_1 ON APPLIANCEPRBBPROFILE (ASPID ASC);

CREATE TABLE APPLIANCEPROFILE (
       APPLIANCEID BIGINT NOT NULL AUTO_INCREMENT
     , OLID VARCHAR(23)
     , APPLIANCENAME VARCHAR(30)
     , ACTIVEPOWER DECIMAL(20,6)
     , VOLTAGE DECIMAL(20,6)
     , STANDBYTHRESHOLD DECIMAL(20,6)
     , POWERONTHRESHOLD DECIMAL(20,6)
     , ISTEMPLATE CHAR(1) DEFAULT '0'
     , CONSTRAINT PK_APPLIANCEPROFILE PRIMARY KEY (APPLIANCEID)
);
CREATE INDEX IX_APPLIANCEPROFILE_1 ON APPLIANCEPROFILE (OLID ASC);
CREATE INDEX IX_APPLIANCEPROFILE_2 ON APPLIANCEPROFILE (ISTEMPLATE ASC);


CREATE TABLE APPLIANCEINFO (
       APPID BIGINT NOT NULL AUTO_INCREMENT
     , CUSTOMERID VARCHAR(64)  CHARACTER SET UTF8 COLLATE UTF8_BIN
     , OLID VARCHAR(23)
     , APPNAME VARCHAR(30)
     , MANUCODE VARCHAR(20)
     , MODEL VARCHAR(30)
     , ACTIVEPOWER DECIMAL(20,6)
     , VOLTAGE DECIMAL(20,6)
     , ISTEMPLATE CHAR(1) DEFAULT '0'
     , UPDATETIME TIMESTAMP
     , APPSTATUS DECIMAL(20,6) DEFAULT -1
     , APPTYPE VARCHAR(20)
     , APPTYPENAME VARCHAR(30)
     , CHARPROPERTY1 VARCHAR(20)
     , NUMPROPERTY1 DECIMAL(20,6)
     , BUYYEAR VARCHAR(4)
     , MANUNAME VARCHAR(30)
     , PROPERTY1 VARCHAR(2)
     , PROPERTY2 VARCHAR(2)
     , PROPERTY3 VARCHAR(2)
     , CONSTRAINT PK_APPLIANCEINFO PRIMARY KEY (APPID)
     , CONSTRAINT FK_APPLIANCEINFO_1 FOREIGN KEY (CUSTOMERID)
                  REFERENCES CUSTOMERINFO (CUSTOMERID)

);
CREATE INDEX IX_APPLIANCEINFO_1 ON APPLIANCEINFO (CUSTOMERID ASC);
CREATE INDEX IX_APPLIANCEINFO_2 ON APPLIANCEINFO (OLID ASC);
CREATE INDEX IX_APPLIANCEINFO_3 ON APPLIANCEINFO (ISTEMPLATE ASC);

CREATE TABLE APPLIANCETYPE (
       APPTYPECODE VARCHAR(2) NOT NULL
     , MANUCODE VARCHAR(2) NOT NULL
     , PROPERTY1 VARCHAR(30) NOT NULL
     , PROPERTY2 VARCHAR(30) NOT NULL
     , PROPERTY3 VARCHAR(30) NOT NULL
     , CONSTRAINT PK_APPLIANCETYPE PRIMARY KEY (APPTYPECODE)
);


CREATE TABLE APPLIANCESTATUS (
       ASID BIGINT NOT NULL AUTO_INCREMENT
     , APPID BIGINT
     , STATUSNAME VARCHAR(20)
     , ASIIMG VARCHAR(20)
     , UPDATETIME TIMESTAMP
     , CONSTRAINT PK_APPLIANCESTATUS PRIMARY KEY (ASID)
     , CONSTRAINT FK_APPLIANCESTATUS_1 FOREIGN KEY (APPID)
                  REFERENCES APPLIANCEINFO (APPID)
);
CREATE INDEX IX_APPLIANCESTATUS_1 ON APPLIANCESTATUS (APPID ASC);


CREATE TABLE APPLIANCESTATUSFEATURE (
       ASFID BIGINT NOT NULL AUTO_INCREMENT
     , ASID BIGINT
     , FEATUREID CHAR(1)
     , VALUE DECIMAL(20,6)
     , COUNT BIGINT
     , UPDATETIME TIMESTAMP
     , CONSTRAINT PK_ASFEATURE PRIMARY KEY (ASFID)
     , CONSTRAINT FK_ASFEATURE_1 FOREIGN KEY (ASID)
                  REFERENCES APPLIANCESTATUS (ASID)
);
CREATE INDEX IX_APPLIANCESTATUSFEATURE_1 ON APPLIANCESTATUSFEATURE (ASID ASC);



-- ACPROFILE
CREATE TABLE ACPROFILE (
	   PROFILEID BIGINT NOT NULL AUTO_INCREMENT
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
	 , VALUE VARCHAR(500) NULL
	 , ATTRTYPE CHAR(1) NOT NULL
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	 , CONSTRAINT PK_ACPROFILE_1 PRIMARY KEY (PROFILEID)
	 , CONSTRAINT FK_ACPROFILE_1 FOREIGN KEY (DEVICELISTID)
					REFERENCES DEVICELIST (LISTID)
) ;
CREATE UNIQUE INDEX UQ_ACPROFILE_1 ON ACPROFILE(DEVICELISTID ASC, ATTRID ASC);
CREATE INDEX IX_ACPROFILE_1 ON ACPROFILE (SYNCSTATUS ASC);

CREATE TABLE ACNUMBERINFO (
	   REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
	 , VALUE DECIMAL(20,6) NULL
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	 , CONSTRAINT PK_ACNUMBERINFO_1 PRIMARY KEY (REPORTTIME,PROFILEID)
);
CREATE INDEX IX_ACNUMBERINFO_2 ON ACNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC );
CREATE INDEX IX_ACNUMBERINFO_3 ON ACNUMBERINFO(SYNCSTATUS ASC);

CREATE TABLE ACSTRINGINFO (
	   REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
	 , VALUE VARCHAR(500) NULL
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	 , CONSTRAINT PK_ACSTRINGINFO_1 PRIMARY KEY (REPORTTIME,PROFILEID)
);
CREATE INDEX IX_ACSTRINGINFO_2 ON ACSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC );
CREATE INDEX IX_ACSTRINGINFO_3 ON ACSTRINGINFO(SYNCSTATUS ASC);

CREATE TABLE ACEVENT (
	   EVENTID BIGINT NOT NULL AUTO_INCREMENT
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID  BIGINT NOT NULL
	 , VALUE VARCHAR(100) NULL
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	 , CONSTRAINT PK_ACEVENT_1 PRIMARY KEY (EVENTID)
	 , CONSTRAINT FK_ACEVENT_1 FOREIGN KEY (DEVICELISTID)
				REFERENCES DEVICELIST (LISTID)
) ;
CREATE UNIQUE INDEX UQ_ACEVENT_1 ON ACEVENT(DEVICELISTID ASC , ATTRID ASC);
CREATE INDEX IX_ACEVENT_1 ON ACEVENT(SYNCSTATUS ASC);


CREATE TABLE ACEVENTINFO (
	   REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , EVENTID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
	 , VALUE VARCHAR(100) NULL
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	 , CONSTRAINT PK_ACEVENTINFO_1 PRIMARY KEY (REPORTTIME,EVENTID)
);
CREATE INDEX IX_ACEVENTINFO_2 ON ACEVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_ACEVENTINFO_3 ON ACEVENTINFO(SYNCSTATUS ASC);

-- 感測器
-- CURCOMPOSITESENSINGDATA
CREATE TABLE CURCOMPOSITESENSINGDATA (
       SENSORID VARCHAR(20) NOT NULL
     , TIME TIMESTAMP
     , TEMPERATURE DECIMAL(20,6)
     , HUMIDITY DECIMAL(20,6)
     , BRIGHTNESS DECIMAL(20,6)
     , OLDGROUPID VARCHAR(20)
     , LOCATION CHAR(1)
     , GWID VARCHAR(20)
     , MANUCODE VARCHAR(2)
     , DEVICETYPE VARCHAR(5)
     , IRRADIANCE DECIMAL(20,6)
     , CUMIRRADIATION DECIMAL(20,6)
     , PLACE VARCHAR(100)
     , CO DECIMAL(20,6)
     , CO2 DECIMAL(20,6)
     , COALERT CHAR(1)
     , CONNSTATUS VARCHAR(1)
     , NAME VARCHAR(100)
     , UPDATETIME TIMESTAMP
     , CREATETIME TIMESTAMP
     , TEMPUNIT CHAR(1)
     , TEMPINFORM CHAR(1)
     , HUMIINFORM CHAR(1)
     , OFFLINENOTIFY CHAR(1) DEFAULT '1'
     , GROUPID BIGINT
     , DEVICELISTID BIGINT
     , CONSTRAINT PK_CURCOMPOSITESENSINGDATA PRIMARY KEY (SENSORID)
     , CONSTRAINT FK_CURCOMPOSITESENSINGDATA_2 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
);
CREATE INDEX IX_CURCOMPOSITESENSINGDATA_1 ON CURCOMPOSITESENSINGDATA (GWID ASC);
CREATE INDEX IX_CURCOMPOSITESENSINGDATA_2 ON CURCOMPOSITESENSINGDATA (GROUPID ASC);
CREATE INDEX IX_CURCOMPOSITESENSINGDATA_3 ON CURCOMPOSITESENSINGDATA (DEVICELISTID ASC);

CREATE TABLE COMPOSITESENSINGDATA (
       SENSORID VARCHAR(20) NOT NULL
     , TIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , TEMPERATURE DECIMAL(20,6)
     , HUMIDITY DECIMAL(20,6)
     , BRIGHTNESS DECIMAL(20,6)
     , IRRADIANCE DECIMAL(20,6)
     , CUMIRRADIATION DECIMAL(20,6)
     , CO DECIMAL(20,6)
     , CO2 DECIMAL(20,6)
     , CONSTRAINT PK_COMPOSITESENSINGDATA PRIMARY KEY (SENSORID, TIME)
     , CONSTRAINT FK_COMPOSITESENSINGDATA_1 FOREIGN KEY (SENSORID)
                  REFERENCES CURCOMPOSITESENSINGDATA (SENSORID)
);
CREATE INDEX IX_COMPOSITESENSINGDATA_1 ON COMPOSITESENSINGDATA (SENSORID ASC);
CREATE INDEX IX_COMPOSITESENSINGDATA_2 ON COMPOSITESENSINGDATA (TIME ASC);

CREATE TABLE COMPOSITESENSINGEVENT (
       SENSORID VARCHAR(20) NOT NULL
     , EVENTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , EVENTTYPE VARCHAR(2)
     , EVENTVALUE VARCHAR(10)
     , CONSTRAINT PK_COMPOSITESENSINGEVENT PRIMARY KEY (SENSORID, EVENTTIME)
     , CONSTRAINT FK_COMPOSITESENSINGEVENT_1 FOREIGN KEY (SENSORID)
                  REFERENCES CURCOMPOSITESENSINGDATA (SENSORID)
);
CREATE INDEX IX_COMPOSITESENSINGEVENT_1 ON COMPOSITESENSINGEVENT (SENSORID ASC);
CREATE INDEX IX_COMPOSITESENSINGEVENT_2 ON COMPOSITESENSINGEVENT (EVENTTIME ASC);

-- SENSORPROFILE
CREATE TABLE SENSORPROFILE (
       PROFILEID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE TEXT
     , ATTRTYPE CHAR(1) NOT NULL
     , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_SENSORPROFILE PRIMARY KEY (PROFILEID)
     , CONSTRAINT FK_SENSORPROFILE_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_SENSORPROFILE_1 ON SENSORPROFILE (DEVICELISTID ASC, ATTRID ASC);
CREATE INDEX IX_SENSORPROFILE_1 ON SENSORPROFILE(SYNCSTATUS ASC);


CREATE TABLE SENSORNUMBERINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
     , VALUE DECIMAL(20,6)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , ATTRID DECIMAL NOT NULL
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_SENSORNUMBERINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_SENSORNUMBERINFO_3 ON SENSORNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_SENSORNUMBERINFO_4 ON SENSORNUMBERINFO (SYNCSTATUS ASC);

CREATE TABLE SENSORSTRINGINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
     , VALUE TEXT
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , ATTRID DECIMAL NOT NULL
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_SENSORSTRINGINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_SENSORSTRINGINFO_3 ON SENSORSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_SENSORSTRINGINFO_4 ON SENSORSTRINGINFO (SYNCSTATUS ASC);

CREATE TABLE SENSOREVENT (
       EVENTID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID DECIMAL NOT NULL
     , VALUE VARCHAR(100)
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_SENSOREVENT PRIMARY KEY (EVENTID)
     , CONSTRAINT FK_SENSOREVENT_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_SENSOREVENT_1 ON SENSOREVENT (DEVICELISTID ASC, ATTRID ASC);
CREATE INDEX IX_SENSOREVENT_1 ON SENSOREVENT (SYNCSTATUS ASC);

CREATE TABLE SENSOREVENTINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , EVENTID BIGINT NOT NULL
     , DEVICELISTID BIGINT NOT NULL
     , VALUE VARCHAR(100)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , ATTRID BIGINT NOT NULL
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_SENSOREVENTINFO PRIMARY KEY (EVENTID, REPORTTIME)
);
CREATE INDEX IX_SENSOREVENTINFO_3 ON SENSOREVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_SENSOREVENTINFO_4 ON SENSOREVENTINFO (SYNCSTATUS ASC);


CREATE TABLE SENSORSTATISTICINFO
(
   CREATETIME	TIMESTAMP	NOT NULL
 , UPDATETIME	TIMESTAMP	NOT NULL
 , STATISTICTIME	TIMESTAMP	NOT NULL
 , TIMEZONE	VARCHAR(10)	NOT NULL
 , STATISTICTYPE	SMALLINT	NOT NULL
 , PROFILEID	BIGINT	NOT NULL
 , DEVICELISTID	BIGINT	NOT NULL
 , ATTRID	BIGINT	NOT NULL
 , SUM	NUMERIC(20, 6)	NOT NULL
 , COUNT	BIGINT	NOT NULL
 , MIN	NUMERIC(20, 6)	NOT NULL
 , MAX	NUMERIC(20, 6)	NOT NULL
 , CONSTRAINT PK_SENSORSTATISTICINFO PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
);
CREATE INDEX IX_SENSORSTATISTICINFO_1 ON SENSORSTATISTICINFO(DEVICELISTID,ATTRID,STATISTICTIME) ;

CREATE TABLE PVSTRINGMETERPROFILE (
       PROFILEID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , ATTRTYPE CHAR(1) NOT NULL
     , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_PVSTRINGMETERPROFILE PRIMARY KEY (PROFILEID)
     , CONSTRAINT FK_PVSTRINGMETERPROFILE_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);

CREATE UNIQUE INDEX UQ_PVSTRINGMETERPROFILE_1 ON PVSTRINGMETERPROFILE (DEVICELISTID ASC, ATTRID ASC);
CREATE  INDEX IX_PVSTRINGMETERPROFILE_2 ON PVSTRINGMETERPROFILE(SYNCSTATUS ASC);

CREATE TABLE PVSTRINGMETERNUMBERINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE DECIMAL(20,6)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_PVSTRINGMETERNUMBERINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_PVSTRINGMETERNUMBERINFO_3 ON PVSTRINGMETERNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE PVSTRINGMETERSTRINGINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_PVSTRINGMETERSTRINGINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_PVSTRINGMETERSTRINGINFO_3 ON PVSTRINGMETERSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE PVSTRINGMETEREVENT (
       EVENTID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_PVSTRINGMETEREVENT PRIMARY KEY (EVENTID)
     , CONSTRAINT FK_PVSTRINGMETEREVENT_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);

CREATE UNIQUE INDEX UQ_PVSTRINGMETEREVENT_1 ON PVSTRINGMETEREVENT (DEVICELISTID ASC, ATTRID ASC);


CREATE TABLE PVSTRINGMETEREVENTINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , EVENTID BIGINT NOT NULL
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_PVSTRINGMETEREVENTINFO PRIMARY KEY (EVENTID, REPORTTIME)
);
CREATE INDEX IX_PVSTRINGMETEREVENTINFO_3 ON PVSTRINGMETEREVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE PV_METER_CIRCUIT
(
CIRCUITID	BIGINT NULL  AUTO_INCREMENT
,CELL1_SPEC_KW	DECIMAL(20,6)	NULL
,CELL1_SPEC_V	DECIMAL(20,6)	NULL
,CELL1_STATUS	CHAR(2)	NULL
,CELL1_EVENT_CODE	VARCHAR(8)	NULL
,CELL1_EVENT_VALUE	VARCHAR(8)	NULL
,CELL1_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL2_SPEC_KW	DECIMAL(20,6)	NULL
,CELL2_SPEC_V	DECIMAL(20,6)	NULL
,CELL2_STATUS	CHAR(2)	NULL
,CELL2_EVENT_CODE	VARCHAR(8)	NULL
,CELL2_EVENT_VALUE	VARCHAR(8)	NULL
,CELL2_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL3_SPEC_KW	DECIMAL(20,6)	NULL
,CELL3_SPEC_V	DECIMAL(20,6)	NULL
,CELL3_STATUS	CHAR(2)	NULL
,CELL3_EVENT_CODE	VARCHAR(8)	NULL
,CELL3_EVENT_VALUE	VARCHAR(8)	NULL
,CELL3_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL4_SPEC_KW	DECIMAL(20,6)	NULL
,CELL4_SPEC_V	DECIMAL(20,6)	NULL
,CELL4_STATUS	CHAR(2)	NULL
,CELL4_EVENT_CODE	VARCHAR(8)	NULL
,CELL4_EVENT_VALUE	VARCHAR(8)	NULL
,CELL4_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL5_SPEC_KW	DECIMAL(20,6)	NULL
,CELL5_SPEC_V	DECIMAL(20,6)	NULL
,CELL5_STATUS	CHAR(2)	NULL
,CELL5_EVENT_CODE	VARCHAR(8)	NULL
,CELL5_EVENT_VALUE	VARCHAR(8)	NULL
,CELL5_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL6_SPEC_KW	DECIMAL(20,6)	NULL
,CELL6_SPEC_V	DECIMAL(20,6)	NULL
,CELL6_STATUS	CHAR(2)	NULL
,CELL6_EVENT_CODE	VARCHAR(8)	NULL
,CELL6_EVENT_VALUE	VARCHAR(8)	NULL
,CELL6_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL7_SPEC_KW	DECIMAL(20,6)	NULL
,CELL7_SPEC_V	DECIMAL(20,6)	NULL
,CELL7_STATUS	CHAR(2)	NULL
,CELL7_EVENT_CODE	VARCHAR(8)	NULL
,CELL7_EVENT_VALUE	VARCHAR(8)	NULL
,CELL7_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL8_SPEC_KW	DECIMAL(20,6)	NULL
,CELL8_SPEC_V	DECIMAL(20,6)	NULL
,CELL8_STATUS	CHAR(2)	NULL
,CELL8_EVENT_CODE	VARCHAR(8)	NULL
,CELL8_EVENT_VALUE	VARCHAR(8)	NULL
,CELL8_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL9_SPEC_KW	DECIMAL(20,6)	NULL
,CELL9_SPEC_V	DECIMAL(20,6)	NULL
,CELL9_STATUS	CHAR(2)	NULL
,CELL9_EVENT_CODE	VARCHAR(8)	NULL
,CELL9_EVENT_VALUE	VARCHAR(8)	NULL
,CELL9_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL10_SPEC_KW	DECIMAL(20,6)	NULL
,CELL10_SPEC_V	DECIMAL(20,6)	NULL
,CELL10_STATUS	CHAR(2)	NULL
,CELL10_EVENT_CODE	VARCHAR(8)	NULL
,CELL10_EVENT_VALUE	VARCHAR(8)	NULL
,CELL10_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL11_SPEC_KW	DECIMAL(20,6)	NULL
,CELL11_SPEC_V	DECIMAL(20,6)	NULL
,CELL11_STATUS	CHAR(2)	NULL
,CELL11_EVENT_CODE	VARCHAR(8)	NULL
,CELL11_EVENT_VALUE	VARCHAR(8)	NULL
,CELL11_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL12_SPEC_KW	DECIMAL(20,6)	NULL
,CELL12_SPEC_V	DECIMAL(20,6)	NULL
,CELL12_STATUS	CHAR(2)	NULL
,CELL12_EVENT_CODE	VARCHAR(8)	NULL
,CELL12_EVENT_VALUE	VARCHAR(8)	NULL
,CELL12_EVENT_REPORTTIME	TIMESTAMP	NULL
,CELL13_SPEC_KW	DECIMAL(20,6)	NULL
,CELL13_SPEC_V	DECIMAL(20,6)	NULL
,CELL13_STATUS	CHAR(2)	NULL
,CELL13_EVENT_CODE	VARCHAR(8)	NULL
,CELL13_EVENT_VALUE	VARCHAR(8)	NULL
,CELL13_EVENT_REPORTTIME	TIMESTAMP	NULL
, CONSTRAINT PK_PV_METER_CIRCUIT PRIMARY KEY (CIRCUITID)
);

CREATE TABLE PV_DCSTRINGMETER (
       DCSM_ID BIGINT NOT NULL AUTO_INCREMENT
     , GWID VARCHAR(20)
     , OLDGROUPID VARCHAR(20)
     , DCSM_STATUS VARCHAR(2)
     , DCSM_V DECIMAL(20,6)
     , DCSM_KW DECIMAL(20,6)
     , DCSM_KWH DECIMAL(20,6)
     , DCSM_HR DECIMAL(20,6)
     , DCSM_THRE DECIMAL(20,6)
     , DCSM_CELL_NUM INT
     , CELL1_STATUS VARCHAR(2)
     , CELL1_KW DECIMAL(20,6)
     , CELL1_RATIO DECIMAL(20,6)
     , CELL2_STATUS VARCHAR(2)
     , CELL2_KW DECIMAL(20,6)
     , CELL2_RATIO DECIMAL(20,6)
     , CELL3_STATUS VARCHAR(2)
     , CELL3_KW DECIMAL(20,6)
     , CELL3_RATIO DECIMAL(20,6)
     , CELL4_STATUS VARCHAR(2)
     , CELL4_KW DECIMAL(20,6)
     , CELL4_RATIO DECIMAL(20,6)
     , CELL5_STATUS VARCHAR(2)
     , CELL5_KW DECIMAL(20,6)
     , CELL5_RATIO DECIMAL(20,6)
     , CELL6_STATUS VARCHAR(2)
     , CELL6_KW DECIMAL(20,6)
     , CELL6_RATIO DECIMAL(20,6)
     , CELL7_STATUS VARCHAR(2)
     , CELL7_KW DECIMAL(20,6)
     , CELL7_RATIO DECIMAL(20,6)
     , CELL8_STATUS VARCHAR(2)
     , CELL8_KW DECIMAL(20,6)
     , CELL8_RATIO DECIMAL(20,6)
     , CELL9_STATUS VARCHAR(2)
     , CELL9_KW DECIMAL(20,6)
     , CELL9_RATIO DECIMAL(20,6)
     , CELL10_STATUS VARCHAR(2)
     , CELL10_KW DECIMAL(20,6)
     , CELL10_RATIO DECIMAL(20,6)
     , CELL11_STATUS VARCHAR(2)
     , CELL11_KW DECIMAL(20,6)
     , CELL11_RATIO DECIMAL(20,6)
     , CELL12_STATUS VARCHAR(2)
     , CELL12_KW DECIMAL(20,6)
     , CELL12_RATIO DECIMAL(20,6)
     , CELL13_STATUS VARCHAR(2)
     , CELL13_KW DECIMAL(20,6)
     , CELL13_RATIO DECIMAL(20,6)
     , DCSM_CREATE_TIME TIMESTAMP
     , DCSM_UPDATE_TIME TIMESTAMP
     , DEVICE_ID VARCHAR(20)
     , DCSM_REPORT_TIME TIMESTAMP
     , NAME VARCHAR(64)
     , GROUPID BIGINT
     , DCSM_I DECIMAL(20,6)
     , DCSM_TEMP DECIMAL(20,6)
     , CONNECTIONSTATUS CHAR(1)
     , RA DECIMAL(20,6)
     , STRINGLIST VARCHAR(30)
     , CIRCUITID	BIGINT	NULL
     , CONSTRAINT PK_PV_DCSTRINGMETER PRIMARY KEY (DCSM_ID)
     , CONSTRAINT UQ_PV_DCSTRINGMETER_1 UNIQUE (DEVICE_ID)
     , CONSTRAINT FK_PV_DCSTRINGMETER_2 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
 	 , CONSTRAINT FK_PV_DCSTRINGMETER_3 FOREIGN KEY (CIRCUITID)
                  REFERENCES PV_METER_CIRCUIT (CIRCUITID)
);
CREATE INDEX IX_PV_DCSTRINGMETER_1 ON PV_DCSTRINGMETER (GWID ASC);
CREATE INDEX IX_PV_DCSTRINGMETER_2 ON PV_DCSTRINGMETER (GROUPID ASC);


CREATE TABLE PV_DCSTRINGMETER_INFO (
       DCSM_INFO_ID BIGINT NOT NULL AUTO_INCREMENT
     , DCSM_ID BIGINT
     , DCSM_V DECIMAL(20,6)
     , DCSM_KW DECIMAL(20,6)
     , DCSM_KWH DECIMAL(20,6)
     , DCSM_CELL_NUM INT
     , CELL1_KW DECIMAL(20,6)
     , CELL1_RATIO DECIMAL(20,6)
     , CELL2_KW DECIMAL(20,6)
     , CELL2_RATIO DECIMAL(20,6)
     , CELL3_KW DECIMAL(20,6)
     , CELL3_RATIO DECIMAL(20,6)
     , CELL4_KW DECIMAL(20,6)
     , CELL4_RATIO DECIMAL(20,6)
     , CELL5_KW DECIMAL(20,6)
     , CELL5_RATIO DECIMAL(20,6)
     , CELL6_KW DECIMAL(20,6)
     , CELL6_RATIO DECIMAL(20,6)
     , CELL7_KW DECIMAL(20,6)
     , CELL7_RATIO DECIMAL(20,6)
     , CELL8_KW DECIMAL(20,6)
     , CELL8_RATIO DECIMAL(20,6)
     , CELL9_KW DECIMAL(20,6)
     , CELL9_RATIO DECIMAL(20,6)
     , CELL10_KW DECIMAL(20,6)
     , CELL10_RATIO DECIMAL(20,6)
     , CELL11_KW DECIMAL(20,6)
     , CELL11_RATIO DECIMAL(20,6)
     , CELL12_KW DECIMAL(20,6)
     , CELL12_RATIO DECIMAL(20,6)
     , CELL13_KW DECIMAL(20,6)
     , CELL13_RATIO DECIMAL(20,6)
     , UPDATETIME TIMESTAMP
     , REPORTTIME TIMESTAMP
     , DCSM_I DECIMAL(20,6)
     , DCSM_TEMP DECIMAL(20,6)
     , RA DECIMAL(20,6)
     , CONSTRAINT PK_PV_DCSTRINGMETER_INFO PRIMARY KEY (DCSM_INFO_ID)
     , CONSTRAINT UQ_PV_DCSTRINGMETER_INFO_1 UNIQUE (DCSM_ID, REPORTTIME)
     , CONSTRAINT FK_PV_DCSTRINGMETER_INFO_1 FOREIGN KEY (DCSM_ID)
                  REFERENCES PV_DCSTRINGMETER (DCSM_ID)
);
CREATE INDEX IX_PV_DCSTRINGMETER_INFO_1 ON PV_DCSTRINGMETER_INFO (DCSM_ID ASC);
CREATE INDEX IX_PV_DCSTRINGMETER_INFO_2 ON PV_DCSTRINGMETER_INFO (REPORTTIME ASC);

CREATE TABLE PV_DCSTRINGMETER_STATISTICS (
       DCSM_ID BIGINT NOT NULL
     , STATSTIME VARCHAR(12) NOT NULL
     , STATSTYPE CHAR(1)
     , UPDATETIME TIMESTAMP
     , TOTALENERGY DECIMAL(20,6) DEFAULT 0
     , MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL1_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL2_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL3_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL4_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL5_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL6_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL7_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL8_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL9_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL10_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL11_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL12_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , CELL13_MAXPOWER DECIMAL(20,6) DEFAULT 0
     , REVENUE DECIMAL(20,6) DEFAULT 0
     , CO2 DECIMAL(20,6) DEFAULT 0
     , PR DECIMAL(20,6)
     , AVGPOWER DECIMAL(20,6)
     , AVGRA DECIMAL(20,6)
     , RECCOUNT INTEGER
     , CONSTRAINT PK_PV_STRINGMETER_STATS PRIMARY KEY (DCSM_ID, STATSTIME)
     , CONSTRAINT FK_PV_STRINGMETER_STATS_1 FOREIGN KEY (DCSM_ID)
                  REFERENCES PV_DCSTRINGMETER (DCSM_ID)
);
CREATE INDEX IX_PV_STRINGMETER_STATS_1 ON PV_DCSTRINGMETER_STATISTICS (DCSM_ID ASC);
CREATE INDEX IX_PV_STRINGMETER_STATS_2 ON PV_DCSTRINGMETER_STATISTICS (STATSTIME ASC, STATSTYPE ASC);
CREATE INDEX IX_PV_STRINGMETER_STATS_3 ON PV_DCSTRINGMETER_STATISTICS (DCSM_ID ASC, STATSTIME ASC, STATSTYPE ASC);
-- 控制器
-- CONTROLLERLIST
CREATE TABLE CONTROLLERLIST (
       DEVICEID VARCHAR(23) NOT NULL
     , MANUCODE VARCHAR(2)
     , DEVICETYPE VARCHAR(2)
     , PARENTID VARCHAR(23)
     , PARENTTABLE VARCHAR(30)
     , GATEWAYID VARCHAR(20) NOT NULL
     , ISENABLE CHAR(1) DEFAULT '1'
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CREATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_CONTROLLERLIST PRIMARY KEY (DEVICEID)
);
CREATE INDEX IX_CONTROLLERLIST_1 ON CONTROLLERLIST (MANUCODE ASC);
CREATE INDEX IX_CONTROLLERLIST_2 ON CONTROLLERLIST (DEVICETYPE ASC);
CREATE INDEX IX_CONTROLLERLIST_3 ON CONTROLLERLIST (PARENTID ASC);
CREATE INDEX IX_CONTROLLERLIST_4 ON CONTROLLERLIST (GATEWAYID ASC);
CREATE INDEX IX_CONTROLLERLIST_5 ON CONTROLLERLIST (ISENABLE ASC);

-- CONTROLLERPROFILE2
CREATE TABLE CONTROLLERPROFILE2 (
       DEVICEID VARCHAR(23) NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
     , DEVICELISTID BIGINT
     , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CREATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_CONTROLLERPROFILE2 PRIMARY KEY (DEVICEID, ATTRID)
);
CREATE INDEX IX_CONTROLLERPROFILE2_1 ON CONTROLLERPROFILE2 (DEVICEID ASC);
CREATE INDEX IX_CONTROLLERPROFILE2_2 ON CONTROLLERPROFILE2 (ATTRID ASC);
CREATE INDEX IX_CONTROLLERPROFILE2_3 ON CONTROLLERPROFILE2 (DEVICELISTID ASC);

CREATE TABLE CONTROLLERINFO2 (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , DEVICEID VARCHAR(23) NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
     , DEVICELISTID BIGINT
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_CONTROLLERINFO2 PRIMARY KEY (REPORTTIME, DEVICEID, ATTRID)
     , CONSTRAINT FK_CONTROLLERINFO2_1 FOREIGN KEY (DEVICEID, ATTRID)
                  REFERENCES CONTROLLERPROFILE2 (DEVICEID, ATTRID)
);
CREATE INDEX IX_CONTROLLERINFO2_1 ON CONTROLLERINFO2 (REPORTTIME ASC);
CREATE INDEX IX_CONTROLLERINFO2_2 ON CONTROLLERINFO2 (DEVICEID ASC);
CREATE INDEX IX_CONTROLLERINFO2_3 ON CONTROLLERINFO2 (ATTRID ASC);
CREATE INDEX IX_CONTROLLERINFO2_4 ON CONTROLLERINFO2 (DEVICELISTID ASC);

-- CTRLLERPROFILE
CREATE TABLE CTRLLERPROFILE (
	PROFILEID	BIGINT	NOT NULL AUTO_INCREMENT
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT 	NOT NULL
	,VALUE	VARCHAR(500)	NULL
	,ATTRTYPE	CHAR(1)	NOT NULL
	,REPORTTIME	TIMESTAMP	NOT NULL DEFAULT '0000-00-00 00:00:00'
	,UPDATETIME	TIMESTAMP	NOT NULL DEFAULT '0000-00-00 00:00:00'
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CONSTRAINT PK_CTRLLERPROFILE PRIMARY KEY(PROFILEID)
	,CONSTRAINT FK_CTRLLERPROFILE_1 FOREIGN KEY (DEVICELISTID)
			 REFERENCES DEVICELIST(LISTID)
);
CREATE UNIQUE INDEX UQ_CTRLLERPROFILE_1 ON CTRLLERPROFILE(DEVICELISTID,ATTRID);
CREATE INDEX IX_CTRLLERPROFILE_1 ON CTRLLERPROFILE(SYNCSTATUS ASC);

CREATE TABLE CTRLLERNUMBERINFO (
	 REPORTTIME	TIMESTAMP	NOT NULL DEFAULT '0000-00-00 00:00:00'
	,PROFILEID	BIGINT	NOT NULL
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT 	NOT NULL
	,VALUE	DECIMAL(20,6) 	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL DEFAULT '0000-00-00 00:00:00'
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CONSTRAINT PK_CTRLLERNUMBERINFO_1 PRIMARY KEY (REPORTTIME,PROFILEID)
);
CREATE INDEX IX_CTRLLERNUMBERINFO_2 ON CTRLLERNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_CTRLLERNUMBERINFO_3 ON CTRLLERNUMBERINFO(SYNCSTATUS ASC);


CREATE TABLE CTRLLERSTRINGINFO (
	REPORTTIME	TIMESTAMP	NOT NULL
	,PROFILEID	BIGINT	NOT NULL
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT NOT NULL
	,VALUE	VARCHAR(500)	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CONSTRAINT PK_CTRLLERSTRINGINFO_1 PRIMARY KEY (REPORTTIME,PROFILEID)
);
CREATE INDEX IX_CTRLLERSTRINGINFO_2 ON CTRLLERSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_CTRLLERSTRINGINFO_3 ON CTRLLERSTRINGINFO(SYNCSTATUS);

CREATE TABLE CTRLLEREVENT (
	EVENTID	BIGINT	NOT NULL AUTO_INCREMENT
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT 	NOT NULL
	,VALUE	VARCHAR(100)	NULL
	,REPORTTIME	TIMESTAMP	NOT NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CONSTRAINT PK_CTRLLEREVENT_1 PRIMARY KEY (EVENTID)
	,CONSTRAINT FK_CTRLLEREVENT_1 FOREIGN KEY (DEVICELISTID)
			 REFERENCES DEVICELIST(LISTID)
);
CREATE UNIQUE INDEX UQ_CTRLLEREVENT_1 ON CTRLLEREVENT(DEVICELISTID,ATTRID);
CREATE INDEX IX_CTRLLEREVENT_1 ON CTRLLEREVENT(SYNCSTATUS ASC);

CREATE TABLE CTRLLEREVENTINFO (
	REPORTTIME	TIMESTAMP	NOT NULL DEFAULT '0000-00-00 00:00:00'
	,EVENTID	BIGINT	NOT NULL
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT	NOT NULL
	,VALUE	VARCHAR(100)	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL DEFAULT '0000-00-00 00:00:00'
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CONSTRAINT PK_CCTRLLEREVENTINFO_1 PRIMARY KEY (REPORTTIME,EVENTID)
);
CREATE INDEX IX_CTRLLEREVENTINFO_2 ON CTRLLEREVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_CTRLLEREVENTINFO_3 ON CTRLLEREVENTINFO(SYNCSTATUS ASC);


CREATE TABLE ENERGYSTORAGEPROFILE
(
	 PROFILEID	BIGINT	NOT NULL AUTO_INCREMENT
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT	NOT NULL
	,VALUE	VARCHAR(500)	NULL
	,ATTRTYPE	CHAR(1)	NOT NULL
	,REPORTTIME	TIMESTAMP	NOT NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CONSTRAINT PK_ENERGYSTORAGEPROFILE PRIMARY KEY (PROFILEID)
	,CONSTRAINT FK_ENERGYSTORAGEPROFILE_1 FOREIGN KEY (DEVICELISTID)
				REFERENCES DEVICELIST(LISTID)
);
CREATE UNIQUE INDEX UQ_DEVICELISTID_1 ON ENERGYSTORAGEPROFILE(DEVICELISTID,ATTRID);
CREATE  INDEX IX_DEVICELISTID_2 ON ENERGYSTORAGEPROFILE(SYNCSTATUS ASC);
CREATE TABLE ENERGYSTORAGENUMBERINFO
(
	 REPORTTIME	TIMESTAMP	NOT NULL
	,PROFILEID	BIGINT	NOT NULL
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT	NOT NULL
	,VALUE	 DECIMAL(20,6)	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,CONSTRAINT PK_ENERGYSTORAGENUMBERINFO PRIMARY KEY(REPORTTIME,PROFILEID)
);
CREATE INDEX IX_ENERGYSTORAGENUMBERINFO_2 ON ENERGYSTORAGENUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE ENERGYSTORAGESTRINGINFO
(
	 REPORTTIME	TIMESTAMP	NOT NULL
	,PROFILEID	BIGINT	NOT NULL
  ,DEVICELISTID  BIGINT  NOT NULL
  ,ATTRID  BIGINT  NOT NULL
  ,VALUE  VARCHAR(500)  NULL
  ,UPDATETIME  TIMESTAMP  NOT NULL
  ,CONSTRAINT PK_ENERGYSTORAGESTRINGINFO PRIMARY KEY(REPORTTIME,PROFILEID)
);
CREATE INDEX IX_ENERGYSTORAGESTRINGINFO_2 ON ENERGYSTORAGESTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE ENERGYSTORAGEEVENT
(
   EVENTID  BIGINT  NOT NULL AUTO_INCREMENT
  ,DEVICELISTID  BIGINT  NOT NULL
  ,ATTRID  BIGINT  NOT NULL
  ,VALUE  VARCHAR(100)  NULL
  ,REPORTTIME  TIMESTAMP  NOT NULL
  ,UPDATETIME  TIMESTAMP  NOT NULL
  ,CONSTRAINT PK_ENERGYSTORAGEEVENT PRIMARY KEY(EVENTID)
  ,CONSTRAINT FK_ENERGYSTORAGEEVENT_1 FOREIGN KEY (DEVICELISTID)
        REFERENCES DEVICELIST(LISTID)
);
CREATE UNIQUE INDEX UQ_ENERGYSTORAGEEVENT_1 ON ENERGYSTORAGEEVENT(DEVICELISTID,ATTRID);

CREATE TABLE ENERGYSTORAGEEVENTINFO
(
   REPORTTIME  TIMESTAMP  NOT NULL
  ,EVENTID  BIGINT  NOT NULL
  ,DEVICELISTID  BIGINT  NOT NULL
  ,ATTRID  BIGINT  NOT NULL
  ,VALUE  VARCHAR(100)  NULL
  ,UPDATETIME  TIMESTAMP  NOT NULL
  ,CONSTRAINT PK_ENERGYSTORAGEEVENTINFO PRIMARY KEY(REPORTTIME,EVENTID)
);
CREATE INDEX IX_ENERGYSTORAGEEVENTINFO_2 ON ENERGYSTORAGEEVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE ENERGYSTORAGESTATISTICS(
   DEVICELISTID  BIGINT  NOT NULL
  ,STATSTIME  TIMESTAMP  NOT NULL
  ,STATSTYPE  CHAR(1)  NOT NULL
  ,UPDATETIME  TIMESTAMP  NOT NULL
  ,MODULETEMPERATURE_11  DECIMAL(20,6)  DEFAULT 0 NULL
  ,MODULETEMPERATURE_12  DECIMAL(20,6)  DEFAULT 0 NULL
  ,MODULETEMPERATURE_13  DECIMAL(20,6)  DEFAULT 0 NULL
  ,MODULETEMPERATURE_21  DECIMAL(20,6)  DEFAULT 0 NULL
  ,MODULETEMPERATURE_22  DECIMAL(20,6)  DEFAULT 0 NULL
  ,MODULETEMPERATURE_23  DECIMAL(20,6)  DEFAULT 0 NULL
  ,PACKVOLTAGE  DECIMAL(20,6)  DEFAULT 0 NULL
  ,MODULEVOLTAGE_1  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_11  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_12  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_13  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_14  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_15  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_16  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_17  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_18  DECIMAL(20,6)  DEFAULT 0 NULL
  ,MODULEVOLTAGE_2  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_21  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_22  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_23  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_24  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_25  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_26  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_27  DECIMAL(20,6)  DEFAULT 0 NULL
  ,CELLVOLTAGE_28  DECIMAL(20,6)  DEFAULT 0 NULL
  ,PACKCURRENT  DECIMAL(20,6)  DEFAULT 0 NULL
  ,RECCOUNT  INT  DEFAULT 0 NULL
  ,CONSTRAINT PK_ENERGYSTORAGESTATISTICS PRIMARY KEY (DEVICELISTID,STATSTIME)
);

-- 電表
-- DEVICECONFIG
CREATE TABLE DEVICECONFIG (
       DCID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICEID VARCHAR(20)
     , GWID VARCHAR(20)
     , OLDGROUPID VARCHAR(20)
     , ADDRESS VARCHAR(20)
     , SUBADDRESS VARCHAR(20)
     , MANUCODE VARCHAR(2)
     , DEVICETYPE VARCHAR(5)
     , DEVICESTATUS VARCHAR(2)
     , DEVICENAME VARCHAR(100)
     , DEVICEPLACE VARCHAR(100)
     , TRANSPERIOD INT
     , UPDATETIME TIMESTAMP
     , LOADPACKAGE VARCHAR(150)
     , LATITUDE DECIMAL(20,6)
     , LONGITUDE DECIMAL(20,6)
     , OFFLINENOTIFY CHAR(1) DEFAULT '1'
     , CREATETIME TIMESTAMP
     , CONNECTIONSTATUS CHAR(1) NOT NULL DEFAULT '0'
     , ISSYNC VARCHAR(1)
     , GROUPID BIGINT
     , MODELID BIGINT NULL
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_DEVICECONFIG PRIMARY KEY (DCID)
     , CONSTRAINT UQ_DEVICECONFIG_1 UNIQUE (DEVICEID)
     , CONSTRAINT FK_DEVICECONFIG_2 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
     , CONSTRAINT FK_DEVICECONFIG_4 FOREIGN KEY (MODELID)
     			  REFERENCES MODELINFO (MODELID)
);
CREATE INDEX IX_DEVICECONFIG_1 ON DEVICECONFIG (GWID ASC);
CREATE INDEX IX_DEVICECONFIG_2 ON DEVICECONFIG (GROUPID ASC);


CREATE TABLE AREAINFO (
       AREAID BIGINT NOT NULL AUTO_INCREMENT
     , AREANAME VARCHAR(64)
     , PICTURE VARCHAR(256)
     , ATFLOOR VARCHAR(3)
     , AREASIZE INT
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , GROUPID BIGINT
     , MEASURE VARCHAR(2)
     , WIDTH INT
     , HEIGHT INT
     , PARENTID BIGINT
	 , POSX DECIMAL(20,6)
	 , POSY DECIMAL(20,6)
	 , UPDATETIME TIMESTAMP NULL
	 , RADIUS VARCHAR(500)
	 , AREATYPE CHAR(1) NULL
     , CONSTRAINT PK_AREAINFO PRIMARY KEY (AREAID)
     , CONSTRAINT FK_AREAINFO_1 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
     , CONSTRAINT FK_AREAINFO_2 FOREIGN KEY (PARENTID)
                  REFERENCES AREAINFO (AREAID)
);
CREATE INDEX IX_AREAINFO_1 ON AREAINFO (GROUPID ASC);

CREATE TABLE METERCIRCUIT (
       CIRCUITID BIGINT NOT NULL AUTO_INCREMENT
     , LOADID VARCHAR(2) DEFAULT '0' NOT NULL
     , LOADNAME VARCHAR(100)
     , DCID BIGINT     NOT NULL
     , CHANNELA VARCHAR(5)
     , CHANNELB VARCHAR(5)
     , CHANNELC VARCHAR(5)
     , CHANAME VARCHAR(100)
     , CHBNAME VARCHAR(100)
     , CHCNAME VARCHAR(100)
     , UPDATETIME TIMESTAMP
     , CATEGORY VARCHAR(2)
     , CATEGORYA VARCHAR(2)
     , CATEGORYB VARCHAR(2)
     , CATEGORYC VARCHAR(2)
     , SHOWONMAP CHAR(1) DEFAULT '0'
     , CTRATIO DECIMAL(20,6) DEFAULT 1 NOT NULL
     , PTRATIO DECIMAL(20,6) DEFAULT 1 NOT NULL
     , FLOORSPACE DECIMAL(20,6)
     , FORCASTPARAMETER VARCHAR(350)
     , METERTYPE VARCHAR(1)
     , PRICEID BIGINT
     , LOADTYPE VARCHAR(4)
     , SOCKETPARENTID VARCHAR(6)
	 , HAVEDEMAND CHAR(1) DEFAULT '0' -- 指本身具備需量預測功能
     , DEMANDENABLE CHAR(1) DEFAULT '0' -- 可使用系統的需量分析功能
     , CONTRACTID BIGINT
     , MAINLOAD CHAR(1) DEFAULT '0'
     , ALARMSTATUS VARCHAR(5)
     , ISSYNC VARCHAR(1)
     , ISENABLE CHAR(1) DEFAULT '1'
     , HAVEDEMANDSTATS CHAR(1)
	 , LOADCATEGORY VARCHAR(2)
	 , MODELID BIGINT NULL
	 , AREAID	BIGINT	NULL
	 , POSX DECIMAL(20,6)	NULL
	 , POSY	DECIMAL(20,6)	NULL
	 , AREABLOCKID	BIGINT	NULL
	 , ISIDENTIFY INT DEFAULT 0 NOT NULL
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0'  NOT NULL
     , CONSTRAINT PK_METERCIRCUIT PRIMARY KEY (CIRCUITID)
     , CONSTRAINT FK_METERCIRCUIT_1 FOREIGN KEY (DCID)
                  REFERENCES DEVICECONFIG (DCID)
	 , CONSTRAINT FK_METERCIRCUIT_3 FOREIGN KEY (CONTRACTID)
                  REFERENCES DEMANDCONTRACT (CONTRACTID)
     , CONSTRAINT FK_METERCIRCUIT_4 FOREIGN KEY (MODELID)
     			  REFERENCES MODELINFO(MODELID)
	 , CONSTRAINT FK_METERCIRCUIT_5 FOREIGN KEY (AREAID)
	 			  REFERENCES AREAINFO(AREAID)
	 , CONSTRAINT FK_METERCIRCUIT_6 FOREIGN KEY (AREABLOCKID)
	 			  REFERENCES AREAINFO(AREAID)
);
CREATE UNIQUE INDEX UQ_METERCIRCUIT_1 ON METERCIRCUIT (DCID ASC,LOADID ASC);
CREATE INDEX IX_METERCIRCUIT_2 ON METERCIRCUIT (PRICEID ASC);
CREATE INDEX IX_METERCIRCUIT_3 ON METERCIRCUIT (CONTRACTID ASC);

-- METERPROFILE
CREATE TABLE METERPROFILE (
       METERID BIGINT NOT NULL AUTO_INCREMENT
     , DCID BIGINT
     , CIRCUITID BIGINT
     , METERTYPE VARCHAR(1)
     , METERSTATUS VARCHAR(2)
     , METERNAME VARCHAR(100)
     , METERPLACE VARCHAR(100)
     , UPDATETIME TIMESTAMP
     , REPORTTIME TIMESTAMP
     , V DECIMAL(20,6)
     , A DECIMAL(20,6)
     , HZ DECIMAL(20,6)
     , PF DECIMAL(20,6)
     , W DECIMAL(20,6)
     , VA DECIMAL(20,6)
     , VAR DECIMAL(20,6)
     , WHPLUS DECIMAL(20,6)
     , WHMINUS DECIMAL(20,6)
     , VAHPLUS DECIMAL(20,6)
     , VAHMINUS DECIMAL(20,6)
     , VARHPLUS DECIMAL(20,6)
     , VARHMINUS DECIMAL(20,6)
     , DEMANDPREDIC DECIMAL(20,6)
     , DEMANDREMAINTIME DECIMAL(20,6)
     , DEMANDCUR DECIMAL(20,6)
     , DEMANDINSTANT DECIMAL(20,6)
     , VLLAVG DECIMAL(20,6)
     , AAVG DECIMAL(20,6)
     , DEMANDREPORTTIME TIMESTAMP
     , PHASEANGLEVAB DECIMAL(20,6)
     , PHASEANGLEVAC DECIMAL(20,6)
     , DEMANDPRE DECIMAL(20,6)
     , ISSYNC VARCHAR(1)
     , CONNECTIONSTATUS CHAR(1) DEFAULT '0' NOT NULL
     , NOSTATISTICS CHAR(1) DEFAULT '0' NOT NULL
     , OFFLINENOTIFY CHAR(1) DEFAULT '1'
     , SYNCSTATUS VARCHAR(1) NOT NULL DEFAULT '0'
     , VOLTAGEDISTORTION DECIMAL(20,6) NULL
     , VOLTAGEDISTORTION2 DECIMAL(20,6) NULL
     , VOLTAGEDISTORTION3 DECIMAL(20,6) NULL
     , VOLTAGEDISTORTION4 DECIMAL(20,6) NULL
     , VOLTAGEDISTORTION5 DECIMAL(20,6) NULL
     , CURRENTDISTORTION DECIMAL(20,6) NULL
     , CURRENTDISTORTION2 DECIMAL(20,6) NULL
     , CURRENTDISTORTION3 DECIMAL(20,6) NULL
     , CURRENTDISTORTION4 DECIMAL(20,6) NULL
     , CURRENTDISTORTION5 DECIMAL(20,6) NULL
     , NEUTRALCURRENT DECIMAL(20,6) NULL
     , CONSTRAINT PK_METERPROFILE PRIMARY KEY (METERID)
     , CONSTRAINT FK_METERPROFILE_1 FOREIGN KEY (DCID)
                  REFERENCES DEVICECONFIG (DCID)
     , CONSTRAINT FK_METERPROFILE_2 FOREIGN KEY (CIRCUITID)
                  REFERENCES METERCIRCUIT (CIRCUITID)

);
CREATE INDEX IX_METERPROFILE_1 ON METERPROFILE (DCID ASC);
CREATE INDEX IX_METERPROFILE_2 ON METERPROFILE (CIRCUITID ASC);
CREATE INDEX IX_METERPROFILE_3 ON METERPROFILE (NOSTATISTICS ASC);

-- METERPHASE
CREATE TABLE METERPHASE (
       METERID BIGINT NOT NULL
     , VA DECIMAL(20,6)
     , VB DECIMAL(20,6)
     , VC DECIMAL(20,6)
     , AA DECIMAL(20,6)
     , AB DECIMAL(20,6)
     , AC DECIMAL(20,6)
     , HZA DECIMAL(20,6)
     , HZB DECIMAL(20,6)
     , HZC DECIMAL(20,6)
     , PFA DECIMAL(20,6)
     , PFB DECIMAL(20,6)
     , PFC DECIMAL(20,6)
     , WA DECIMAL(20,6)
     , WB DECIMAL(20,6)
     , WC DECIMAL(20,6)
     , VAA DECIMAL(20,6)
     , VAB DECIMAL(20,6)
     , VAC DECIMAL(20,6)
     , VARA DECIMAL(20,6)
     , VARB DECIMAL(20,6)
     , VARC DECIMAL(20,6)
     , WHPLUSA DECIMAL(20,6)
     , WHPLUSB DECIMAL(20,6)
     , WHPLUSC DECIMAL(20,6)
     , WHMINUSA DECIMAL(20,6)
     , WHMINUSB DECIMAL(20,6)
     , WHMINUSC DECIMAL(20,6)
     , VAHPLUSA DECIMAL(20,6)
     , VAHPLUSB DECIMAL(20,6)
     , VAHPLUSC DECIMAL(20,6)
     , VAHMINUSA DECIMAL(20,6)
     , VAHMINUSB DECIMAL(20,6)
     , VAHMINUSC DECIMAL(20,6)
     , VARHPLUSA DECIMAL(20,6)
     , VARHPLUSB DECIMAL(20,6)
     , VARHPLUSC DECIMAL(20,6)
     , VARHMINUSA DECIMAL(20,6)
     , VARHMINUSB DECIMAL(20,6)
     , VARHMINUSC DECIMAL(20,6)
     , V_AB DECIMAL(20,6)
     , V_BC DECIMAL(20,6)
     , V_CA DECIMAL(20,6)
     , VIPHASERELATIONA DECIMAL(20,6)
     , VIPHASERELATIONB DECIMAL(20,6)
     , VIPHASERELATIONC DECIMAL(20,6)
     , ISSYNC VARCHAR(1)
     , VOLTAGEADISTORTION DECIMAL(20,6) NULL
     , VOLTAGEADISTORTION2 DECIMAL(20,6) NULL
     , VOLTAGEADISTORTION3 DECIMAL(20,6) NULL
     , VOLTAGEADISTORTION4 DECIMAL(20,6) NULL
     , VOLTAGEADISTORTION5 DECIMAL(20,6) NULL
     , CURRENTADISTORTION DECIMAL(20,6) NULL
     , CURRENTADISTORTION2 DECIMAL(20,6) NULL
     , CURRENTADISTORTION3 DECIMAL(20,6) NULL
     , CURRENTADISTORTION4 DECIMAL(20,6) NULL
     , CURRENTADISTORTION5 DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION2 DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION3 DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION4 DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION5 DECIMAL(20,6) NULL
     , CURRENTBDISTORTION DECIMAL(20,6) NULL
     , CURRENTBDISTORTION2 DECIMAL(20,6) NULL
     , CURRENTBDISTORTION3 DECIMAL(20,6) NULL
     , CURRENTBDISTORTION4 DECIMAL(20,6) NULL
     , CURRENTBDISTORTION5 DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION2 DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION3 DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION4 DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION5 DECIMAL(20,6) NULL
     , CURRENTCDISTORTION DECIMAL(20,6) NULL
     , CURRENTCDISTORTION2 DECIMAL(20,6) NULL
     , CURRENTCDISTORTION3 DECIMAL(20,6) NULL
     , CURRENTCDISTORTION4 DECIMAL(20,6) NULL
     , CURRENTCDISTORTION5 DECIMAL(20,6) NULL
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_METERPHASE PRIMARY KEY (METERID)
     , CONSTRAINT FK_METERPHASE_1 FOREIGN KEY (METERID)
                  REFERENCES METERPROFILE (METERID)
);
CREATE INDEX IX_METERPHASE_1 ON METERPHASE(SYNCSTATUS);


-- METERINFO2
CREATE TABLE METERINFO2 (
      METERID BIGINT NOT NULL
     , UPDATETIME TIMESTAMP
     , REPORTTIME TIMESTAMP
     , V DECIMAL(20,6)
     , A DECIMAL(20,6)
     , HZ DECIMAL(20,6)
     , PF DECIMAL(20,6)
     , W DECIMAL(20,6)
     , VA DECIMAL(20,6)
     , VAR DECIMAL(20,6)
     , WHPLUS DECIMAL(20,6)
     , WHMINUS DECIMAL(20,6)
     , VAHPLUS DECIMAL(20,6)
     , VAHMINUS DECIMAL(20,6)
     , VARHPLUS DECIMAL(20,6)
     , VARHMINUS DECIMAL(20,6)
     , DEMANDCUR DECIMAL(20,6)
     , VLLAVG DECIMAL(20,6)
     , AAVG DECIMAL(20,6)
     , PHASEANGLEVAB DECIMAL(20,6)
     , PHASEANGLEVAC DECIMAL(20,6)
     , ALARMSTATUS VARCHAR(5)
     , DEMANDPRE DECIMAL(20,6)
     , V_A DECIMAL(20,6)
     , V_B DECIMAL(20,6)
     , V_C DECIMAL(20,6)
     , AA DECIMAL(20,6)
     , AB DECIMAL(20,6)
     , AC DECIMAL(20,6)
     , HZA DECIMAL(20,6)
     , HZB DECIMAL(20,6)
     , HZC DECIMAL(20,6)
     , PFA DECIMAL(20,6)
     , PFB DECIMAL(20,6)
     , PFC DECIMAL(20,6)
     , WA DECIMAL(20,6)
     , WB DECIMAL(20,6)
     , WC DECIMAL(20,6)
     , VAA DECIMAL(20,6)
     , VAB DECIMAL(20,6)
     , VAC DECIMAL(20,6)
     , VARA DECIMAL(20,6)
     , VARB DECIMAL(20,6)
     , VARC DECIMAL(20,6)
     , WHPLUSA DECIMAL(20,6)
     , WHPLUSB DECIMAL(20,6)
     , WHPLUSC DECIMAL(20,6)
     , WHMINUSA DECIMAL(20,6)
     , WHMINUSB DECIMAL(20,6)
     , WHMINUSC DECIMAL(20,6)
     , VAHPLUSA DECIMAL(20,6)
     , VAHPLUSB DECIMAL(20,6)
     , VAHPLUSC DECIMAL(20,6)
     , VAHMINUSA DECIMAL(20,6)
     , VAHMINUSB DECIMAL(20,6)
     , VAHMINUSC DECIMAL(20,6)
     , VARHPLUSA DECIMAL(20,6)
     , VARHPLUSB DECIMAL(20,6)
     , VARHPLUSC DECIMAL(20,6)
     , VARHMINUSA DECIMAL(20,6)
     , VARHMINUSB DECIMAL(20,6)
     , VARHMINUSC DECIMAL(20,6)
     , V_AB DECIMAL(20,6)
     , V_BC DECIMAL(20,6)
     , V_CA DECIMAL(20,6)
     , VIPHASERELATIONA DECIMAL(20,6)
     , VIPHASERELATIONB DECIMAL(20,6)
     , VIPHASERELATIONC DECIMAL(20,6)
     , ISSYNC VARCHAR(1)
     , SYNCSTATUS VARCHAR(1) DEFAULT '0'  NOT NULL
     , VOLTAGEDISTORTION DECIMAL(20,6) NULL
     , VOLTAGEDISTORTION2 DECIMAL(20,6) NULL
     , VOLTAGEDISTORTION3 DECIMAL(20,6) NULL
     , VOLTAGEDISTORTION4 DECIMAL(20,6) NULL
     , VOLTAGEDISTORTION5 DECIMAL(20,6) NULL
     , CURRENTDISTORTION DECIMAL(20,6) NULL
     , CURRENTDISTORTION2 DECIMAL(20,6) NULL
     , CURRENTDISTORTION3 DECIMAL(20,6) NULL
     , CURRENTDISTORTION4 DECIMAL(20,6) NULL
     , CURRENTDISTORTION5 DECIMAL(20,6) NULL
     , VOLTAGEADISTORTION DECIMAL(20,6) NULL
     , VOLTAGEADISTORTION2 DECIMAL(20,6) NULL
     , VOLTAGEADISTORTION3 DECIMAL(20,6) NULL
     , VOLTAGEADISTORTION4 DECIMAL(20,6) NULL
     , VOLTAGEADISTORTION5 DECIMAL(20,6) NULL
     , CURRENTADISTORTION DECIMAL(20,6) NULL
     , CURRENTADISTORTION2 DECIMAL(20,6) NULL
     , CURRENTADISTORTION3 DECIMAL(20,6) NULL
     , CURRENTADISTORTION4 DECIMAL(20,6) NULL
     , CURRENTADISTORTION5 DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION2 DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION3 DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION4 DECIMAL(20,6) NULL
     , VOLTAGEBDISTORTION5 DECIMAL(20,6) NULL
     , CURRENTBDISTORTION DECIMAL(20,6) NULL
     , CURRENTBDISTORTION2 DECIMAL(20,6) NULL
     , CURRENTBDISTORTION3 DECIMAL(20,6) NULL
     , CURRENTBDISTORTION4 DECIMAL(20,6) NULL
     , CURRENTBDISTORTION5 DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION2 DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION3 DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION4 DECIMAL(20,6) NULL
     , VOLTAGECDISTORTION5 DECIMAL(20,6) NULL
     , CURRENTCDISTORTION DECIMAL(20,6) NULL
     , CURRENTCDISTORTION2 DECIMAL(20,6) NULL
     , CURRENTCDISTORTION3 DECIMAL(20,6) NULL
     , CURRENTCDISTORTION4 DECIMAL(20,6) NULL
     , CURRENTCDISTORTION5 DECIMAL(20,6) NULL
     , NEUTRALCURRENT DECIMAL(20,6) NULL
     , CONSTRAINT PK_METERINFO2_1 PRIMARY KEY (METERID, REPORTTIME)
)
PARTITION BY RANGE (UNIX_TIMESTAMP(REPORTTIME))(
 PARTITION p0 VALUES LESS THAN (UNIX_TIMESTAMP('2017-01-01'))
);
CREATE INDEX IX_METERINFO2_1 ON METERINFO2(SYNCSTATUS);
CREATE INDEX IX_METERINFO2_2 ON METERINFO2(REPORTTIME);

-- METEREXTPROFILE
CREATE TABLE METEREXTPROFILE(
	   PROFILEID      BIGINT NOT NULL AUTO_INCREMENT
	 , DEVICELISTID   BIGINT NOT NULL
	 , ATTRID    BIGINT NOT NULL
	 , VALUE   VARCHAR(500)
	 , ATTRTYPE  CHAR(1) NOT NULL
	 , REPORTTIME  TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME  TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	 , CONSTRAINT PK_METEREXTPROFILE PRIMARY KEY (PROFILEID)
	 , CONSTRAINT FK_METEREXTPROFILE_1 FOREIGN KEY (DEVICELISTID)
					REFERENCES DEVICELIST (LISTID)
) ;
CREATE UNIQUE INDEX UQ_METEREXTPROFILE_1 ON METEREXTPROFILE(DEVICELISTID ASC , ATTRID ASC );
CREATE INDEX IX_METEREXTPROFILE_1 ON METEREXTPROFILE(SYNCSTATUS ASC);

CREATE TABLE METERNUMBERINFO (
      REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	, PROFILEID BIGINT NOT NULL
	, DEVICELISTID   BIGINT NOT NULL
	, ATTRID    BIGINT NOT NULL
	, VALUE   DECIMAL(20,6)
	, UPDATETIME  TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	, SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	, CONSTRAINT PK_METERNUMBERINFO_1 PRIMARY KEY (REPORTTIME,PROFILEID)
) ;
CREATE INDEX IX_METERNUMBERINFO_2 ON METERNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC );
CREATE INDEX IX_METERNUMBERINFO_3 ON METERNUMBERINFO(SYNCSTATUS);

CREATE TABLE METERSTRINGINFO (
      REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	, PROFILEID BIGINT NOT NULL
	, DEVICELISTID BIGINT NOT NULL
	, ATTRID    BIGINT NOT NULL
	, VALUE   VARCHAR(500)
	, UPDATETIME  TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	, SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	, CONSTRAINT PK_METERSTRINGINFO_1 PRIMARY KEY (REPORTTIME,PROFILEID)
);
CREATE INDEX IX_METERSTRINGINFO_2 ON METERSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_METERSTRINGINFO_3 ON METERSTRINGINFO(SYNCSTATUS ASC );

CREATE TABLE METEREVENT (
	   EVENTID BIGINT NOT NULL  AUTO_INCREMENT
	 , DEVICELISTID   BIGINT NOT NULL
	 , ATTRID    BIGINT NOT NULL
	 , VALUE   VARCHAR(100)
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME  TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	 , CONSTRAINT PK_METEREVENT_1 PRIMARY KEY (EVENTID)
	 , CONSTRAINT FK_METEREVENT_1 FOREIGN KEY (DEVICELISTID)
				REFERENCES DEVICELIST (LISTID)
) ;
CREATE UNIQUE INDEX UQ_METEREVENT_1 ON METEREVENT(DEVICELISTID ASC , ATTRID ASC);
CREATE INDEX IX_METEREVENT_1 ON METEREVENT(SYNCSTATUS ASC);

CREATE TABLE METEREVENTINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , EVENTID BIGINT NOT NULL
	 , DEVICELISTID   BIGINT NOT NULL
	 , ATTRID    BIGINT NOT NULL
	 , VALUE   VARCHAR(100)
	 , UPDATETIME  TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	 , CONSTRAINT PK_METEREVENTINFO_1 PRIMARY KEY (REPORTTIME,EVENTID)
);
CREATE INDEX IX_METEREVENTINFO_2 ON METEREVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_METEREVENTINFO_3 ON METEREVENTINFO(SYNCSTATUS ASC);


-- OUTLETPROFILE
CREATE TABLE OUTLETPROFILE (
       PROFILEID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , ATTRTYPE CHAR(1) NOT NULL
     , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_OUTLETPROFILE PRIMARY KEY (PROFILEID)
     , CONSTRAINT FK_OUTLETPROFILE_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_OUTLETPROFILE_1 ON OUTLETPROFILE (DEVICELISTID ASC, ATTRID ASC);
CREATE INDEX IX_OUTLETPROFILE_1 ON OUTLETPROFILE(SYNCSTATUS ASC);

CREATE TABLE OUTLETNUMBERINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE DECIMAL(20,6)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_OUTLETNUMBERINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_OUTLETNUMBERINFO_2 ON OUTLETNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_OUTLETNUMBERINFO_3 ON OUTLETNUMBERINFO (SYNCSTATUS ASC);

CREATE TABLE OUTLETSTRINGINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_OUTLETSTRINGINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_OUTLETSTRINGINFO_2 ON OUTLETSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_OUTLETSTRINGINFO_3 ON OUTLETSTRINGINFO (SYNCSTATUS ASC);

CREATE TABLE OUTLETEVENT (
       EVENTID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_OUTLETEVENT PRIMARY KEY (EVENTID)
     , CONSTRAINT FK_OUTLETEVENT_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_OUTLETEVENT_1 ON OUTLETEVENT (DEVICELISTID ASC, ATTRID ASC);
CREATE INDEX IX_OUTLETEVENT_1 ON OUTLETEVENT (SYNCSTATUS ASC);

CREATE TABLE OUTLETEVENTINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , EVENTID BIGINT NOT NULL
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_OUTLETEVENTINFO PRIMARY KEY (EVENTID, REPORTTIME)
);
CREATE INDEX IX_OUTLETEVENTINFO_2 ON OUTLETEVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_OUTLETEVENTINFO_3 ON OUTLETEVENTINFO (SYNCSTATUS ASC);


CREATE TABLE OUTLETSTATISTICINFO
(
   CREATETIME	TIMESTAMP	NOT NULL
 , UPDATETIME	TIMESTAMP	NOT NULL
 , STATISTICTIME	TIMESTAMP	NOT NULL
 , TIMEZONE	VARCHAR(10)	NOT NULL
 , STATISTICTYPE	SMALLINT	NOT NULL
 , PROFILEID	BIGINT	NOT NULL
 , DEVICELISTID	BIGINT	NOT NULL
 , ATTRID	BIGINT	NOT NULL
 , SUM	NUMERIC(20, 6)	NOT NULL
 , COUNT	BIGINT	NOT NULL
 , MIN	NUMERIC(20, 6)	NOT NULL
 , MAX	NUMERIC(20, 6)	NOT NULL
 , CONSTRAINT PK_OUTLETSTATISTICINFO PRIMARY KEY (STATISTICTIME,TIMEZONE,STATISTICTYPE,PROFILEID)
 );
CREATE INDEX IX_OUTLETSTATISTICINFO_1 ON OUTLETSTATISTICINFO(DEVICELISTID,ATTRID,STATISTICTIME) ;


-- 照明
-- LIGHTPROFILE
CREATE TABLE LIGHTPROFILE (
       PROFILEID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , ATTRTYPE CHAR(1) NOT NULL
     , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_LIGHTPROFILE PRIMARY KEY (PROFILEID)
     , CONSTRAINT FK_LIGHTPROFILE_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_LIGHTPROFILE_1 ON LIGHTPROFILE (DEVICELISTID ASC, ATTRID ASC);
CREATE INDEX IX_LIGHTPROFILE_1 ON LIGHTPROFILE (SYNCSTATUS ASC);

CREATE TABLE LIGHTNUMBERINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE DECIMAL(20,6)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_LIGHTNUMBERINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_LIGHTNUMBERINFO_3 ON LIGHTNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_LIGHTNUMBERINFO_4 ON LIGHTNUMBERINFO (SYNCSTATUS ASC);

CREATE TABLE LIGHTSTRINGINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_LIGHTSTRINGINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_LIGHTSTRINGINFO_3 ON LIGHTSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_LIGHTSTRINGINFO_4 ON LIGHTSTRINGINFO (SYNCSTATUS ASC);

CREATE TABLE LIGHTEVENT (
       EVENTID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_LIGHTEVENT PRIMARY KEY (EVENTID)
     , CONSTRAINT FK_LIGHTEVENT_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_LIGHTEVENT_1 ON LIGHTEVENT (DEVICELISTID ASC, ATTRID ASC);
CREATE INDEX IX_LIGHTEVENT_1 ON LIGHTEVENT (SYNCSTATUS ASC);

CREATE TABLE LIGHTEVENTINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , EVENTID BIGINT NOT NULL
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_LIGHTEVENTINFO PRIMARY KEY (EVENTID, REPORTTIME)
);
CREATE INDEX IX_LIGHTEVENTINFO_3 ON LIGHTEVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;
CREATE INDEX IX_LIGHTEVENTINFO_4 ON LIGHTEVENTINFO (SYNCSTATUS ASC);

CREATE TABLE LIGHTSTATISTICINFO
(
   CREATETIME	TIMESTAMP	NOT NULL
 , UPDATETIME	TIMESTAMP	NOT NULL
 , STATISTICTIME	TIMESTAMP	NOT NULL
 , TIMEZONE	VARCHAR(10)	NOT NULL
 , STATISTICTYPE	SMALLINT	NOT NULL
 , PROFILEID	BIGINT	NOT NULL
 , DEVICELISTID	BIGINT	NOT NULL
 , ATTRID	BIGINT	NOT NULL
 , SUM	NUMERIC(20, 6)	NOT NULL
 , COUNT	BIGINT	NOT NULL
 , MIN	NUMERIC(20, 6)	NOT NULL
 , MAX	NUMERIC(20, 6)	NOT NULL
 , CONSTRAINT PK_LIGHTSTATISTICINFO PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
);
CREATE INDEX IX_LIGHTSTATISTICINFO_1 ON LIGHTSTATISTICINFO(DEVICELISTID,ATTRID,STATISTICTIME) ;

CREATE TABLE TEXTILEPROFILE
(
	 PROFILEID	BIGINT	NOT NULL AUTO_INCREMENT
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT	NOT NULL
	,VALUE	VARCHAR(500)	NULL
	,ATTRTYPE	CHAR(1)	NOT NULL
	,REPORTTIME	TIMESTAMP	NOT NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CONSTRAINT PK_TEXTILEPROFILE PRIMARY KEY (PROFILEID)
	,CONSTRAINT FK_TEXTILEPROFILE_1 FOREIGN KEY (DEVICELISTID)
				REFERENCES DEVICELIST(LISTID)
);
CREATE UNIQUE INDEX UQ_TEXTILEPROFILE_1 ON TEXTILEPROFILE(DEVICELISTID,ATTRID);
CREATE  INDEX IX_TEXTILEPROFILE_2 ON TEXTILEPROFILE(SYNCSTATUS ASC);
CREATE TABLE TEXTILENUMBERINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE DECIMAL(20,6)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_TEXTILENUMBERINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_TEXTILENUMBERINFO_3 ON TEXTILENUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE TEXTILESTRINGINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_TEXTILESTRINGINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_TEXTILESTRINGINFO_3 ON TEXTILESTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE TEXTILEEVENT (
       EVENTID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_TEXTILEEVENT PRIMARY KEY (EVENTID)
     , CONSTRAINT FK_TEXTILEEVENT_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_TEXTILEEVENT_1 ON TEXTILEEVENT (DEVICELISTID, ATTRID);

CREATE TABLE TEXTILEEVENTINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , EVENTID BIGINT NOT NULL
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_TEXTILEEVENTINFO PRIMARY KEY (EVENTID, REPORTTIME)

);

CREATE INDEX IX_TEXTILEEVENTINFO_2 ON TEXTILEEVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE LIGHTSTATISTIC (
       DEVICELISTID BIGINT NOT NULL
	 , STATSTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00' DEFAULT '0000-00-00 00:00:00'
     , STATSTYPE CHAR(1) NOT NULL
	 , STATSATTRID BIGINT NOT NULL
     , VALUE DECIMAL(20,6)
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , CONSTRAINT PK_LIGHTSTATISTIC PRIMARY KEY (DEVICELISTID, STATSTIME, STATSTYPE, STATSATTRID)
);

-- LED
-- LED_LAMPS_INFO
CREATE TABLE NEWS (
 	   NEWSID BIGINT NOT NULL AUTO_INCREMENT
     , NEWSDATE TIMESTAMP
     , TITLE VARCHAR(50)
     , SOURCE VARCHAR(2)
     , URL VARCHAR(200)
     , CONTENT VARCHAR(1000)
     , DATEONLINE TIMESTAMP
	 , DATEOFFLINE TIMESTAMP
	 , HOSTURL VARCHAR(100)
	 , OLDGROUPID VARCHAR(20)
	 , CREATETIME TIMESTAMP
	 , CREATECUSID VARCHAR(64)
	 , EDITTIME TIMESTAMP
	 , EDITCUSID VARCHAR(64)
	 , GROUPID BIGINT
     , CONSTRAINT PK_NEWS PRIMARY KEY (NEWSID)
     , CONSTRAINT FK_NEWS_1 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
);
CREATE INDEX IX_NEWS_1 ON NEWS (GROUPID ASC);


CREATE TABLE ATTACHEDFILE (
 	   ATTACHEDID BIGINT NOT NULL AUTO_INCREMENT
     , NEWSID BIGINT
     , FILENAME VARCHAR(200)
     , FILEPATH VARCHAR(200)
     , FILEUUID VARCHAR(40)
     , FILETYPE VARCHAR(200)
     , FILESIZE VARCHAR(10)
	 , DLTIMES INT
     , CONSTRAINT PK_ATTACHEDFILE PRIMARY KEY (ATTACHEDID)
	 , CONSTRAINT FK_ATTACHEDFILE_1 FOREIGN KEY (NEWSID)
                  REFERENCES NEWS (NEWSID)
);
CREATE INDEX IX_ATTACHEDFILE_1 ON ATTACHEDFILE (NEWSID ASC);

CREATE TABLE LED_PLACE_LIST (
       LPL_ID BIGINT NOT NULL AUTO_INCREMENT
     , LPL_NAME VARCHAR(100)
     , LPL_ADDR VARCHAR(500)
     , LPL_LAT DECIMAL(20,6)
     , LPL_LNG DECIMAL(20,6)
     , LPL_FLOOR VARCHAR(2)
     , LPL_ISGROUP VARCHAR(1)
     , LPL_IMAGEURL VARCHAR(100)
     , LPL_CREATE_TIME TIMESTAMP
     , LPL_UPDATE_TIME TIMESTAMP
     , LPL_PARENT_ID BIGINT
     , CONSTRAINT PK_LED_PLACE_LIST PRIMARY KEY (LPL_ID)
);

CREATE TABLE LED_LAMPS_INFO (
     LAMPID			 BIGINT NOT NULL  AUTO_INCREMENT
    , MANU_CODE           VARCHAR(2)
    , BRAND_NAME          VARCHAR(50)
    , LIFE                INT
    , TYPE                VARCHAR(20)
    , COLOR               VARCHAR(20)
    , LUMINOUS            VARCHAR(20)
    , COLOR_TEMPERATURE   VARCHAR(20)
    , DIMMABLE            VARCHAR(1)
    , INPUT_VOLTAGE_TYPE  VARCHAR(2)
    , INPUT_VOLTAGE_MIN   VARCHAR(3)
    , INPUT_VOLTAGE_MAX   VARCHAR(3)
    , FREQUENCY           VARCHAR(10)
    , POWER               INT
    , POWER_FACTOR        INT
    , OP_TEMPERATURE_TYPE VARCHAR(2)
    , OP_TEMPERATURE_LOW  VARCHAR(10)
    , OP_TEMPERATURE_HIGH VARCHAR(10)
    , PRODUCT_APPROVAL    VARCHAR(50)
    , LIGHT_CHIP          VARCHAR(20)
    , IP_LEVEL            VARCHAR(10)
    , DIMENSIONS          VARCHAR(50)
    , DESCRIPTION         VARCHAR(150)
    , CREATE_TIME         TIMESTAMP
    , UPDATE_TIME         TIMESTAMP
    , FILEID			  BIGINT NULL
    , GROUPID			  BIGINT NULL
    , CONSTRAINT LED_LAMPS_INFO_PK PRIMARY KEY (LAMPID)
    , CONSTRAINT FK_LED_LAMPS_INFO_1 FOREIGN KEY (FILEID)
     REFERENCES ATTACHEDFILE(ATTACHEDID)
    , CONSTRAINT FK_LED_LAMPS_INFO_2 FOREIGN KEY (GROUPID)
      REFERENCES GROUPINFO(GROUPID)
);

CREATE TABLE LED_CTRL_INFO (
       ID BIGINT NOT NULL AUTO_INCREMENT
     , BRAND_NAME VARCHAR(50)
	 , MODEL_NAME VARCHAR(50)
	 , CONTROL_TYPE VARCHAR(4)
	 , LIFETIME INTEGER
	 , FILEID BIGINT
	 , CREATE_TIME TIMESTAMP
	 , UPDATE_TIME TIMESTAMP
     , CONSTRAINT PK_LED_CTRL_INFO PRIMARY KEY (ID)
     , CONSTRAINT FK_LED_CTRL_INFO_1 FOREIGN KEY (FILEID)
                  REFERENCES ATTACHEDFILE (ATTACHEDID)
);
CREATE INDEX IX_LED_CTRL_INFO_1 ON LED_CTRL_INFO (FILEID);

CREATE TABLE LED_DEVICE_LIST (
       LDL_ID VARCHAR(23) NOT NULL
     , LDL_GI_ID VARCHAR(20)
     , LDL_DEVICE_TYPE VARCHAR(2)
     , LDL_DEVICE_SUBTYPE VARCHAR(2)
     , LDL_LPL_ID BIGINT
     , LDL_STATUS VARCHAR(2)
     , LDL_DIMMING VARCHAR(3)
     , LDL_GW_ID VARCHAR(20)
     , LDL_NET_TYPE VARCHAR(2)
     , LDL_NET_STATUS VARCHAR(2)
     , LDL_CREATE_TIME TIMESTAMP
     , LDL_UPDATE_TIME TIMESTAMP
     , LDL_LASTCMD_TYPE VARCHAR(10)
     , LDL_LASTCMD_STATUS VARCHAR(2)
     , LDL_LASTCMD_REQ_TIME TIMESTAMP
     , LDL_LASTCMD_RSP_TIME TIMESTAMP
     , LDL_MANU_CODE VARCHAR(2)
     , LDL_REPORT_TIME TIMESTAMP
     , LDL_ERROR_CODE VARCHAR(8)
     , LDL_ALIAS_ID VARCHAR(20)
     , LDL_ALIAS_NAME VARCHAR(50)
     , LDL_DESC VARCHAR(500)
     , LDL_MODEL_NUMBER VARCHAR(20)
     , ALARMSTATUS VARCHAR(5) DEFAULT '0'
     , SUBID VARCHAR(2) DEFAULT '00' NOT NULL
     , PARENTID VARCHAR(23)
     , SWITCHABLE CHAR(1)
     , DIMMABLE CHAR(1)
     , MODELNAME VARCHAR(32)
     , STATUSCHANGE VARCHAR(2) DEFAULT '0'
     , WARNINGSENDTIMES VARCHAR(2) DEFAULT '0'
     , ERRORSENDTIMES VARCHAR(2) DEFAULT '0'
     , GROUPID BIGINT
     , SSID VARCHAR(23)
     , STANDARD_W DECIMAL(20,6) DEFAULT 0 NOT NULL
     , STANDARD_PF DECIMAL(20,6) DEFAULT 0 NOT NULL
     , STANDARD_V DECIMAL(20,6) DEFAULT 0 NOT NULL
     , LDL_CTRL_MODELID BIGINT
     , LAMP_INSTALL_DATE TIMESTAMP
     , LAMP_MODEL VARCHAR(50)
     , POWERMEASABILITY CHAR(1) DEFAULT '0' NOT NULL
     , SLTYPEID BIGINT
     , LDL_WARNING_CODE VARCHAR(8)
     , LDL_VOLTAGE VARCHAR(3)
     , LDL_POWERSPEC INT
     , GEESTATUS CHAR(2)
     , DEVICELISTID BIGINT
     , GEERULEID BIGINT
     , CONSTRAINT PK_LED_DEVICE_LIST PRIMARY KEY (LDL_ID)
     , CONSTRAINT FK_LED_DEVICE_LIST_1 FOREIGN KEY (LDL_LPL_ID)
                  REFERENCES LED_PLACE_LIST (LPL_ID)
     , CONSTRAINT FK_LED_DEVICE_LIST_2 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
     , CONSTRAINT FK_LED_DEVICE_LIST_4 FOREIGN KEY (SSID)
                  REFERENCES CONTROLLERLIST (DEVICEID)
     , CONSTRAINT FK_LED_DEVICE_LIST_5 FOREIGN KEY (LDL_CTRL_MODELID)
                  REFERENCES LED_CTRL_INFO (ID)
);
CREATE INDEX IX_LED_DEVICE_LIST_1 ON LED_DEVICE_LIST (LDL_LPL_ID ASC);
CREATE INDEX IX_LED_DEVICE_LIST_2 ON LED_DEVICE_LIST (LDL_GW_ID ASC);
CREATE INDEX IX_LED_DEVICE_LIST_3 ON LED_DEVICE_LIST (GROUPID ASC);
CREATE INDEX IX_LED_DEVICE_LIST_4 ON LED_DEVICE_LIST (LDL_CTRL_MODELID ASC);
CREATE INDEX IX_LED_DEVICE_LIST_5 ON LED_DEVICE_LIST (DEVICELISTID ASC);

-- DEVICE_EVENT_LIST
CREATE TABLE DEVICE_EVENT_LIST (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , DEVICEID VARCHAR(20) NOT NULL
     , EVENTCODE VARCHAR(5)
     , ERRORCODE VARCHAR(2)
     , EVENTVALUE VARCHAR(20)
     , CONSTRAINT PK_DEVICE_EVENT_LIST PRIMARY KEY (REPORTTIME, DEVICEID, EVENTCODE)
);
CREATE INDEX IX_DEVICE_EVENT_LIST_1 ON DEVICE_EVENT_LIST (DEVICEID ASC);

-- ----------------------------
-- 配合CS專用設備TABLE END
-- ----------------------------

-- ----------------------------
-- 單機專用 START
-- ----------------------------


-- CONTACTINFO
CREATE TABLE CONTACTINFO (
	   ID BIGINT NOT NULL AUTO_INCREMENT
	 , TARGET VARCHAR(255) DEFAULT NULL
	 , TYPE VARCHAR(255) DEFAULT NULL
	 , CONTACTID BIGINT DEFAULT NULL
	 , CONSTRAINT PK_CONTACTINFO PRIMARY KEY (ID)
	 , CONSTRAINT FK_CONTACTINFO_1 FOREIGN KEY (CONTACTID)
	 			REFERENCES CONTACT (ID)
);

-- FEMS_DEMANDCONTROLLER
CREATE TABLE FEMS_DEMANDCONTROLLER (
		DEVICEID VARCHAR(255) NOT NULL DEFAULT ''
	  , SEQUENCE INT NOT NULL
	  , RESEQUENCE INT NOT NULL
	  , UNLOADTYPE VARCHAR(255) NOT NULL
	  , ENABLE TINYINT(1) NOT NULL
	  , UNLOADBYDEMAND TINYINT(1) UNSIGNED NOT NULL DEFAULT '0'  -- '是否為需量檢查排程關閉，0:不是、1:是。\R\N如果是被排程關閉，則復歸時才復歸此IO。'
	  , DUTY_CYCLE_ACTION_TIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	  , DUTY_CYCLE_UNLOAD BIGINT DEFAULT NULL
	  , DUTY_CYCLE_RESET BIGINT NOT NULL DEFAULT '1'
	  , DUTY_CYCLE_STAGE TINYINT(20) NOT NULL DEFAULT '0'
	  , CONSTRAINT PK_FEMS_DEMANDCONTROLLER PRIMARY KEY (DEVICEID)
);

-- FEMS_EVENT_LIST
CREATE TABLE FEMS_EVENT_LIST (
		ID BIGINT NOT NULL AUTO_INCREMENT
	  , EVENTCODE VARCHAR(50) NOT NULL
	  , EVENTLEVEL CHAR(1) NOT NULL DEFAULT '0'
	  , EVENTSOURCE VARCHAR(255) NOT NULL
	  , SOURCETYPE VARCHAR(20) NOT NULL
	  , TRIGGERTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	  , NOTIFYTIMES INT NOT NULL DEFAULT '0'
	  , LASTNOTIFY TIMESTAMP NULL
	  , CONFIRMED TINYINT(4) NOT NULL DEFAULT '0'
	  , CONFIRMTIME TIMESTAMP NULL
	  , HANDLED TINYINT(4) NOT NULL DEFAULT '0'
	  , HANDLETIME TIMESTAMP NULL
	  , CONSTRAINT PK_FEMS_EVENT_LIST PRIMARY KEY (ID)
);
CREATE INDEX IX_FEMS_EVENT_LIST_1 ON FEMS_EVENT_LIST(TRIGGERTIME) ;
CREATE INDEX IX_FEMS_EVENT_LIST_2 ON FEMS_EVENT_LIST(SOURCETYPE) ;
CREATE INDEX IX_FEMS_EVENT_LIST_3 ON FEMS_EVENT_LIST(EVENTCODE) ;
-- FEMS_EVENT_TYPE
CREATE TABLE FEMS_EVENT_TYPE (
		EVENTCODE VARCHAR(50) NOT NULL
	  , EVENTLEVEL CHAR(1) NOT NULL DEFAULT '0'
	  , EVENTSOURCE VARCHAR(255) NOT NULL
	  , SOURCETYPE VARCHAR(20) NOT NULL
	  , MESSAGE TEXT NOT NULL
	  , RULE TEXT
	  , ENABLED TINYINT(4) NOT NULL DEFAULT '1'
	  , MODULEID VARCHAR(255) DEFAULT NULL
	  , CONSTRAINT PK_FEMS_EVENT_TYPE PRIMARY KEY (EVENTCODE)
);

-- FEMS_METER_SPACE
CREATE TABLE FEMS_METER_SPACE (
		SPACEID BIGINT NOT NULL AUTO_INCREMENT
	  , SPACENAME VARCHAR(255) DEFAULT NULL
	  , SPACEMAP VARCHAR(255) DEFAULT NULL
	  , UPDATETIME TIMESTAMP NULL
	  , PARENTSPACE BIGINT DEFAULT NULL
	  , CONSTRAINT PK_FEMS_METER_SPACE PRIMARY KEY (SPACEID)
	  , CONSTRAINT FK_FEMS_METER_SPACE_1 FOREIGN KEY (PARENTSPACE)
	  			REFERENCES FEMS_METER_SPACE (SPACEID)
);

-- FEMS_METER_PLACEMENT
CREATE TABLE FEMS_METER_PLACEMENT (
		PLACEMENTID BIGINT NOT NULL AUTO_INCREMENT
	  , POSX INT DEFAULT NULL
	  , POSY INT DEFAULT NULL
	  , METERID BIGINT DEFAULT NULL
	  , SPACEID BIGINT DEFAULT NULL
	  , DEVICEID VARCHAR(25) NOT NULL
	  , CONSTRAINT PK_FEMS_METER_PLACEMENT PRIMARY KEY (PLACEMENTID)
	  , CONSTRAINT FK_FEMS_METER_PLACEMENT_1 FOREIGN KEY (METERID)
	  			REFERENCES METERPROFILE (METERID)
	  , CONSTRAINT FK_FEMS_METER_PLACEMENT_2 FOREIGN KEY (SPACEID)
	  			REFERENCES FEMS_METER_SPACE (SPACEID)
);

-- ----------------------------
-- 單機專用 END
-- ----------------------------


-- ----------------------------
-- AP應用 START
-- ----------------------------
-- AREAINFO
-- CLUSTERINFO
CREATE TABLE CLUSTERINFO (
       CLUSTERID BIGINT NOT NULL AUTO_INCREMENT
     , NAME VARCHAR(64) NOT NULL
     , BGCOLOR VARCHAR(7)
     , AREAID BIGINT NOT NULL
     , TYPE VARCHAR(20)
     , CONSTRAINT PK_CLUSTERINFO PRIMARY KEY (CLUSTERID)
     , CONSTRAINT FK_CLUSTERINFO_1 FOREIGN KEY (AREAID)
                  REFERENCES AREAINFO (AREAID)
);
CREATE INDEX IX_CLUSTERINFO_1 ON CLUSTERINFO (AREAID ASC);

-- DEVICELISTEXT
CREATE TABLE DEVICELISTEXT (
       LISTID BIGINT NOT NULL
     , DEVICENAME VARCHAR(200)
     , GROUPID BIGINT
     , CUSTOMERID VARCHAR(64)
     , AREAID BIGINT
     , CLUSTERID BIGINT
     , AREABLOCKID BIGINT
     , POSX DECIMAL(20,6)
     , POSY DECIMAL(20,6)
     , USERID BIGINT NULL
     , RULEID BIGINT NULL
     , SYNCSTATUS VARCHAR(1) DEFAULT '0'  NOT NULL
	 , TARGETID VARCHAR(36) NULL
	 , ATTRDISPLAY BIGINT NULL
	 , ICONDISPLAY BIGINT DEFAULT '1'  NULL
	 , ICONNAME VARCHAR(64)
	 , ISGROUPSTATISTICS CHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_DEVICELISTEXT PRIMARY KEY (LISTID)
     , CONSTRAINT FK_DEVICELISTEXT_2 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
     , CONSTRAINT FK_DEVICELISTEXT_4 FOREIGN KEY (AREAID)
                  REFERENCES AREAINFO (AREAID)
     , CONSTRAINT FK_DEVICELISTEXT_5 FOREIGN KEY (CLUSTERID)
                  REFERENCES CLUSTERINFO (CLUSTERID)
     , CONSTRAINT FK_DEVICELISTEXT_6 FOREIGN KEY (AREABLOCKID)
                  REFERENCES AREAINFO (AREAID)
	 , CONSTRAINT FK_DEVICELISTEXT_8 FOREIGN KEY (USERID)
     			  REFERENCES USERINFO(ID)
);
CREATE INDEX IX_DEVICELISTEXT_1 ON DEVICELISTEXT (GROUPID ASC);
CREATE INDEX IX_DEVICELISTEXT_2 ON DEVICELISTEXT (CUSTOMERID ASC);
CREATE INDEX IX_DEVICELISTEXT_3 ON DEVICELISTEXT (AREAID ASC);

-- SCENARIOINFO
CREATE TABLE SCENARIOINFO
(
 SCENARIOID	BIGINT	NOT NULL AUTO_INCREMENT
,NAME	VARCHAR(20)	NOT NULL
,AREAID	BIGINT	NOT NULL
,CREATETIME	TIMESTAMP	NOT NULL
,UPDATETIME	TIMESTAMP	NULL
,CLUSTERIDLIST VARCHAR(255)  NULL
,DEVICECATEGORY VARCHAR(50)
,CONSTRAINT PK_SCENARIOINFO PRIMARY KEY (SCENARIOID)
,CONSTRAINT FK_SCENARIOINFO_1 FOREIGN KEY (AREAID)
			REFERENCES AREAINFO(AREAID)
);

CREATE TABLE SCENARIODEVICE (
	SCENARIOID	BIGINT	NOT NULL
	,DEVICELISTID	BIGINT	NOT NULL
	,DEVICETYPE	VARCHAR(5)	NOT NULL
	,ATTRID	BIGINT	NOT NULL
	,VALUE	VARCHAR(20)	NOT NULL
	,CONSTRAINT PK_SCENARIODEVICE PRIMARY KEY (SCENARIOID,DEVICELISTID)
	,CONSTRAINT FK_SCENARIODEVICE_1 FOREIGN KEY (SCENARIOID)
				REFERENCES SCENARIOINFO(SCENARIOID)
);

-- AUTOMATIONCONFIG
CREATE TABLE AUTOMATIONCONFIG (
	 ID  	BIGINT	NOT NULL AUTO_INCREMENT
	,AREAID  BIGINT  NULL
	,ATTYPE  VARCHAR(2)  NOT NULL
	,CONFIG  VARCHAR(500)  NOT NULL
	,ONOFF  VARCHAR(1)  DEFAULT '0' NOT NULL
	,NAME  VARCHAR(20)  NULL
	,CREATETIME TIMESTAMP NULL
	,UPDATETIME TIMESTAMP NULL
	,CONSTRAINT PK_AUTOMATIONCONFIG PRIMARY KEY (ID)
	,CONSTRAINT FK_AUTOMATIONCONFIG_1 FOREIGN KEY (AREAID)
		   REFERENCES AREAINFO(AREAID)
);

CREATE TABLE AUTOMATIONRULE (
	 AUTOMATIONID	BIGINT	NOT NULL
	,GEERULEID	BIGINT	NOT NULL
	,DEVICELISTID	BIGINT	NOT NULL
	,CONSTRAINT PK_AUTOMATIONRULE PRIMARY KEY (AUTOMATIONID,GEERULEID,DEVICELISTID)
	,CONSTRAINT FK_AUTOMATIONRULE_1 FOREIGN KEY (AUTOMATIONID)
				REFERENCES AUTOMATIONCONFIG(ID)
);


--
-- NEWMETERSTATISTICS
CREATE TABLE NEWMETERSTATISTICS(
       METERID BIGINT NOT NULL
     , STATSTIME TIMESTAMP NOT NULL  DEFAULT '0000-00-00 00:00:00'
     , STATSTYPE CHAR(1) NOT NULL
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , TOTALENERGY DECIMAL(15,4) DEFAULT 0
     , MAXPOWER DECIMAL(20,6) DEFAULT 0
     , AVGPOWER DECIMAL(15,4) DEFAULT 0
     , DEMAND DECIMAL(20,6) DEFAULT 0
     , MAXDEMANDTIME TIMESTAMP
     , POWERRATE DECIMAL(15,4) DEFAULT 0
     , CO2 DECIMAL(15,4) DEFAULT 0
     , MINKWH DECIMAL(20,6) DEFAULT 0
     , MAXKWH DECIMAL(20,6) DEFAULT 0
     , RECCOUNT INT
     , TYPE CHAR(2)
     , ISSYNC VARCHAR(1)
     , MAUNAL CHAR(2)
     , TOUTYPE TINYINT NOT NULL DEFAULT 0
     , SYNCSTATUS VARCHAR(1) DEFAULT '0'  NOT NULL
     , PRICEID NUMERIC(20,6) NULL
	   , MINKVARH DECIMAL(20,6)
	   , MAXKVARH DECIMAL(20,6)
	   , TOTALKVARH DECIMAL(20,6)
	   , FINE decimal(20,6) NULL
     , CONSTRAINT PK_NEWMETERSTATISTICS PRIMARY KEY (METERID, STATSTIME, STATSTYPE,TOUTYPE)
);
CREATE INDEX IX_NEWMETERSTATISTICS_1 ON NEWMETERSTATISTICS (STATSTIME ASC, STATSTYPE,TOUTYPE ASC);
CREATE INDEX IX_NEWMETERSTATISTICS_2 ON NEWMETERSTATISTICS (TYPE ASC);
CREATE INDEX IX_NEWMETERSTATISTICS_3 ON NEWMETERSTATISTICS(SYNCSTATUS,STATSTIME);

-- METERMAP
CREATE TABLE METERMAP (
       MAPNAME VARCHAR(30) NOT NULL
     , ICONNAME VARCHAR(20) NOT NULL
     , METERID BIGINT NOT NULL
     , POSX INT DEFAULT 0
     , POSY INT DEFAULT 0
     , CONSTRAINT PK_METERMAP PRIMARY KEY (MAPNAME, ICONNAME, METERID)
);
CREATE INDEX IX_METERMAP_1 ON METERMAP (METERID ASC);


-- 新電價 ELECTPRIC
CREATE TABLE DISTRICTLIST(
	   DISTRICTID INT NOT NULL
	 , DISTRICTNAME VARCHAR(64) NOT NULL
	 , PARENTDISTRICT INT
	 , CONSTRAINT PK_DISTRICTLIST PRIMARY KEY (DISTRICTID)
);

CREATE TABLE ELECTPRICEMODEL(
	   PRICEMODELID BIGINT NOT NULL AUTO_INCREMENT
	 , PRICEMODELNAME VARCHAR(64) NOT NULL
	 , ISTOU CHAR(1) NOT NULL
	 , CURRENCY VARCHAR(3) NOT NULL
	 , DISTRICTID INT NOT NULL
	 , CONSTRAINT PK_ELECTPRICEMODEL PRIMARY KEY (PRICEMODELID)
	 , CONSTRAINT FK_ELECTPRICEMODEL_1 FOREIGN KEY (DISTRICTID)
					REFERENCES DISTRICTLIST (DISTRICTID)
);

CREATE TABLE ELECTPRICEPROFILE(
PRICEID BIGINT NOT NULL AUTO_INCREMENT
,IMPLEMENTDATE TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
,PRICEMODELID  BIGINT  NOT NULL
,CONSTRAINT PK_ELECTPRICEPROFILE PRIMARY KEY (PRICEID)
, CONSTRAINT FK_ELECTPRICEPROFILE_1 FOREIGN KEY (PRICEMODELID)
                  REFERENCES ELECTPRICEMODEL (PRICEMODELID)
);

CREATE TABLE ELECTPRICEFIXED(
	FIXEDID BIGINT NOT NULL AUTO_INCREMENT
	,FIXEDTYPE BIGINT
	,FIXEDTYPENAME VARCHAR(30)
	,SUBTYPE BIGINT
	,SUBTYPENAME VARCHAR(30)
	,PRICE DECIMAL(20,6) DEFAULT '0' NOT NULL
	,SEASONTYPE TINYINT DEFAULT '1'  NOT NULL
	,MONTHLIST VARCHAR(50)
	,PRICEID BIGINT NOT NULL
	,CONSTRAINT PK_ELECTPRICEFIXED PRIMARY KEY (FIXEDID)
	,CONSTRAINT FK_ELECTPRICEFIXED_1 FOREIGN KEY (PRICEID)
			 REFERENCES ELECTPRICEPROFILE (PRICEID)
);

CREATE TABLE ELECTPRICETOU(
	TOUID BIGINT NOT NULL AUTO_INCREMENT
	,STARTDAY VARCHAR(4)
	,ENDDAY VARCHAR(4)
	,STARTTIME VARCHAR(4)
	,ENDTIME VARCHAR(4)
	,TOUTYPE BIGINT
	,TOUTYPENAME VARCHAR(30)
	,SUBTYPE BIGINT
	,SUBTYPENAME VARCHAR(30)
	,PRICE DECIMAL(20,6) DEFAULT '0' NOT NULL
	,SEASONTYPE TINYINT DEFAULT '1'  NOT NULL
	,MONTHLIST VARCHAR(50)
	,PRICEID BIGINT NOT NULL
	,CONSTRAINT PK_ELECTPRICETOU PRIMARY KEY (TOUID)
	,CONSTRAINT FK_ELECTPRICETOU_1 FOREIGN KEY (PRICEID)
			 REFERENCES ELECTPRICEPROFILE (PRICEID)
 );

CREATE TABLE ELECTPRICEDEGREE(
	DEGREEID BIGINT NOT NULL AUTO_INCREMENT
	,DEGREETYPE BIGINT
	,DEGREETYPENAME VARCHAR(30)
	,PRICE DECIMAL(20,6) DEFAULT '0' NOT NULL
	,PRICEID BIGINT NOT NULL
	,CONSTRAINT PK_ELECTPRICEDEGREE PRIMARY KEY (DEGREEID)
	,CONSTRAINT FK_ELECTPRICEDEGREE_1 FOREIGN KEY (PRICEID)
			 REFERENCES ELECTPRICEPROFILE (PRICEID)
);

CREATE TABLE ELECTPRICEPROGRESSIVE(
	PRGID BIGINT NOT NULL AUTO_INCREMENT
	,RANGESTART DECIMAL(20,6) NOT NULL
	,RANGEEND  DECIMAL(20,6) NOT NULL
	,PRICE DECIMAL(20,6) DEFAULT '0' NOT NULL
	,SEASONTYPE TINYINT DEFAULT '1' NOT NULL
	,MONTHLIST VARCHAR(50)
	,PRICEID BIGINT NOT NULL
	,CONSTRAINT PK_ELECTPRICEPROGRESSIVE PRIMARY KEY (PRGID)
	,CONSTRAINT FK_ELECTPRICEPROGRESSIVE_1 FOREIGN KEY (PRICEID)
			 REFERENCES ELECTPRICEPROFILE (PRICEID)
);

-- DEMANDCONFIG
CREATE TABLE DEMANDCONFIG (
       DMDCID BIGINT  NULL
     , CIRCUITID BIGINT
     , DEMAINCONTRACT DECIMAL(20,6)
     , DEMANDTARGET DECIMAL(20,6)
     , DEMANDMOD CHAR(1) DEFAULT '0'
     , DEMANDINTERVAL DECIMAL(20,6)
     , DEMANDSUBINTERVAL DECIMAL(20,6)
     , DEMANDALARM DECIMAL(20,6)
     , DEMANDSHUTDOWN DECIMAL(20,6)
     , REGULARCONTRACT DECIMAL(20,6) DEFAULT NULL
     , SEMIPEAKCONTRACT DECIMAL(20,6) DEFAULT NULL
     , NONSUMMERCONTRACT DECIMAL(20,6) DEFAULT NULL
     , SATSEMIPEAKCONTRACT DECIMAL(20,6) DEFAULT NULL
     , OFFPEAKCONTRACT DECIMAL(20,6) DEFAULT NULL
     , DISCOUNT DECIMAL(20,6)
     , PRICEID BIGINT
     , FIXEDTYPE BIGINT
     , DEGREETYPE BIGINT
     , PRICECUSTOMIZED DECIMAL(20,6)
     , PRICEENBALEDATE TIMESTAMP
     , SYNCSTATUS VARCHAR(1) DEFAULT '0'  NOT NULL
     , DEVICEID VARCHAR(25) NOT NULL
     , CONSTRAINT PK_DEMANDCONFIG PRIMARY KEY (DEVICEID)
     , CONSTRAINT FK_DEMANDCONFIG_2 FOREIGN KEY (PRICEID)
                                    REFERENCES ELECTPRICEPROFILE (PRICEID)
);

-- 單線圖
-- LINEDIAGLIST
CREATE TABLE LINEDIAGLIST (
       LINEDIAGID BIGINT NOT NULL AUTO_INCREMENT
     , LINEDIAGNAME VARCHAR(100)
     , GROUPID BIGINT
     , SYNCSTATUS VARCHAR(1) DEFAULT '0'  NOT NULL
     , CONSTRAINT PK_LINEDIAGLIST PRIMARY KEY (LINEDIAGID)
     , CONSTRAINT FK_LINEDIAGLIST_1 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
);

CREATE TABLE LINEOBJLIST (
       LINEOBJID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICEID VARCHAR(25) NOT NULL
     , PARENTLINEOBJ BIGINT
     , LINEDIAGID BIGINT
     , DEVICETYPE VARCHAR(5)
     , SYNCSTATUS VARCHAR(1) DEFAULT '0'  NOT NULL
     , DEVICEID2 VARCHAR(25) NULL
     , CONSTRAINT PK_LINEOBJLIST PRIMARY KEY (LINEOBJID)
     , CONSTRAINT FK_LINEOBJLIST_1 FOREIGN KEY (PARENTLINEOBJ)
                  REFERENCES LINEOBJLIST (LINEOBJID)
     , CONSTRAINT FK_LINEOBJLIST_2 FOREIGN KEY (LINEDIAGID)
                  REFERENCES LINEDIAGLIST (LINEDIAGID)
);

-- 排程
-- HOLIDAYSETTING
CREATE TABLE HOLIDAYSETTING (
	   HOLID BIGINT NOT NULL AUTO_INCREMENT
	 , HOLNAME VARCHAR(255) NOT NULL
	 , ISSTAT   CHAR(1) NULL DEFAULT '0'
	 , ISSCHEDULE CHAR(1) NULL DEFAULT '0'
	 , CONSTRAINT PK_HOLIDAYSETTING_1 PRIMARY KEY (HOLID)
);

CREATE TABLE HOLIDAYSETTINGDAYS(
	   HOLID BIGINT NOT NULL
	 , YEAR SMALLINT NOT NULL
	 , STARTDATE TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , DAYNUMBER SMALLINT NOT NULL DEFAULT 1
	 , ENDDATE TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , CONSTRAINT PK_HOLIDAYSETTINGDAYS_1 PRIMARY KEY (HOLID,YEAR)
	 , CONSTRAINT FK_HOLIDAYSETTINGDAYS_1 FOREIGN KEY (HOLID)
                  REFERENCES HOLIDAYSETTING (HOLID)
);

CREATE TABLE HOLIDAYSETTINGONGATEWAY(
	   DEVICELISTID BIGINT NOT NULL
	 , YEAR SMALLINT NOT NULL
	 , STATUS VARCHAR(20) NOT NULL
	 , CONSTRAINT PK_HOLIDAYSETTINGONGATEWAY_1 PRIMARY KEY (DEVICELISTID,YEAR)
	 , CONSTRAINT FK_HOLIDAYSETTINGONGATEWAY_1 FOREIGN KEY (`DEVICELISTID`)
		REFERENCES `DEVICELIST` (`LISTID`)
);

-- SCHEDULECONFIG
CREATE TABLE SCHEDULECONFIG (
	   SCHEDULEID	BIGINT  NOT NULL  AUTO_INCREMENT
	 , CREATETIME 	TIMESTAMP 	NULL
	 , UPDATETIME	TIMESTAMP	NULL
	 , CREATEUSER	VARCHAR(64)	NULL
	 , UPDATEUSER	VARCHAR(64) NULL
	 , SCHEDULENAME	VARCHAR(100) NULL
	 , DEVICETYPE	VARCHAR(5)	NOT NULL
	 , CRONEXPRESSION	VARCHAR(100)	NULL
	 , PATTERN 	CHAR(1)	NOT NULL
	 , ACTION 	VARCHAR(256)	NULL
	 , STARTDATE	TIMESTAMP	NOT NULL
	 , ENDDATE	TIMESTAMP	NULL
	 , STATUS		CHAR(1)	NOT NULL DEFAULT '1'
	 , AREAID BIGINT  NULL
	 , SCHEDULETYPE VARCHAR(1) NULL
	 , SETTINGIDS  VARCHAR(256) NULL
	 , CONSTRAINT PK_SCHEDULECONFIG_1 PRIMARY KEY (SCHEDULEID)
);

CREATE TABLE SCHEDULECONFIGDEVICE (
	   SCHEDULEID	BIGINT	NOT NULL
	 , DEVICEID	BIGINT	NOT NULL
	 , C22CMDRESULT	VARCHAR(20)	NULL
	 , DIMMING BIGINT  NULL
	 , CONSTRAINT PK_SCHEDULECONFIGDEVICE_1 PRIMARY KEY (SCHEDULEID,DEVICEID)
	 , CONSTRAINT FK_SCHEDULECONFIGDEVICE_1 FOREIGN KEY (SCHEDULEID)
                  REFERENCES SCHEDULECONFIG (SCHEDULEID)
	 , CONSTRAINT FK_SCHEDULECONFIGDEVICE_2 FOREIGN KEY (DEVICEID)
                  REFERENCES DEVICELIST (LISTID)
);

CREATE TABLE SCHEDULECONFIGHOLIDAYSEXCEPTION (
	   SCHEDULEID BIGINT NOT NULL
	 , HOLID BIGINT 	NOT NULL
	 , CONSTRAINT PK_SCHEDULECONFIGHOLIDAYSEXCEPTION_1 PRIMARY KEY (SCHEDULEID,HOLID)
	 , CONSTRAINT FK_SCHEDULECONFIGHOLIDAYSEXCEPTION_1 FOREIGN KEY (SCHEDULEID)
                  REFERENCES SCHEDULECONFIG (SCHEDULEID)
	 , CONSTRAINT FK_SCHEDULECONFIGHOLIDAYSEXCEPTION_2 FOREIGN KEY (HOLID)
                  REFERENCES HOLIDAYSETTING (HOLID)
);

--
CREATE TABLE COMPANYLIST (
       COMPANYID BIGINT NOT NULL AUTO_INCREMENT
     , COMPANYNAME VARCHAR(200)
	 , COMUID VARCHAR(10)
	 , COMPANYTYPE VARCHAR(10)
	 , PHONE VARCHAR(19)
	 , FAX VARCHAR(15)
     , CONSTRAINT PK_COMPANYLIST PRIMARY KEY (COMPANYID)
);

CREATE TABLE COMPANYCONTACT (
       CONTACTID BIGINT NOT NULL AUTO_INCREMENT
     , COMPANYID BIGINT
	 , CONTACTNAME VARCHAR(100)
	 , CELLPHONE VARCHAR(14)
	 , EMAIL VARCHAR(50)
     , CONSTRAINT PK_COMPANYCONTACT PRIMARY KEY (CONTACTID)
     , CONSTRAINT FK_COMPANYCONTACT_1 FOREIGN KEY (COMPANYID)
                  REFERENCES COMPANYLIST (COMPANYID)
);

CREATE TABLE REPAIRLIST (
       ID BIGINT NOT NULL AUTO_INCREMENT
     , REPAIRID VARCHAR(14)
	 , EVENTTIME TIMESTAMP NULL
	 , REPORTTIME TIMESTAMP NULL
	 , REPAIRTIME TIMESTAMP NULL
	 , DEVICETYPE VARCHAR(20)
	 , DEVICEID VARCHAR(50)
	 , EVENTTYPEID VARCHAR(20)
	 , EVENTCONTENT VARCHAR(500)
	 , EVENTSTATUS VARCHAR(20)
	 , COMPANYID BIGINT
	 , CUSTOMERID VARCHAR(60)
	 , SRCEVENTID VARCHAR(60)
	 , NOTIFYSTATUS VARCHAR(60)
	 , REPAIRRESULT VARCHAR(500)
	 , OLDGROUPID VARCHAR(20)
	 , DEVICENAME VARCHAR(150)
	 , GROUPID BIGINT
	 , DEVICELISTID BIGINT
	 , DISABLE CHAR(1) DEFAULT '0'
     , CONSTRAINT PK_REPAIRLIST PRIMARY KEY (ID)
     , CONSTRAINT FK_REPAIRLIST_1 FOREIGN KEY (COMPANYID)
                  REFERENCES COMPANYLIST (COMPANYID)
     , CONSTRAINT FK_REPAIRLIST_2 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO (GROUPID)
);
CREATE INDEX IX_REPAIRLIST_1 ON REPAIRLIST (COMPANYID);
CREATE INDEX IX_REPAIRLIST_2 ON REPAIRLIST (GROUPID);
CREATE INDEX IX_REPAIRLIST_3 ON REPAIRLIST (DEVICELISTID);

CREATE TABLE YARNINFO (
  REPORTTIME  TIMESTAMP  NOT NULL
  ,DEVICEID  VARCHAR(25)  NOT NULL
  ,ORDERNO  VARCHAR(50)  NULL
  ,BEAMNO  VARCHAR(50)  NULL
  ,REEDPOS  BIGINT  NULL
  ,INDNO  BIGINT   NULL
  ,ZONETHREAD  VARCHAR(20)  NOT NULL
  ,SHORTTMAVG  DECIMAL(20,6)  NULL
  ,LONGTMAVG  DECIMAL(20,6)  NULL
  ,LONGTMMIN  DECIMAL(20,6)  NULL
  ,LONGTMMAX  DECIMAL(20,6)  NULL
  ,UPDATETIME  TIMESTAMP  NOT NULL
  , CONSTRAINT PK_YARNINFO PRIMARY KEY (REPORTTIME,DEVICEID,ZONETHREAD )
) ;
CREATE INDEX IX_YARNINFO_1 ON YARNINFO(DEVICEID,REPORTTIME,INDNO) ;

CREATE TABLE YARNPROFILE
(
   DEVICEID VARCHAR(25)  NOT NULL
  ,ORDERNO  VARCHAR(50)  NULL
  ,BEAMNO VARCHAR(50)  NULL
  ,REEDPOS  BIGINT  NULL
  ,INDNO  BIGINT  NULL
  ,ZONETHREAD VARCHAR(20)  NOT NULL
  ,SHORTTMAVG  DECIMAL(20,6)  NULL
  ,LONGTMAVG   DECIMAL(20,6)  NULL
  ,LONGTMMIN   DECIMAL(20,6)  NULL
  ,LONGTMMAX   DECIMAL(20,6)  NULL
  ,REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,CONSTRAINT PK_YARNPROFILE PRIMARY KEY (DEVICEID,ZONETHREAD)
);

CREATE TABLE WSS_ACCESS_TOKEN(
	 TOKEN_ID	VARCHAR (255)	NOT NULL
	,USER_NAME	VARCHAR (255)	NULL
	,EXPIRED_TIME	TIMESTAMP	NULL
	,CONSTRAINT PK_WSS_ACCESS_TOKEN PRIMARY KEY (TOKEN_ID)
);
CREATE UNIQUE INDEX UQ_WSS_ACCESS_TOKEN_1 ON WSS_ACCESS_TOKEN (USER_NAME);



-- ----------------------------
-- AP應用 END
-- ----------------------------

-- 未來單機會用到
-- DEVICELINK
CREATE TABLE DEVICELINK (
	MASTERID	VARCHAR(30)	NOT NULL
	,MASTERTYPE	VARCHAR(5)	NOT NULL
	,SLAVEID	VARCHAR(30)	NOT NULL
	,SLAVETYPE	VARCHAR(5)	NOT NULL
	,LINKINFO	VARCHAR(100)	NULL
	,CONSTRAINT PK_DEVICELINK PRIMARY KEY (MASTERID,SLAVEID)
);


-- GEE

CREATE TABLE GEE_AP
(
	 APID	BIGINT NOT NULL AUTO_INCREMENT
	,APNAME	VARCHAR(100)	NOT NULL
	,APINFO	VARCHAR(100)	NOT NULL
	,CONSTRAINT PK_GEE_AP PRIMARY KEY (APID)
);


CREATE TABLE GEE_RULE
(
	 RULEID	BIGINT NOT NULL AUTO_INCREMENT
	,APRULEID BIGINT NULL
	,APPLICATION	BIGINT	NOT NULL
	,CREATETIME	TIMESTAMP	NOT NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,RULETYPE	CHAR(1)	DEFAULT '0'	NOT NULL
	,INTV	BIGINT	NULL
	,ENABLED	CHAR(1)	DEFAULT '0' NOT NULL
	,RULEINFO	VARCHAR(50)	NULL
	,CRON_EXPRESSION VARCHAR(64) NULL
	,CONSTRAINT PK_GEE_RULE PRIMARY KEY (RULEID)
	,CONSTRAINT FK_GEE_RULE_1 FOREIGN KEY (APPLICATION)
				REFERENCES GEE_AP (APID)
);


CREATE TABLE GEE_RULE_CONDITION
(
	 CONDITIONID	BIGINT NOT NULL AUTO_INCREMENT
	,RULEID	BIGINT	NOT NULL
	,DEVICETYPE	VARCHAR(10)	NOT NULL
	,LVARTYPE	CHAR(1)	NOT NULL
	,RVARTYPE	CHAR(1)	NOT NULL
	,LEFTVAR	NUMERIC(20, 2)	NULL
	,RIGHTVAR	NUMERIC(20, 2)	NULL
	,LEFTWEIGHT	NUMERIC(20, 2)	DEFAULT 1 NOT NULL
	,RIGHTWEIGHT	NUMERIC(20, 2)	DEFAULT 1 NOT NULL
	,OPERATOR	VARCHAR(3)	NOT NULL
	,LASTINGTIME SMALLINT NULL
	,LEFTSHIFT NUMERIC(20, 2)	DEFAULT 0 NOT NULL
	,RIGHTSHIFT NUMERIC(20, 2)	DEFAULT 0 NOT NULL
	,CONDITIONTYPE CHAR(1) DEFAULT '0' NOT NULL
	,TYPE2TIMEZONE VARCHAR(10) NULL
	,CONSTRAINT PK_GEE_RULE_CONDITION PRIMARY KEY (CONDITIONID)
	,CONSTRAINT FK_GEE_RULE_CONDITION_1 FOREIGN KEY (RULEID)
				REFERENCES GEE_RULE (RULEID)
);


CREATE TABLE GEE_RULE_CONFLICT
(
	 CONFLICTID	BIGINT NOT NULL AUTO_INCREMENT
	,APPLICATION	BIGINT	NOT NULL
	,INFO	VARCHAR(50)	NOT NULL
	,ERRORCODE	VARCHAR(10)	NOT NULL
	,CONSTRAINT PK_GEE_RULE_CONFLICT PRIMARY KEY (CONFLICTID)
);


CREATE TABLE GEE_RULE_ACTION
(
	 ACTIONID	BIGINT NOT NULL AUTO_INCREMENT
	,RULEID	BIGINT	NOT NULL
	,ACTIONINFO	VARCHAR(50)	NOT NULL
	,ACTIONCODE	INT	NULL
	,ACTIONVALUE	INT	NULL
	,ACTIONTYPE	CHAR(1)	NOT NULL
	,FUNCTIONVALUE VARCHAR(255) NULL
	,TARGET	INT	NULL
	,TARGETTYPE	CHAR(1)	DEFAULT '0' NULL
	,ALARMTYPE	CHAR(1)	NULL
	,ALARMINTERVAL	INT	NULL
	,ALARMTIMES	INT	NULL
	,FILTERTYPE CHAR(1) NULL
	,FILTERINTERVAL INT NULL
	,CONFLICTID	BIGINT	NULL
	,CALLBACKAP BIGINT  NULL
	,CONSTRAINT PK_GEE_RULE_ACTION PRIMARY KEY (ACTIONID)
	,CONSTRAINT FK_GEE_RULE_ACTION_1 FOREIGN KEY (RULEID)
				REFERENCES GEE_RULE (RULEID)
	,CONSTRAINT FK_GEE_RULE_ACTION_2 FOREIGN KEY (CONFLICTID)
				REFERENCES GEE_RULE_CONFLICT (CONFLICTID)
);


CREATE TABLE GEE_DBTABLE
(
	 TABLEID	BIGINT NOT NULL AUTO_INCREMENT
	,LISTID	BIGINT	NULL
	,DBTABLE	VARCHAR(100)	NOT NULL
	,DEVICEATTR	VARCHAR(50)	NOT NULL
	,DEVICEID	VARCHAR(50)	NOT NULL
	,ATTRIBUTEID	VARCHAR(70)	NULL
	,CONSTRAINT PK_GEE_DBTABLE PRIMARY KEY (TABLEID)
);

CREATE TABLE GEE_RULE_TARGET
(
	 TARGETID	BIGINT NOT NULL AUTO_INCREMENT
	,RULEID	BIGINT	NULL
	,DBTABLE	BIGINT	NOT NULL
	,VALUE	VARCHAR(50)	NOT NULL
	,CONSTRAINT PK_GEE_RULE_TARGET PRIMARY KEY (TARGETID)
	,CONSTRAINT FK_GEE_RULE_TARGET_1 FOREIGN KEY (RULEID)
				REFERENCES GEE_RULE (RULEID)
	,CONSTRAINT FK_GEE_RULE_TARGET_2 FOREIGN KEY (DBTABLE)
				REFERENCES GEE_DBTABLE (TABLEID)
);


CREATE TABLE GEE_EVENT
(
  	 EVENTID	BIGINT NOT NULL AUTO_INCREMENT
	,RULEID	BIGINT	NOT NULL
	,EVENTINFO	VARCHAR(100)	NOT NULL
	,REPORTTIME	VARCHAR(50)	NOT NULL
	,ERRORCODE	BIGINT	NOT NULL
	,REPAIRSTATE	CHAR(1)	NOT NULL
	,CONSTRAINT PK_GEE_EVENT PRIMARY KEY (EVENTID)
	,CONSTRAINT FK_GEE_EVENT_1 FOREIGN KEY (RULEID)
				REFERENCES GEE_RULE (RULEID)
);


CREATE TABLE GEE_INFOLOG
(
INFOLOGID  BIGINT NOT NULL AUTO_INCREMENT
,DEVICEID  VARCHAR(25)  NOT NULL
,LOADID  VARCHAR(2)  NOT NULL
,REPORTTIME  TIMESTAMP  NOT NULL
,STATUS		SMALLINT DEFAULT 0 NOT NULL
,MAIN_DEVICEID  VARCHAR(20) DEFAULT ' ' NOT NULL
,CREATETIME TIMESTAMP   NOT NULL
,DEVICETYPE 	VARCHAR(5)	NULL
,CONSTRAINT PK_GEE_INFOLOG PRIMARY KEY (INFOLOGID,REPORTTIME)
);
CREATE UNIQUE INDEX UQ_GEE_INFOLOG_1 ON GEE_INFOLOG(DEVICEID,REPORTTIME) ;
CREATE INDEX IX_GEE_INFOLOG_1 ON GEE_INFOLOG(CREATETIME,REPORTTIME);

CREATE TABLE GEE_HARDCODEDRULE
(
   RULEID  INT  NOT NULL AUTO_INCREMENT
 , DRLNAME  VARCHAR(20)  NOT NULL
 , DESCRIPTION  VARCHAR(30)  NOT NULL
 , CONSTRAINT PK_GEE_HARDCODEDRULE PRIMARY KEY(RULEID)
);

CREATE TABLE GEE_HARDCODEDDEVICE
(
  RULEID  INT  NOT NULL
, EQUIPMENTID  BIGINT  NOT NULL
, EQUIPMENTTYPE  CHAR(1)  NOT NULL
, CONSTRAINT PK_GEE_HARDCODEDDEVICE PRIMARY KEY(RULEID,EQUIPMENTID)
, CONSTRAINT FK_GEE_HARDCODEDDEVICE_1 FOREIGN KEY(RULEID)
       REFERENCES GEE_HARDCODEDRULE(RULEID)
);

CREATE TABLE RULE_TRIGGER_ACTION (
  ID BIGINT NOT NULL AUTO_INCREMENT,
  RULEID BIGINT NOT NULL,
  NAME VARCHAR(64)  NOT NULL,
  DEVICEID VARCHAR(26) NOT NULL,
  ACTION BIT NOT NULL,
  CONTROLS VARCHAR(255) DEFAULT NULL,
  STOP_SCHEDULE_JOBS BIT NOT NULL,
  STOP_SCHEDULE_JOBS_MINUTES INT DEFAULT NULL,
  STOP_UNINSTALL_JOBS BIT NOT NULL,
  STOP_UNINSTALL_JOBS_MINUTES INT DEFAULT NULL,
  NOTIFY_TYPE TINYINT NOT NULL,
  SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL,
  CONSTRAINT PK_RULE_TRIGGER_ACTION PRIMARY KEY (ID),
  CONSTRAINT FK_RULE_TRIGGER_ACTION_1 FOREIGN KEY (RULEID)
                          REFERENCES RULEINFO (RULEID)
);
CREATE INDEX IX_RULE_TRIGGER_ACTION_1 ON RULE_TRIGGER_ACTION(SYNCSTATUS ASC);

CREATE TABLE INVERTERPROFILE (
	 PROFILEID	BIGINT	NOT NULL AUTO_INCREMENT
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT NOT NULL
	,VALUE	VARCHAR(500)	NULL
	,ATTRTYPE	CHAR(1)	NOT NULL
	,REPORTTIME	TIMESTAMP	NOT NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CONSTRAINT PK_INVERTERPROFILE PRIMARY KEY (PROFILEID)
	,CONSTRAINT FK_INVERTERPROFILE_1 FOREIGN KEY (DEVICELISTID)
                REFERENCES  DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_INVERTERPROFILE_1 ON INVERTERPROFILE(DEVICELISTID ASC ,ATTRID ASC);
CREATE  INDEX IX_INVERTERPROFILE_2 ON INVERTERPROFILE(SYNCSTATUS ASC);
CREATE TABLE INVERTERNUMBERINFO (
	 REPORTTIME	TIMESTAMP	NOT NULL
	,PROFILEID	BIGINT NOT NULL
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT	NOT NULL
	,VALUE	DECIMAL(20,6)	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,CONSTRAINT PK_INVERTERNUMBERINFO PRIMARY KEY(REPORTTIME,PROFILEID)
);
CREATE INDEX IX_INVERTERNUMBERINFO_2 ON INVERTERNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE INVERTERSTRINGINFO (
	 REPORTTIME	TIMESTAMP	NOT NULL
	,PROFILEID	BIGINT	NOT NULL
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT	NOT NULL
	,VALUE	VARCHAR(500)	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,CONSTRAINT PK_INVERTERSTRINGINFO PRIMARY KEY(REPORTTIME,PROFILEID)
);
CREATE INDEX IX_INVERTERSTRINGINFO_2 ON INVERTERSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;


CREATE TABLE INVERTEREVENT(
	 EVENTID	BIGINT	NOT NULL AUTO_INCREMENT
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT 	NOT NULL
	,VALUE	VARCHAR(100)	NULL
	,REPORTTIME	TIMESTAMP	NOT NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,CONSTRAINT PK_INVERTEREVENT PRIMARY KEY(EVENTID)
	,CONSTRAINT FK_INVERTEREVENT_1 FOREIGN KEY (DEVICELISTID)
                REFERENCES  DEVICELIST (LISTID)
);
CREATE UNIQUE INDEX UQ_INVERTEREVENT_1 ON INVERTEREVENT(DEVICELISTID ASC,ATTRID ASC);

CREATE TABLE INVERTEREVENTINFO(
	 REPORTTIME	TIMESTAMP	NOT NULL
	,EVENTID	BIGINT	NOT NULL
	,DEVICELISTID	BIGINT	NOT NULL
	,ATTRID	BIGINT	NOT NULL
	,VALUE	VARCHAR(100)	NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,CONSTRAINT PK_INVERTEREVENTINFO PRIMARY KEY(REPORTTIME,EVENTID)
);
CREATE INDEX IX_INVERTEREVENTINFO_2 ON INVERTEREVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC )  ;

CREATE TABLE INVERTERSTATISTICINFO
(
   CREATETIME	TIMESTAMP	NOT NULL
 , UPDATETIME	TIMESTAMP	NOT NULL
 , STATISTICTIME	TIMESTAMP	NOT NULL
 , TIMEZONE	VARCHAR(10)	NOT NULL
 , STATISTICTYPE	SMALLINT	NOT NULL
 , PROFILEID	BIGINT	NOT NULL
 , DEVICELISTID	BIGINT	NOT NULL
 , ATTRID	BIGINT	NOT NULL
 , SUM	NUMERIC(20, 6)	NOT NULL
 , COUNT	BIGINT	NOT NULL
 , MIN	NUMERIC(20, 6)	NOT NULL
 , MAX	NUMERIC(20, 6)	NOT NULL
 , CONSTRAINT PK_INVERTERSTATISTICINFO PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
);
CREATE INDEX IX_INVERTERSTATISTICINFO_1 ON INVERTERSTATISTICINFO(DEVICELISTID,ATTRID,STATISTICTIME) ;

CREATE TABLE IRPROFILE (
       PROFILEID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , ATTRTYPE CHAR(1) NOT NULL
     , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
     , CONSTRAINT PK_IRPROFILE PRIMARY KEY (PROFILEID)
     , CONSTRAINT FK_IRPROFILE_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);

CREATE UNIQUE INDEX UQ_IRPROFILE_1 ON IRPROFILE (DEVICELISTID ASC, ATTRID ASC);
CREATE  INDEX IX_IRPROFILE_2 ON IRPROFILE(SYNCSTATUS ASC);

CREATE TABLE IRNUMBERINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE DECIMAL(20,6)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_IRNUMBERINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_IRNUMBERINFO_3 ON IRNUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;


CREATE TABLE IRSTRINGINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , PROFILEID BIGINT NOT NULL
	 , DEVICELISTID BIGINT NOT NULL
	 , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(500)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_IRSTRINGINFO PRIMARY KEY (PROFILEID, REPORTTIME)
);
CREATE INDEX IX_IRSTRINGINFO_3 ON IRSTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE IREVENT (
       EVENTID BIGINT NOT NULL AUTO_INCREMENT
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
	 , REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
	 , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_IREVENT PRIMARY KEY (EVENTID)
     , CONSTRAINT FK_IREVENT_1 FOREIGN KEY (DEVICELISTID)
                  REFERENCES DEVICELIST (LISTID)
);

CREATE UNIQUE INDEX UQ_IREVENT_1 ON IREVENT (DEVICELISTID ASC, ATTRID ASC);


CREATE TABLE IREVENTINFO (
       REPORTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , EVENTID BIGINT NOT NULL
     , DEVICELISTID BIGINT NOT NULL
     , ATTRID BIGINT NOT NULL
     , VALUE VARCHAR(100)
     , UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
     , CONSTRAINT PK_IREVENTINFO PRIMARY KEY (EVENTID, REPORTTIME)
);
CREATE INDEX IX_IREVENTINFO_3 ON IREVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC ) ;

CREATE TABLE TOBECLEAREDDEVICELIST(
	ID	BIGINT	NOT NULL AUTO_INCREMENT
	,DEVICEID	VARCHAR(25)	NOT NULL
	,CATEGORY	VARCHAR(20)	NOT NULL
	,LISTID	BIGINT	NOT NULL
	,METERID	BIGINT	NULL
	,STATUS	VARCHAR(1)	NOT NULL
	,UPDATETIME	TIMESTAMP	NOT NULL
	,CONSTRAINT PK_TOBECLEAREDDEVICELIST PRIMARY KEY (ID)
);
CREATE INDEX IX_TOBECLEAREDDEVICELIST_1 ON TOBECLEAREDDEVICELIST(DEVICEID);
CREATE INDEX IX_TOBECLEAREDDEVICELIST_2 ON TOBECLEAREDDEVICELIST(CATEGORY);
CREATE INDEX IX_TOBECLEAREDDEVICELIST_3 ON TOBECLEAREDDEVICELIST(STATUS);

-- -----------------------------------------------------
--  DDL FOR YESEE
-- ------------------------------------------------------

CREATE TABLE SIT_AREA (
  ID  BIGINT  NOT NULL  AUTO_INCREMENT
  ,AREANAME VARCHAR(70)  NOT NULL
  ,QRCODE VARCHAR(64)   NULL
  ,GROUPID  BIGINT  NOT NULL
  ,AREAID BIGINT  NULL
  ,APSSID VARCHAR(64)  NULL
  ,APSIGNAL BIGINT  NULL
  ,SUPERVISOR BIGINT  NULL
  ,CREATEUSERID BIGINT  NOT NULL
  ,CREATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,UPDATEUSERID BIGINT  NOT NULL
  ,UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,CONSTRAINT PK_SIT_AREA PRIMARY KEY (ID)
  ,CONSTRAINT FK_SIT_AREA_1 FOREIGN KEY (GROUPID)
        REFERENCES GROUPINFO(GROUPID)
  ,CONSTRAINT FK_SIT_AREA_2 FOREIGN KEY (AREAID)
        REFERENCES SIT_AREA(ID)
  ,CONSTRAINT FK_SIT_AREA_3 FOREIGN KEY (SUPERVISOR)
        REFERENCES USERINFO(ID)
  ,CONSTRAINT FK_SIT_AREA_4 FOREIGN KEY (CREATEUSERID)
        REFERENCES USERINFO(ID)
  ,CONSTRAINT FK_SIT_AREA_5 FOREIGN KEY (UPDATEUSERID)
        REFERENCES USERINFO(ID)
);
CREATE UNIQUE INDEX UQ_SIT_AREA_1 ON SIT_AREA(QRCODE);

CREATE TABLE DEPARTMENTINFO(
   ID BIGINT  NOT NULL  AUTO_INCREMENT
  ,DEPARTMENTNAME VARCHAR(70)  NOT NULL
  ,GROUPID  BIGINT  NOT NULL
  ,SUPERVISOR BIGINT  NOT NULL
  ,CREATEUSERID BIGINT  NOT NULL
  ,CREATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,UPDATEUSERID BIGINT  NOT NULL
  ,UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,CONSTRAINT PK_DEPARTMENTINFO PRIMARY KEY (ID)
  ,CONSTRAINT FK_DEPARTMENTINFO_1 FOREIGN KEY (GROUPID)
        REFERENCES GROUPINFO(GROUPID)
  ,CONSTRAINT FK_DEPARTMENTINFO_2 FOREIGN KEY (SUPERVISOR)
        REFERENCES USERINFO(ID)
);
CREATE TABLE SIT_CHECKITEM (
   ID BIGINT  NOT NULL  AUTO_INCREMENT
  ,STATIONID  BIGINT  NOT NULL
  ,CHECKITEMNAME  VARCHAR(64)  NOT NULL
  ,CHECKTYPE  CHAR(1) NOT NULL
  ,CREATEUSERID BIGINT  NOT NULL
  ,CREATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,UPDATEUSERID BIGINT  NOT NULL
  ,UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,CONSTRAINT PK_SIT_CHECKITEM PRIMARY KEY (ID)
  ,CONSTRAINT FK_SIT_CHECKITEM_1 FOREIGN KEY (STATIONID)
        REFERENCES SIT_AREA(ID)
  ,CONSTRAINT FK_SIT_CHECKITEM_2 FOREIGN KEY (CREATEUSERID)
        REFERENCES USERINFO(ID)
  ,CONSTRAINT FK_SIT_CHECKITEM_3 FOREIGN KEY (UPDATEUSERID)
        REFERENCES USERINFO(ID)
);

CREATE TABLE SIT_SCHEDULE(
   ID BIGINT  NOT NULL  AUTO_INCREMENT
  ,STATIONUNITID  BIGINT  NOT NULL
  ,SCHEDULENAME VARCHAR(64)  NULL
  ,PERIODSTART  TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,PERIODEND  TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,TIMESTART  VARCHAR(8) NOT NULL
  ,TIMEEND  VARCHAR(8) NOT NULL
  ,OPERATORUSERID BIGINT  NOT NULL
  ,CYCLETYPE  CHAR(1) NOT NULL
  ,CYCLEVALUE VARCHAR(64)  NOT NULL
  ,CREATEUSERID BIGINT  NOT NULL
  ,CREATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,UPDATEUSERID BIGINT  NOT NULL
  ,UPDATETIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,CONSTRAINT PK_SIT_SCHEDULE PRIMARY KEY (ID)
  ,CONSTRAINT FK_SIT_SCHEDULE_1 FOREIGN KEY (STATIONUNITID)
        REFERENCES SIT_AREA(ID)
  ,CONSTRAINT FK_SIT_SCHEDULE_2 FOREIGN KEY (OPERATORUSERID)
        REFERENCES USERINFO(ID)
  ,CONSTRAINT FK_SIT_SCHEDULE_3 FOREIGN KEY (CREATEUSERID)
        REFERENCES USERINFO(ID)
  ,CONSTRAINT FK_SIT_SCHEDULE_4 FOREIGN KEY (UPDATEUSERID)
        REFERENCES USERINFO(ID)
);
CREATE INDEX IX_SIT_SCHEDULE_1 ON SIT_SCHEDULE(PERIODSTART,PERIODEND);
CREATE INDEX IX_SIT_SCHEDULE_2 ON SIT_SCHEDULE(TIMESTART,TIMEEND);
CREATE INDEX IX_SIT_SCHEDULE_3 ON SIT_SCHEDULE(OPERATORUSERID);

CREATE TABLE SIT_CHECKRESULT(
   ID BIGINT  NOT NULL  AUTO_INCREMENT
  ,SCHEDULEID BIGINT  NOT NULL
  ,CHECKITEMID  BIGINT  NOT NULL
  ,VALIDSTARTTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,VALIDENDTIME TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00'
  ,OPERATETIME  TIMESTAMP NULL
  ,LASTTIMEINTERVAL BIGINT  NULL
  ,RESULT CHAR(1) DEFAULT '0' NULL
  ,IMAGEFILEPATH  VARCHAR(128)  NULL
  ,AUDIOFILEPATH  VARCHAR(128)  NULL
  ,CHECKERUSERID  BIGINT  NOT NULL
  ,CONSTRAINT PK_SIT_CHECKRESULT PRIMARY KEY(ID)
  ,CONSTRAINT FK_SIT_CHECKRESULT_1 FOREIGN KEY(SCHEDULEID)
        REFERENCES SIT_SCHEDULE(ID)
  ,CONSTRAINT FK_SIT_CHECKRESULT_2 FOREIGN KEY(CHECKITEMID)
        REFERENCES SIT_CHECKITEM(ID)
  ,CONSTRAINT FK_SIT_CHECKRESULT_3 FOREIGN KEY(CHECKERUSERID)
        REFERENCES USERINFO(ID)
);

CREATE TABLE QS_QRTZ_JOB_DETAILS
  (
    JOB_NAME  VARCHAR(200) NOT NULL,
    JOB_GROUP VARCHAR(100) NOT NULL,
    DESCRIPTION VARCHAR(250) NULL,
    JOB_CLASS_NAME   VARCHAR(250) NOT NULL,
    IS_DURABLE VARCHAR(1) NOT NULL,
    IS_VOLATILE VARCHAR(1) NOT NULL,
    IS_STATEFUL VARCHAR(1) NOT NULL,
    REQUESTS_RECOVERY VARCHAR(1) NOT NULL,
    JOB_DATA BLOB NULL,
    PRIMARY KEY (JOB_NAME,JOB_GROUP)
);

CREATE TABLE QS_QRTZ_JOB_LISTENERS
  (
    JOB_NAME  VARCHAR(200) NOT NULL,
    JOB_GROUP VARCHAR(100) NOT NULL,
    JOB_LISTENER VARCHAR(30) NOT NULL,
    PRIMARY KEY (JOB_NAME,JOB_GROUP,JOB_LISTENER),
    FOREIGN KEY (JOB_NAME,JOB_GROUP)
        REFERENCES QS_QRTZ_JOB_DETAILS(JOB_NAME,JOB_GROUP)
);

CREATE TABLE QS_QRTZ_TRIGGERS
  (
    TRIGGER_NAME VARCHAR(200) NOT NULL,
    TRIGGER_GROUP VARCHAR(100) NOT NULL,
    JOB_NAME  VARCHAR(200) NOT NULL,
    JOB_GROUP VARCHAR(100) NOT NULL,
    IS_VOLATILE VARCHAR(1) NOT NULL,
    DESCRIPTION VARCHAR(250) NULL,
    NEXT_FIRE_TIME BIGINT(13) NULL,
    PREV_FIRE_TIME BIGINT(13) NULL,
    PRIORITY INTEGER NULL,
    TRIGGER_STATE VARCHAR(16) NOT NULL,
    TRIGGER_TYPE VARCHAR(8) NOT NULL,
    START_TIME BIGINT(13) NOT NULL,
    END_TIME BIGINT(13) NULL,
    CALENDAR_NAME VARCHAR(200) NULL,
    MISFIRE_INSTR SMALLINT(2) NULL,
    JOB_DATA BLOB NULL,
    PRIMARY KEY (TRIGGER_NAME,TRIGGER_GROUP),
    FOREIGN KEY (JOB_NAME,JOB_GROUP)
        REFERENCES QS_QRTZ_JOB_DETAILS(JOB_NAME,JOB_GROUP)
);

CREATE TABLE QS_QRTZ_SIMPLE_TRIGGERS
  (
    TRIGGER_NAME VARCHAR(200) NOT NULL,
    TRIGGER_GROUP VARCHAR(100) NOT NULL,
    REPEAT_COUNT BIGINT(7) NOT NULL,
    REPEAT_INTERVAL BIGINT(12) NOT NULL,
    TIMES_TRIGGERED BIGINT(10) NOT NULL,
    PRIMARY KEY (TRIGGER_NAME,TRIGGER_GROUP),
    FOREIGN KEY (TRIGGER_NAME,TRIGGER_GROUP)
        REFERENCES QS_QRTZ_TRIGGERS(TRIGGER_NAME,TRIGGER_GROUP)
);

CREATE TABLE QS_QRTZ_CRON_TRIGGERS
  (
    TRIGGER_NAME VARCHAR(200) NOT NULL,
    TRIGGER_GROUP VARCHAR(100) NOT NULL,
    CRON_EXPRESSION VARCHAR(200) NOT NULL,
    TIME_ZONE_ID VARCHAR(80),
    PRIMARY KEY (TRIGGER_NAME,TRIGGER_GROUP),
    FOREIGN KEY (TRIGGER_NAME,TRIGGER_GROUP)
        REFERENCES QS_QRTZ_TRIGGERS(TRIGGER_NAME,TRIGGER_GROUP)
);

CREATE TABLE QS_QRTZ_BLOB_TRIGGERS
  (
    TRIGGER_NAME VARCHAR(200) NOT NULL,
    TRIGGER_GROUP VARCHAR(100) NOT NULL,
    BLOB_DATA BLOB NULL,
    PRIMARY KEY (TRIGGER_NAME,TRIGGER_GROUP),
    FOREIGN KEY (TRIGGER_NAME,TRIGGER_GROUP)
        REFERENCES QS_QRTZ_TRIGGERS(TRIGGER_NAME,TRIGGER_GROUP)
);

CREATE TABLE QS_QRTZ_TRIGGER_LISTENERS
  (
    TRIGGER_NAME  VARCHAR(200) NOT NULL,
    TRIGGER_GROUP VARCHAR(100) NOT NULL,
    TRIGGER_LISTENER VARCHAR(30) NOT NULL,
    PRIMARY KEY (TRIGGER_NAME,TRIGGER_GROUP,TRIGGER_LISTENER),
    FOREIGN KEY (TRIGGER_NAME,TRIGGER_GROUP)
        REFERENCES QS_QRTZ_TRIGGERS(TRIGGER_NAME,TRIGGER_GROUP)
);


CREATE TABLE QS_QRTZ_CALENDARS
  (
    CALENDAR_NAME  VARCHAR(200) NOT NULL,
    CALENDAR BLOB NOT NULL,
    PRIMARY KEY (CALENDAR_NAME)
);



CREATE TABLE QS_QRTZ_PAUSED_TRIGGER_GRPS
  (
    TRIGGER_GROUP  VARCHAR(200) NOT NULL,
    PRIMARY KEY (TRIGGER_GROUP)
);

CREATE TABLE QS_QRTZ_FIRED_TRIGGERS
  (
    ENTRY_ID VARCHAR(95) NOT NULL,
    TRIGGER_NAME VARCHAR(200) NOT NULL,
    TRIGGER_GROUP VARCHAR(100) NOT NULL,
    IS_VOLATILE VARCHAR(1) NOT NULL,
    INSTANCE_NAME VARCHAR(200) NOT NULL,
    FIRED_TIME BIGINT(13) NOT NULL,
    PRIORITY INTEGER NOT NULL,
    STATE VARCHAR(16) NOT NULL,
    JOB_NAME VARCHAR(200) NULL,
    JOB_GROUP VARCHAR(200) NULL,
    IS_STATEFUL VARCHAR(1) NULL,
    REQUESTS_RECOVERY VARCHAR(1) NULL,
    PRIMARY KEY (ENTRY_ID)
);

CREATE TABLE QS_QRTZ_SCHEDULER_STATE
  (
    INSTANCE_NAME VARCHAR(200) NOT NULL,
    LAST_CHECKIN_TIME BIGINT(13) NOT NULL,
    CHECKIN_INTERVAL BIGINT(13) NOT NULL,
    PRIMARY KEY (INSTANCE_NAME)
);

CREATE TABLE QS_QRTZ_LOCKS
  (
    LOCK_NAME  VARCHAR(40) NOT NULL,
    PRIMARY KEY (LOCK_NAME)
);


INSERT INTO QS_QRTZ_LOCKS VALUES('TRIGGER_ACCESS');
INSERT INTO QS_QRTZ_LOCKS VALUES('JOB_ACCESS');
INSERT INTO QS_QRTZ_LOCKS VALUES('CALENDAR_ACCESS');
INSERT INTO QS_QRTZ_LOCKS VALUES('STATE_ACCESS');
INSERT INTO QS_QRTZ_LOCKS VALUES('MISFIRE_ACCESS');

CREATE INDEX IDX_QS_QRTZ_J_REQ_RECOVERY ON QS_QRTZ_JOB_DETAILS(REQUESTS_RECOVERY);
CREATE INDEX IDX_QS_QRTZ_T_NEXT_FIRE_TIME ON QS_QRTZ_TRIGGERS(NEXT_FIRE_TIME);
CREATE INDEX IDX_QS_QRTZ_T_STATE ON QS_QRTZ_TRIGGERS(TRIGGER_STATE);
CREATE INDEX IDX_QS_QRTZ_T_NFT_ST ON QS_QRTZ_TRIGGERS(NEXT_FIRE_TIME,TRIGGER_STATE);
CREATE INDEX IDX_QS_QRTZ_T_VOLATILE ON QS_QRTZ_TRIGGERS(IS_VOLATILE);
CREATE INDEX IDX_QS_QRTZ_FT_TRIG_NAME ON QS_QRTZ_FIRED_TRIGGERS(TRIGGER_NAME);
CREATE INDEX IDX_QS_QRTZ_FT_TRIG_GROUP ON QS_QRTZ_FIRED_TRIGGERS(TRIGGER_GROUP);
CREATE INDEX IDX_QS_QRTZ_FT_TRIG_NM_GP ON QS_QRTZ_FIRED_TRIGGERS(TRIGGER_NAME,TRIGGER_GROUP);
CREATE INDEX IDX_QS_QRTZ_FT_TRIG_VOLATILE ON QS_QRTZ_FIRED_TRIGGERS(IS_VOLATILE);
CREATE INDEX IDX_QS_QRTZ_FT_TRIG_INST_NAME ON QS_QRTZ_FIRED_TRIGGERS(INSTANCE_NAME);
CREATE INDEX IDX_QS_QRTZ_FT_JOB_NAME ON QS_QRTZ_FIRED_TRIGGERS(JOB_NAME);
CREATE INDEX IDX_QS_QRTZ_FT_JOB_GROUP ON QS_QRTZ_FIRED_TRIGGERS(JOB_GROUP);
CREATE INDEX IDX_QS_QRTZ_FT_JOB_STATEFUL ON QS_QRTZ_FIRED_TRIGGERS(IS_STATEFUL);
CREATE INDEX IDX_QS_QRTZ_FT_JOB_REQ_RECOVERY ON QS_QRTZ_FIRED_TRIGGERS(REQUESTS_RECOVERY);
CREATE INDEX IDX_QS_QRTZ_T_NF_ST_MISFIRE ON QS_QRTZ_TRIGGERS(MISFIRE_INSTR,NEXT_FIRE_TIME,TRIGGER_STATE);
CREATE INDEX IDX_QS_QRTZ_T_NF_ST_MISFIRE_GRP ON QS_QRTZ_TRIGGERS(MISFIRE_INSTR,NEXT_FIRE_TIME,TRIGGER_GROUP,TRIGGER_STATE);
CREATE INDEX IDX_QS_QRTZ_T_FIRETIME_MISFIRE ON QS_QRTZ_TRIGGERS(MISFIRE_INSTR,NEXT_FIRE_TIME);






CREATE TABLE BILLBOARD (
      NEWSID  BIGINT NOT NULL
     ,NEWSTYPE  VARCHAR(1) DEFAULT '1' NOT NULL
     ,TITLE_TW  VARCHAR(60)     NULL
     ,TITLE_CN  VARCHAR(60)     NULL
     ,TITLE_EN  VARCHAR(60)     NULL
     ,TITLE_JP  VARCHAR(60)     NULL
     ,CONTENT_TW  VARCHAR(1000) NULL
     ,CONTENT_CN  VARCHAR(1000) NULL
     ,CONTENT_EN  VARCHAR(1000) NULL
     ,CONTENT_JP  VARCHAR(1000) NULL
     ,IMAGENAME   VARCHAR(100)  NULL
     ,FILENAME1   VARCHAR(100)  NULL
     ,FILENAME2   VARCHAR(100)  NULL
     ,FILENAME3   VARCHAR(100)  NULL
     ,CREATETIME  TIMESTAMP      NULL
     ,CREATER     VARCHAR(64)   NULL
     ,UPDATETIME  TIMESTAMP      NULL
     ,UPDATER     VARCHAR(64)   NULL
     ,DATEONLINE  TIMESTAMP      NULL
     ,DATEOFFLINE  TIMESTAMP     NULL
     ,ONTOP       VARCHAR(1) DEFAULT '0' NOT NULL
     ,ENABLESTATUS   VARCHAR(1) DEFAULT '1' NOT NULL
     ,DOMAIN      VARCHAR(64) NOT NULL
     ,APSYSTEM    VARCHAR(10) NOT NULL
     ,CONSTRAINT PK_BILLBOARD PRIMARY KEY (NEWSID)
);


CREATE TABLE SIT_JOBINFO (
      ID BIGINT NOT NULL  AUTO_INCREMENT
     ,SCHEDULEID  BIGINT NOT NULL
     ,AREAID  BIGINT NOT  NULL
     ,STATIONID BIGINT NOT  NULL
     ,OPERATORUSERID  BIGINT NOT NULL
     ,EXECUTIONDATE  TIMESTAMP NOT NULL  DEFAULT '0000-00-00 00:00:00'
     ,CONSTRAINT PK_SIT_JOBINFO PRIMARY KEY(ID)
     ,CONSTRAINT FK_SIT_JOBINFO_1 FOREIGN KEY(SCHEDULEID)
      REFERENCES SIT_SCHEDULE(ID)
	   ,CONSTRAINT FK_SIT_JOBINFO_2 FOREIGN KEY(AREAID)
      REFERENCES SIT_AREA(ID)
	   ,CONSTRAINT FK_SIT_JOBINFO_3 FOREIGN KEY(STATIONID)
      REFERENCES SIT_AREA(ID)
	   ,CONSTRAINT FK_SIT_JOBINFO_4 FOREIGN KEY(OPERATORUSERID)
      REFERENCES USERINFO(ID)
);
CREATE INDEX IX_SIT_JOBINFO_1 ON SIT_JOBINFO (AREAID);
CREATE INDEX IX_SIT_JOBINFO_2 ON SIT_JOBINFO (STATIONID);
CREATE INDEX IX_SIT_JOBINFO_3 ON SIT_JOBINFO (OPERATORUSERID);



CREATE TABLE LOADCLASSIFICATION (
      EMAIL VARCHAR(64) NOT NULL
     ,REPORTTIME  VARCHAR(20) NOT NULL
     ,DEVID  VARCHAR(25) NOT  NULL
     ,APPNAME VARCHAR(24) NOT  NULL
     ,PREDAPPNAME  VARCHAR(24) NOT NULL
     ,FEEDBACK VARCHAR(24) NULL
     ,ISCLICKED CHAR(1) NULL
     ,CONSTRAINT PK_LOADCLASSIFICATION_1 PRIMARY KEY(EMAIL,DEVID,REPORTTIME)
);

CREATE TABLE CLUSTER_STATISTICS (
      CLUSTERID BIGINT NOT NULL AUTO_INCREMENT
     ,AREAID BIGINT NOT NULL
     ,CLUSTERNAME VARCHAR(64) NULL
     ,ENABLESTATUS CHAR(1) DEFAULT'1' NOT NULL
     ,DEVICETYPE VARCHAR(5) NOT NULL
     ,CONSTRAINT PK_CLUSTER_STATISTICS PRIMARY KEY (CLUSTERID)
	 ,CONSTRAINT FK_CLUSTER_STATISTICS FOREIGN KEY (AREAID)
	  REFERENCES AREAINFO(AREAID)
);

CREATE TABLE CLUSTERSTATISDETAIL (
      DETAILID BIGINT NOT NULL  AUTO_INCREMENT
     ,CLUSTERID BIGINT NOT NULL
     ,LISTID BIGINT NOT NULL
     ,DETAILNAME VARCHAR(64) NULL
      ,STATSTYPE  CHAR(1) NOT NULL
      ,ATTRID BIGINT NOT NULL
      ,CONSTRAINT PK_CLUSTERSTATISDETAIL PRIMARY KEY (DETAILID)
      ,CONSTRAINT FK_CLUSTERSTATISDETAIL_1 FOREIGN KEY (CLUSTERID)
	    REFERENCES CLUSTER_STATISTICS(CLUSTERID)
	    ,CONSTRAINT FK_CLUSTERSTATISDETAIL_2 FOREIGN KEY (LISTID)
	     REFERENCES DEVICELIST(LISTID)
     );
CREATE INDEX IX_CLUSTERSTATISDETAIL_1 ON CLUSTERSTATISDETAIL(CLUSTERID,LISTID);

CREATE TABLE REPORTCONFIG (
     REPORTCONFIGID BIGINT NOT NULL AUTO_INCREMENT
	,GROUPID BIGINT NOT NULL
    ,USERID BIGINT NOT NULL
    ,CONFIGFILE BLOB NULL
    ,UPDATETIME TIMESTAMP NULL
    ,CONSTRAINT PK_REPORTCONFIG PRIMARY KEY (REPORTCONFIGID)
    ,CONSTRAINT FK_REPORTCONFIG_2 FOREIGN KEY (USERID)
    REFERENCES USERINFO(ID)
);

CREATE TABLE OUTLETSTATISTICINFO_WMY
(
   CREATETIME	TIMESTAMP	NOT NULL
 , UPDATETIME	TIMESTAMP	NOT NULL
 , STATISTICTIME	TIMESTAMP	NOT NULL
 , TIMEZONE	VARCHAR(10)	NOT NULL
 , STATISTICTYPE	SMALLINT	NOT NULL
 , PROFILEID	BIGINT	NOT NULL
 , DEVICELISTID	BIGINT	NOT NULL
 , ATTRID	BIGINT	NOT NULL
 , SUM	NUMERIC(20, 6)	NOT NULL
 , COUNT	BIGINT	NOT NULL
 , MIN	NUMERIC(20, 6)	NOT NULL
 , MAX	NUMERIC(20, 6)	NOT NULL
 , CONSTRAINT PK_OUTLETSTATISTICINFO_WMY PRIMARY KEY (STATISTICTIME,TIMEZONE,STATISTICTYPE,PROFILEID)
 );
CREATE INDEX IX_OUTLETSTATISTICINFO_WMY_1 ON OUTLETSTATISTICINFO_WMY(DEVICELISTID,ATTRID,STATISTICTIME) ;

CREATE TABLE ATTRID_MAPPING(
 MANUCODE   VARCHAR(2) NOT NULL
,DEVICETYPE VARCHAR(10) NOT NULL
,ATTRID     BIGINT      NOT NULL
,QUERYTYPE  VARCHAR(2) NOT NULL
,CREATETIME  TIMESTAMP   NULL
,DEFAULT_VIEW VARCHAR(1) NULL
,IS_MAIN VARCHAR(1) NULL
,I18N_TYPE VARCHAR(1) default '0'
,CHART_TYPE VARCHAR(1) default '0'
,CONSTRAINT PK_ATTRID_MAPPING_1 PRIMARY KEY (MANUCODE,DEVICETYPE,ATTRID,QUERYTYPE)
);

CREATE TABLE SENSORSTATISTICINFO_WMY
(
   CREATETIME	TIMESTAMP	NOT NULL
 , UPDATETIME	TIMESTAMP	NOT NULL
 , STATISTICTIME	TIMESTAMP	NOT NULL
 , TIMEZONE	VARCHAR(10)	NOT NULL
 , STATISTICTYPE	SMALLINT	NOT NULL
 , PROFILEID	BIGINT	NOT NULL
 , DEVICELISTID	BIGINT	NOT NULL
 , ATTRID	BIGINT	NOT NULL
 , SUM	NUMERIC(20, 6)	NOT NULL
 , COUNT	BIGINT	NOT NULL
 , MIN	NUMERIC(20, 6)	NOT NULL
 , MAX	NUMERIC(20, 6)	NOT NULL
 , CONSTRAINT PK_SENSORSTATISTICINFO_WMY PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
);
CREATE INDEX IX_SENSORSTATISTICINFO_WMY_1 ON SENSORSTATISTICINFO_WMY(DEVICELISTID,ATTRID,STATISTICTIME) ;
CREATE TABLE INVERTERSTATISTICINFO_WMY
(
   CREATETIME	TIMESTAMP	NOT NULL
 , UPDATETIME	TIMESTAMP	NOT NULL
 , STATISTICTIME	TIMESTAMP	NOT NULL
 , TIMEZONE	VARCHAR(10)	NOT NULL
 , STATISTICTYPE	SMALLINT	NOT NULL
 , PROFILEID	BIGINT	NOT NULL
 , DEVICELISTID	BIGINT	NOT NULL
 , ATTRID	BIGINT	NOT NULL
 , SUM	NUMERIC(20, 6)	NOT NULL
 , COUNT	BIGINT	NOT NULL
 , MIN	NUMERIC(20, 6)	NOT NULL
 , MAX	NUMERIC(20, 6)	NOT NULL
 , CONSTRAINT PK_INVERTERSTATISTICINFO_WMY PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
);
CREATE INDEX IX_INVERTERSTATISTICINFO_WMY_1 ON INVERTERSTATISTICINFO_WMY(DEVICELISTID,ATTRID,STATISTICTIME) ;


CREATE TABLE HIBERNATE_SEQUENCES (
       SEQUENCE_NAME VARCHAR(100) NOT NULL
     , NEXT_VAL BIGINT NOT NULL
     , CONSTRAINT PK_HIBERNATE_SEQUENCES PRIMARY KEY (SEQUENCE_NAME)
);



ALTER TABLE USERINFO ADD CONSTRAINT FK_USERINFO_2 FOREIGN KEY (DEPARTMENTID) REFERENCES DEPARTMENTINFO(ID);


CREATE TABLE UVIIRRAMAPPING (
       UVI SMALLINT NOT NULL
      ,IRRADIANCE DECIMAL(20,6) NOT NULL
      ,UPDATETIME TIMESTAMP NOT NULL
      ,CONSTRAINT PK_UVIIRRAMAPPING PRIMARY KEY(UVI)
);

CREATE TABLE LED_POLE_LIST (
	 POLEID      BIGINT        NOT NULL AUTO_INCREMENT
	,PLACEID     BIGINT        NULL
	,GROUPID     BIGINT        NULL
	,POLENAME    VARCHAR(20)  NULL
	,HEIGHT      VARCHAR(4)   NULL
	,LAMPID      BIGINT        NULL
	,LAMPTYPE    VARCHAR(2)   NULL
	,LAMPWATT    VARCHAR(4)   NULL
	,LAMP_NUM    VARCHAR(2)   NULL
	,BUILDDATE   TIMESTAMP     NULL
	,CREATEDATE  TIMESTAMP     NULL
	,PHOTO       VARCHAR(50)  NULL
	,CONSTRAINT PK_LED_POLE_LIST PRIMARY KEY (POLEID)
	,CONSTRAINT FK_LED_POLE_LIST_1 FOREIGN KEY (PLACEID)
    REFERENCES LED_PLACE_LIST(LPL_ID)
	,CONSTRAINT FK_LED_POLE_LIST_2 FOREIGN KEY (GROUPID)
    REFERENCES GROUPINFO(GROUPID)
);



CREATE TABLE PVSTRINGMETERSTATISTICINFO (
     CREATETIME     TIMESTAMP   NOT NULL
    ,UPDATETIME     TIMESTAMP   NOT NULL
    ,STATISTICTIME  TIMESTAMP   NOT NULL
    ,TIMEZONE       VARCHAR(10)  NOT NULL
    ,STATISTICTYPE  SMALLINT NOT NULL
    ,PROFILEID      BIGINT NOT NULL
    ,DEVICELISTID   BIGINT NOT NULL
    ,ATTRID         BIGINT NOT NULL
    ,SUM            DECIMAL NOT NULL
    ,COUNT          BIGINT NOT NULL
    ,MIN            DECIMAL NOT NULL
    ,MAX            DECIMAL NOT NULL
	,CONSTRAINT PK_PVSTRINGMETERSTATISTICINFO PRIMARY KEY(PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
);
CREATE INDEX IX_PVSMSTATISTICINFO_1 ON PVSTRINGMETERSTATISTICINFO(DEVICELISTID,ATTRID,STATISTICTIME);

CREATE TABLE PVSTRINGMETERSTATISTICINFO_WMY (
     CREATETIME     TIMESTAMP   NOT NULL
    ,UPDATETIME     TIMESTAMP   NOT NULL
    ,STATISTICTIME  TIMESTAMP   NOT NULL
    ,TIMEZONE       VARCHAR(10)  NOT NULL
    ,STATISTICTYPE  SMALLINT NOT NULL
    ,PROFILEID      BIGINT NOT NULL
    ,DEVICELISTID   BIGINT NOT NULL
    ,ATTRID         BIGINT NOT NULL
    ,SUM            DECIMAL NOT NULL
    ,COUNT          BIGINT NOT NULL
    ,MIN            DECIMAL NOT NULL
    ,MAX            DECIMAL NOT NULL
  ,CONSTRAINT PK_PVSMSTATISTICINFO_WMY PRIMARY KEY(PROFILEID,STATISTICTYPE,STATISTICTIME,TIMEZONE)
);
CREATE INDEX IX_PVSMSTATISTICINFO_WMY_1 ON PVSTRINGMETERSTATISTICINFO_WMY(DEVICELISTID,ATTRID,STATISTICTIME);

CREATE TABLE ENERGYSTORAGESTATISTICINFO (
     CREATETIME     TIMESTAMP   NOT NULL
    ,UPDATETIME     TIMESTAMP   NOT NULL
    ,STATISTICTIME  TIMESTAMP   NOT NULL
    ,TIMEZONE       VARCHAR(10)  NOT NULL
    ,STATISTICTYPE  SMALLINT NOT NULL
    ,PROFILEID      BIGINT NOT NULL
    ,DEVICELISTID   BIGINT NOT NULL
    ,ATTRID         BIGINT NOT NULL
    ,SUM            DECIMAL NOT NULL
    ,COUNT          BIGINT NOT NULL
    ,MIN            DECIMAL NOT NULL
    ,MAX            DECIMAL NOT NULL
	,CONSTRAINT PK_ESSTATISTICINFO PRIMARY KEY(PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
);
CREATE INDEX IX_ESSTATISTICINFO_1 ON ENERGYSTORAGESTATISTICINFO(DEVICELISTID,ATTRID,STATISTICTIME);

CREATE TABLE ENERGYSTORAGESTATISTICINFO_WMY (
     CREATETIME     TIMESTAMP   NOT NULL
    ,UPDATETIME     TIMESTAMP   NOT NULL
    ,STATISTICTIME  TIMESTAMP   NOT NULL
    ,TIMEZONE       VARCHAR(10)  NOT NULL
    ,STATISTICTYPE  SMALLINT NOT NULL
    ,PROFILEID      BIGINT NOT NULL
    ,DEVICELISTID   BIGINT NOT NULL
    ,ATTRID         BIGINT NOT NULL
    ,SUM            DECIMAL NOT NULL
    ,COUNT          BIGINT NOT NULL
    ,MIN            DECIMAL NOT NULL
    ,MAX            DECIMAL NOT NULL
	,CONSTRAINT PK_ESSTATISTICINFO_WMY PRIMARY KEY(PROFILEID,STATISTICTYPE,STATISTICTIME,TIMEZONE)
);
CREATE INDEX IX_ESSTATISTICINFO_WMY_1 ON ENERGYSTORAGESTATISTICINFO_WMY(DEVICELISTID,ATTRID,STATISTICTIME);

CREATE TABLE USERINFO_HISTORY (
  ID             BIGINT        NOT NULL
  ,APCATEGORY   VARCHAR(10)   NOT NULL
  ,APSYSTEM     VARCHAR(10)   NOT NULL
  ,USERNAME     VARCHAR(255)  NOT NULL
  ,CREATETIME   TIMESTAMP      NOT NULL
  ,DELETETIME   TIMESTAMP      NOT NULL
  ,CONSTRAINT PK_USERINFO_HISTORY PRIMARY KEY(ID)
);

CREATE TABLE LED_POLE_CONF(
	 SN       BIGINT NOT NULL  AUTO_INCREMENT
	,POLEID   BIGINT NOT NULL
	,DEVICEID  VARCHAR(25) NULL
	,STREETLIGHTID VARCHAR(26) NULL
	,DEVICETYPE VARCHAR(5) NOT NULL
	,CONSTRAINT PK_LED_POLE_CONF PRIMARY KEY(SN)
	,CONSTRAINT FK_LED_POLE_CONF_1 FOREIGN KEY(POLEID)
	 REFERENCES LED_POLE_LIST(POLEID)
);
CREATE TABLE LED_POLE_LAMPINFO(
	 POLEID   BIGINT NOT NULL
	,LAMPID   BIGINT NOT NULL
	,QUANTITY BIGINT NOT NULL
	,CONSTRAINT PK_LED_POLE_LAMPINFO_1 PRIMARY KEY(POLEID,LAMPID)
	,CONSTRAINT FK_LED_POLE_LAMPINFO_1 FOREIGN KEY(POLEID)
	 REFERENCES LED_POLE_LIST(POLEID)
	,CONSTRAINT FK_LED_POLE_LAMPINFO_2 FOREIGN KEY(LAMPID)
	 REFERENCES LED_LAMPS_INFO(LAMPID)
);
CREATE TABLE TAISEIAPROFILE(
	 SEQNO              BIGINT NOT NULL AUTO_INCREMENT
 	,TYPEID             BIGINT NOT NULL
	,MODELID            VARCHAR(20) NULL
	,SAANETMAINVERSION  BIGINT NOT NULL
	,SAANETSUBVERSION   BIGINT NOT NULL
	,ACTION             BIGINT NOT NULL
	,REPORTINTERVAL     BIGINT NOT NULL
	,SERVICEID          BIGINT NULL
	,REQCONTENT         VARCHAR(12) NULL
	,MINVAL             BIGINT NULL
	,MAXVAL             BIGINT NULL
	,CONSTRAINT PK_TAISEIAPROFILE PRIMARY KEY (SEQNO)
);
CREATE INDEX IX_TAISEIAPROFILE_1 ON TAISEIAPROFILE(TYPEID,SAANETMAINVERSION,SAANETSUBVERSION);

CREATE TABLE IRPANEL
(
	ID	BIGINT	NOT NULL AUTO_INCREMENT
	,NAME	VARCHAR(130 )	NULL
	,CATEGORY	VARCHAR(130)	NULL
	,BRAND	VARCHAR(100 )	NULL
	,IRTYPE	BIGINT	NULL
	,PICTUREFILE	VARCHAR(100)	NULL
	,DEVICE_ID	VARCHAR(25)	NOT NULL
	,UPDATETIME	TIMESTAMP DEFAULT '0000-00-00 00:00:00'	NOT NULL
	,CREATETIME	TIMESTAMP DEFAULT '0000-00-00 00:00:00'	NOT NULL
	,STATUS	VARCHAR(50)	NULL
	,`MODELNAME` VARCHAR(130) NULL
	,CONSTRAINT PK_IRPANEL PRIMARY KEY (ID)
);


CREATE TABLE IRCODE (
ID BIGINT	NOT NULL AUTO_INCREMENT
,DEVICELISTID BIGINT NOT NULL
,IRID INTEGER NOT NULL
,CODE VARCHAR(3000)
,NAME VARCHAR(100)
,UPDATETIME TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
,MODELATTRID BIGINT NULL
,ENABLESTATUS VARCHAR(1) DEFAULT '1' NOT NULL
,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
,REMOTECODEID BIGINT NULL
,IRPANELID BIGINT NULL
,FUNC BIGINT NULL
,CREATETIME TIMESTAMP DEFAULT '0000-00-00 00:00:00' NULL
,HWSAVEDTIME TIMESTAMP DEFAULT '0000-00-00 00:00:00' NULL
,HWSYNC VARCHAR(1)  DEFAULT '1' NOT NULL
,CONSTRAINT PK_IRCODE PRIMARY KEY (ID)
,CONSTRAINT FK_IRCODE_3 FOREIGN KEY (DEVICELISTID)
			REFERENCES DEVICELIST(LISTID)
,CONSTRAINT FK_IRCODE_4 FOREIGN KEY(IRPANELID)
      REFERENCES IRPANEL(ID)
);

CREATE TABLE IF_EVENT_LIST(
     ID           BIGINT  NOT NULL  AUTO_INCREMENT
    ,USER_ID      BIGINT  NULL
    ,CREATE_TIME  TIMESTAMP NULL DEFAULT '0000-00-00 00:00:00'
    ,UPDATE_TIME  TIMESTAMP NULL DEFAULT '0000-00-00 00:00:00'
    ,DIVISION     VARCHAR(15) NULL
    ,SECTION      VARCHAR(15) NULL
    ,EVENT_TYPE   VARCHAR(15) NULL
    ,DATA         VARCHAR(1300) NULL
    ,STATUS       VARCHAR(10) NULL
	,CONSTRAINT PK_IF_EVENT_LIST PRIMARY KEY (ID)
	);


CREATE UNIQUE INDEX UQ_IRCODE_1 ON IRCODE (DEVICELISTID ASC, IRID ASC);

CREATE TABLE CAMERAPROFILE(
	 PROFILEID     BIGINT        NOT NULL   AUTO_INCREMENT
	,DEVICELISTID  BIGINT        NOT NULL
	,ATTRID        BIGINT        NOT NULL
	,VALUE         VARCHAR(500) NULL
	,ATTRTYPE      CHAR(1)       NOT NULL
	,REPORTTIME    TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,UPDATETIME    TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
	,CONSTRAINT PK_CAMERAPROFILE PRIMARY KEY (PROFILEID)
	,CONSTRAINT FK_CAMERAPROFILE_1 FOREIGN KEY(DEVICELISTID)
	 REFERENCES DEVICELIST(LISTID)
);
CREATE UNIQUE INDEX UQ_CAMERAPROFILE_1 ON CAMERAPROFILE(DEVICELISTID ASC , ATTRID ASC ) ;
CREATE  INDEX IX_CAMERAPROFILE_2 ON CAMERAPROFILE(SYNCSTATUS ASC);

CREATE TABLE CAMERANUMBERINFO (
	 REPORTTIME   TIMESTAMP   DEFAULT '0000-00-00 00:00:00' NOT NULL
	,PROFILEID    BIGINT       NOT NULL
	,DEVICELISTID BIGINT       NOT NULL
	,ATTRID       BIGINT       NOT NULL
	,VALUE        DECIMAL(20,6)       NULL
	,UPDATETIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,CONSTRAINT PK_CAMERANUMBERINFO_1 PRIMARY KEY (REPORTTIME,PROFILEID)
);
CREATE INDEX IX_CAMERANUMBERINFO_1 ON CAMERANUMBERINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC) ;

CREATE TABLE CAMERASTRINGINFO  (
	 REPORTTIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,PROFILEID    BIGINT       NOT NULL
	,DEVICELISTID BIGINT       NOT NULL
	,ATTRID       BIGINT       NOT NULL
	,VALUE        VARCHAR(500) NULL
	,UPDATETIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,CONSTRAINT PK_CAMERASTRINGINFO_1 PRIMARY KEY (REPORTTIME,PROFILEID)
);
CREATE INDEX IX_CAMERASTRINGINFO_1 ON CAMERASTRINGINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC) ;

CREATE TABLE CAMERAEVENT(
	 EVENTID     BIGINT        NOT NULL  AUTO_INCREMENT
	,DEVICELISTID  BIGINT        NOT NULL
	,ATTRID        BIGINT        NOT NULL
	,VALUE         VARCHAR(100) NULL
	,REPORTTIME    TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
	,UPDATETIME    TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
	,CONSTRAINT PK_CAMERAEVENT PRIMARY KEY (EVENTID)
	,CONSTRAINT FK_CAMERAEVENT_1 FOREIGN KEY(DEVICELISTID)
	 REFERENCES DEVICELIST(LISTID)
);
CREATE UNIQUE INDEX UQ_CAMERAEVENT_1 ON CAMERAEVENT(DEVICELISTID ASC , ATTRID ASC ) ;

CREATE TABLE CAMERAEVENTINFO(
	 REPORTTIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,EVENTID      BIGINT       NOT NULL
	,DEVICELISTID BIGINT       NOT NULL
	,ATTRID       BIGINT       NOT NULL
	,VALUE        VARCHAR(100) NULL
	,UPDATETIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,CONSTRAINT PK_CAMERAEVENTINFO_1 PRIMARY KEY (REPORTTIME,EVENTID)
);
CREATE INDEX IX_CAMERAEVENTINFO_1 ON CAMERAEVENTINFO(DEVICELISTID ASC , ATTRID ASC, REPORTTIME ASC) ;


CREATE TABLE ACSTATISTICINFO(
   CREATETIME     TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NOT NULL
  ,UPDATETIME     TIMESTAMP  DEFAULT '0000-00-00 00:00:00'     NOT NULL
  ,STATISTICTIME  TIMESTAMP  DEFAULT '0000-00-00 00:00:00'     NOT NULL
  ,TIMEZONE   VARCHAR(10)    NOT NULL
  ,STATISTICTYPE  SMALLINT          NOT NULL
  ,PROFILEID    BIGINT          NOT NULL
  ,DEVICELISTID   BIGINT          NOT NULL
  ,ATTRID     BIGINT          NOT NULL
  ,SUM      NUMERIC(20, 6)          NOT NULL
  ,COUNT      BIGINT          NOT NULL
  ,MIN      NUMERIC(20, 6)          NOT NULL
  ,MAX      NUMERIC(20, 6)          NOT NULL
  ,CONSTRAINT PK_ACSTATISTICINFO_1 PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
  );
  CREATE INDEX IX_ACSTATISTICINFO_1 ON ACSTATISTICINFO(DEVICELISTID,ATTRID,STATISTICTIME) ;

CREATE TABLE ACSTATISTICINFO_WMY(
   CREATETIME     TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NOT NULL
  ,UPDATETIME     TIMESTAMP  DEFAULT '0000-00-00 00:00:00'     NOT NULL
  ,STATISTICTIME  TIMESTAMP  DEFAULT '0000-00-00 00:00:00'     NOT NULL
  ,TIMEZONE   VARCHAR(10)    NOT NULL
  ,STATISTICTYPE  SMALLINT          NOT NULL
  ,PROFILEID    BIGINT          NOT NULL
  ,DEVICELISTID   BIGINT          NOT NULL
  ,ATTRID     BIGINT          NOT NULL
  ,SUM      NUMERIC(20, 6)          NOT NULL
  ,COUNT      BIGINT          NOT NULL
  ,MIN      NUMERIC(20, 6)          NOT NULL
  ,MAX      NUMERIC(20, 6)          NOT NULL
  ,CONSTRAINT PK_ACSTATISTICINFO_WMY_1 PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
  );
  CREATE INDEX IX_ACSTATISTICINFO_WMY_1 ON ACSTATISTICINFO_WMY(DEVICELISTID,ATTRID,STATISTICTIME) ;

CREATE TABLE FUNCTIONBASIC (
	 FUNCID  BIGINT  NOT NULL   AUTO_INCREMENT
	,UPDATETIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
	,CREATETIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
	,FUNCDESC         VARCHAR(128)      NULL
	,ALGORITHM    SMALLINT          NOT NULL
	,ENABLED      SMALLINT      DEFAULT '1'    NOT NULL
	,GROUPID      SMALLINT          NOT NULL
	,COEFFICIENT  VARCHAR(128)   NOT NULL
	,CANCELTIME   TIMESTAMP   DEFAULT '0000-00-00 00:00:00'    NULL
	,STATTYPE SMALLINT NOT NULL
    ,TIMEZONE VARCHAR(32) NOT NULL
	,CONSTRAINT PK_FUNCTIONBASIC_1 PRIMARY KEY (FUNCID)
	);
CREATE INDEX IX_FUNCTIONBASIC_1 ON FUNCTIONBASIC(FUNCID,GROUPID) ;


CREATE TABLE QTRSTATRUNRECORD (
	 TRIGGERNAME  VARCHAR(32)  NOT NULL
	,STATTIME     TIMESTAMP    DEFAULT '0000-00-00 00:00:00' NOT NULL
	,STARTTIME    TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,ENDTIME      TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,CONSTRAINT PK_QTRSTATRUNRECORD_1 PRIMARY KEY (TRIGGERNAME,STATTIME)
	);


CREATE TABLE FUNCTIONDEVICEATTR(
	 FUNCID       BIGINT NOT NULL
	,INDEXID      SMALLINT NOT NULL
	,LISTID       BIGINT NOT NULL
	,ATTRID       BIGINT NOT NULL
	,TRIGGERNAME  VARCHAR(32) NOT NULL
	,CATEGORYGROUP SMALLINT NOT NULL
	,CONSTRAINT PK_FUNCTIONDEVICEATTR_1 PRIMARY KEY (FUNCID,INDEXID)
	,CONSTRAINT FK_FUNCTIONDEVICEATTR_1 FOREIGN KEY (FUNCID)
                  REFERENCES FUNCTIONBASIC(FUNCID)
	);
CREATE INDEX IX_FUNCTIONDEVICEATTR_1 ON FUNCTIONDEVICEATTR(FUNCID) ;

CREATE TABLE FUNCTIONLASTSTATTIME(
	 FUNCID          BIGINT    NOT NULL
	,STATTIME        TIMESTAMP DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,STARTTIME       TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,COMPLETEDTIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,CONSTRAINT PK_FUNCTIONLASTSTATTIME_1 PRIMARY KEY (FUNCID,STATTIME)
	,CONSTRAINT FK_FUNCTIONLASTSTATTIME_1 FOREIGN KEY (FUNCID)
                  REFERENCES FUNCTIONBASIC(FUNCID)
	);

CREATE TABLE FUNCTIONSTATISTICS(
   ID         BIGINT       NOT NULL
  ,STATSTIME  TIMESTAMP DEFAULT '0000-00-00 00:00:00'   NOT NULL
  ,STATSTYPE  CHAR(1)      NOT NULL
  ,UPDATETIME TIMESTAMP DEFAULT '0000-00-00 00:00:00'   NOT NULL
  ,VALUE      DECIMAL(20,6)        NULL
  ,SYNCSTATUS VARCHAR(1) DEFAULT '0' NOT NULL
  ,COUNT BIGINT NULL
  ,CONSTRAINT PK_FUNCTIONSTATISTICS_1 PRIMARY KEY (ID,STATSTIME,STATSTYPE)
);

CREATE TABLE ILRULEINFO (
	 APRULEID     BIGINT NOT NULL  AUTO_INCREMENT
 	,GEERULEID    BIGINT  NULL
	,RULENAME     VARCHAR(64) NOT NULL
	,AFTERHOUR    BIGINT  NULL
	,BEFOREHOUR   BIGINT  NULL
	,RULELEVEL        BIGINT  DEFAULT '1'  NOT NULL
	,DEVICETYPE   BIGINT  NULL
	,TRIGGERTYPE  BIGINT  DEFAULT '1' NOT NULL
	,FREQUENCY    BIGINT  DEFAULT '0' NOT NULL
	,NOTIFYTYPE   BIGINT  DEFAULT '0' NOT NULL
	,RECIPIENT       VARCHAR(200)  NULL
	,RECIPIENTBYTYPE VARCHAR(500)  NULL
	,MAILCONTENT     VARCHAR(500)  NULL
	,NOTIFYTIME      BIGINT   DEFAULT '0'   NOT NULL
	,GROUPID         BIGINT      NOT NULL
	,ENABLESTATUS    VARCHAR(1) DEFAULT '1' NOT NULL
	,CREATIME        TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NOT NULL
	,UPDATETIME      TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NOT NULL
	,ISDELAYTRIGGER     VARCHAR(1)   default '0'
	,DELAYTRIGGERTIME   BIGINT       default 180
	,CONSTRAINT PK_ILRULEINFO_1 PRIMARY KEY (APRULEID)
	);



CREATE TABLE ILRULEINFODEVICERULE (
	 ID         BIGINT NOT NULL AUTO_INCREMENT
	,RANK       BIGINT     NULL
	,APRULEID   BIGINT NOT NULL
	,DEVICEID       VARCHAR(25) NOT NULL
	,ARRTID         VARCHAR(25) NOT NULL
	,OPERATOR       VARCHAR(25) NOT NULL
	,RIGHTTYPE      VARCHAR(25)  DEFAULT '1' NOT NULL
	,RIGHTDEVICEID  VARCHAR(25)  NULL
	,RIGHTATTRID    VARCHAR(25)  NULL
	,RIGHTFIXVALUE  VARCHAR(25)  NULL
	,CONSTRAINT PK_ILRULEINFODEVICERULE_1 PRIMARY KEY (ID)
	,CONSTRAINT FK_ILRULEINFODEVICERULE_1 FOREIGN KEY (APRULEID)
                  REFERENCES ILRULEINFO(APRULEID)
	);


CREATE TABLE ILRULEINFOACTOIN (
     ID          BIGINT NOT NULL  AUTO_INCREMENT
	,RANK        BIGINT NOT NULL
	,APRULEID    BIGINT NOT NULL
	,TARGETTYPE  VARCHAR(25) NOT NULL
	,TARGETID    VARCHAR(25) NOT NULL
	,ACTION      VARCHAR(25) NOT NULL
	,CONSTRAINT PK_ILRULEINFOACTOIN_1 PRIMARY KEY (ID)
	,CONSTRAINT FK_ILRULEINFOACTOIN_1 FOREIGN KEY (APRULEID)
                  REFERENCES ILRULEINFO(APRULEID)
	);

CREATE TABLE ILRULEEVENT(
	 EVENTID       BIGINT NOT NULL AUTO_INCREMENT
    ,EVENTSTATUS   BIGINT  DEFAULT '0' NOT NULL
    ,RULEID        BIGINT NOT NULL
    ,DEVICEID      VARCHAR(26) NOT NULL
    ,DEVICETYPE    VARCHAR(5)  NOT NULL
    ,REPORTTIME    TIMESTAMP  DEFAULT CURRENT_TIMESTAMP   NOT NULL
    ,HANDLEDTIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'    NULL
    ,CONFIRMEDTIME TIMESTAMP  DEFAULT '0000-00-00 00:00:00'	NULL
    ,GROUPID       BIGINT		NULL
    ,MAINID        BIGINT       NULL
    ,EVENTTYPE     BIGINT	DEFAULT '1'	NOT NULL
    ,CURRENTTIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,RULENAME VARCHAR(64) NOT NULL
    ,DEVICENAME VARCHAR(60)
	,CONSTRAINT PK_ILRULEEVENT_1 PRIMARY KEY (EVENTID)
	);
CREATE TABLE FUNCTIONSTATISTICS_DMY (
	 ID			 BIGINT        NOT NULL
	,STATSTIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
	,STATSTYPE   CHAR(1)       NOT NULL
	,UPDATETIME  TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
	,VALUE       DECIMAL(20,6)            NULL
	,SYNCSTATUS  VARCHAR(1) DEFAULT '0'  NOT NULL
	,COUNT BIGINT NULL
	,CONSTRAINT PK_FUNCTIONSTATISTICS_DMY_1 PRIMARY KEY (ID,STATSTIME,STATSTYPE)
	);

CREATE TABLE METERSTATISTICINFO(
   CREATETIME     TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NOT NULL
  ,UPDATETIME     TIMESTAMP  DEFAULT '0000-00-00 00:00:00'     NOT NULL
  ,STATISTICTIME  TIMESTAMP  DEFAULT '0000-00-00 00:00:00'     NOT NULL
  ,TIMEZONE   VARCHAR(10)    NOT NULL
  ,STATISTICTYPE  SMALLINT          NOT NULL
  ,PROFILEID    BIGINT          NOT NULL
  ,DEVICELISTID   BIGINT          NOT NULL
  ,ATTRID     BIGINT          NOT NULL
  ,SUM      NUMERIC(20, 6)          NOT NULL
  ,COUNT      BIGINT          NOT NULL
  ,MIN      NUMERIC(20, 6)          NOT NULL
  ,MAX      NUMERIC(20, 6)          NOT NULL
  ,CONSTRAINT PK_METERSTATISTICINFO_1 PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
  );
  CREATE INDEX IX_METERSTATISTICINFO_1 ON METERSTATISTICINFO(DEVICELISTID,ATTRID,STATISTICTIME) ;

CREATE TABLE METERSTATISTICINFO_WMY(
   CREATETIME     TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NOT NULL
  ,UPDATETIME     TIMESTAMP  DEFAULT '0000-00-00 00:00:00'     NOT NULL
  ,STATISTICTIME  TIMESTAMP  DEFAULT '0000-00-00 00:00:00'     NOT NULL
  ,TIMEZONE   VARCHAR(10)    NOT NULL
  ,STATISTICTYPE  SMALLINT          NOT NULL
  ,PROFILEID    BIGINT          NOT NULL
  ,DEVICELISTID   BIGINT          NOT NULL
  ,ATTRID     BIGINT          NOT NULL
  ,SUM      NUMERIC(20, 6)          NOT NULL
  ,COUNT      BIGINT          NOT NULL
  ,MIN      NUMERIC(20, 6)          NOT NULL
  ,MAX      NUMERIC(20, 6)          NOT NULL
  ,CONSTRAINT PK_METERSTATISTICINFO_WMY_1 PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
  );
  CREATE INDEX IX_METERSTATISTICINFO_WMY_1 ON METERSTATISTICINFO_WMY(DEVICELISTID,ATTRID,STATISTICTIME) ;

CREATE TABLE IN_ROLEINFO (
   ROLEID     BIGINT        NOT NULL
  ,ROLENAME   VARCHAR(60)   NULL
  ,CREATETIME TIMESTAMP  DEFAULT '0000-00-00 00:00:00'     NOT NULL
  ,UPDATETIME TIMESTAMP  DEFAULT '0000-00-00 00:00:00'      NULL
  ,ISADMIN    CHAR(1)  NOT NULL
  ,CONSTRAINT PK_IN_ROLEINFO_1 PRIMARY KEY (ROLEID)
  );

CREATE TABLE IN_FUNCTIONMENU(
   FUNCTIONID      VARCHAR(10)  NOT NULL
  ,FUNCTIONNAME    VARCHAR(50)   NULL
  ,FUNCTIONURL     VARCHAR(50)   NULL
  ,FUNCTIONORDER   BIGINT         NULL
  ,PARENTFUNCTION  VARCHAR(10)   NULL
  ,CREATETIME      TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NOT NULL
  ,UPDATETIME      TIMESTAMP  DEFAULT '0000-00-00 00:00:00'      NULL
  ,CONSTRAINT PK_IN_FUNCTIONMENU_1 PRIMARY KEY (FUNCTIONID)
  ,CONSTRAINT FK_IN_FUNCTIONMENU_1 FOREIGN KEY (PARENTFUNCTION)
                  REFERENCES IN_FUNCTIONMENU(FUNCTIONID)
  );
CREATE INDEX IX_IN_FUNCTIONMENU_1 ON IN_FUNCTIONMENU (PARENTFUNCTION ASC);

CREATE TABLE IN_USERROLE (
   USERID BIGINT NOT NULL
  ,ROLEID BIGINT NOT NULL
  ,CONSTRAINT PK_IN_USERROLE_1 PRIMARY KEY (USERID,ROLEID)
  ,CONSTRAINT FK_IN_USERROLE_1 FOREIGN KEY (USERID)
                  REFERENCES USERINFO(ID)
    ,CONSTRAINT FK_IN_USERROLE_2 FOREIGN KEY (ROLEID)
                  REFERENCES IN_ROLEINFO(ROLEID)
  );

CREATE TABLE IN_GROUPROLE (
   GROUPID BIGINT NOT NULL
  ,ROLEID BIGINT NOT NULL
  ,CONSTRAINT PK_IN_GROUPROLE_1 PRIMARY KEY (GROUPID,ROLEID)
  ,CONSTRAINT FK_IN_GROUPROLE_1 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO(GROUPID)
    ,CONSTRAINT FK_IN_GROUPROLE_2 FOREIGN KEY (ROLEID)
                  REFERENCES IN_ROLEINFO(ROLEID)
  );
CREATE TABLE IN_ROLEFUNCTION (
   FUNCTIONID VARCHAR(10) NOT NULL
  ,ROLEID BIGINT NOT NULL
  ,CONSTRAINT PK_IN_ROLEFUNCTION_1 PRIMARY KEY (FUNCTIONID,ROLEID)
  ,CONSTRAINT FK_IN_ROLEFUNCTION_1 FOREIGN KEY (FUNCTIONID)
                  REFERENCES IN_FUNCTIONMENU(FUNCTIONID)
    ,CONSTRAINT FK_IN_ROLEFUNCTION_2 FOREIGN KEY (ROLEID)
                  REFERENCES IN_ROLEINFO(ROLEID)
  );

CREATE TABLE SCHEDULEDELETEDEVICEDATA (
  ID             BIGINT        NOT NULL AUTO_INCREMENT
  ,DEVICEID      VARCHAR(30)  NOT NULL
  ,DEVICELISTID  BIGINT        NOT NULL
  ,METERID       BIGINT         NULL
  ,DEVICETYPE    VARCHAR(5)   NOT NULL
  ,CREATETIME    TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
  ,DELETETIME    TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
  ,STATUS        VARCHAR(1)   NOT NULL
  ,CONSTRAINT PK_SCHEDULEDELETEDEVICEDATA_1 PRIMARY KEY (ID)
  );

CREATE TABLE DISCONNECTCUSTOMER (
	 DEVICEID   VARCHAR(25) NOT NULL
	,USERID     BIGINT       NOT NULL
	,NOTIFYTYPE BIGINT       NOT NULL
	,MAIL_LOCALE VARCHAR(8) DEFAULT 'en_us' NOT NULL
	,CONSTRAINT PK_DISCONNECTCUSTOMER_1 PRIMARY KEY (DEVICEID,USERID,NOTIFYTYPE)
);

CREATE TABLE DEVELOPER_RESOURCE_ACCOUNT (
	 DEVELOPERID  BIGINT     NOT NULL
	,USERID       BIGINT     NOT NULL
	,CREATETIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,TOKEN        VARCHAR(256) NOT NULL
	,EXPIRETIME   BIGINT NOT NULL
	,CONSTRAINT PK_DEVELOPER_RESOURCE_A_1 PRIMARY KEY (DEVELOPERID,USERID)
	,CONSTRAINT FK_DEVELOPER_RESOURCE_A_1 FOREIGN KEY (DEVELOPERID)
				REFERENCES USERINFO(ID)
	,CONSTRAINT FK_DEVELOPER_RESOURCE_A_2 FOREIGN KEY (USERID)
				REFERENCES USERINFO(ID)
  );
CREATE TABLE LED_POLE_PROJECT (
   PROJECTID    BIGINT        NOT NULL AUTO_INCREMENT
  ,PROJECTNAME  VARCHAR(30)  NULL
  ,GROUPID      BIGINT        NULL
  ,CREATETIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'    NULL
  ,EXPORTSTATUS CHAR(1) DEFAULT '0' NULL
  ,EXPORTTIME TIMESTAMP DEFAULT '0000-00-00 00:00:00' NULL
  ,CONSTRAINT PK_LED_POLE_PROJECT_1 PRIMARY KEY (PROJECTID)
  ,CONSTRAINT FK_LED_POLE_PROJECT_1 FOREIGN KEY (GROUPID)
        REFERENCES GROUPINFO(GROUPID)
  );
CREATE TABLE LED_POLE_IMPORT (
	 ID              BIGINT   NOT NULL   AUTO_INCREMENT
	,POLEID          VARCHAR(20)   NULL
	,CONTROLLERID    VARCHAR(20)   NULL
	,LATITUDE        BIGINT   NULL
	,LONGITUDE      BIGINT   NULL
	,BUILDDATE       TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NULL
	,IMPORTTIME      TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NULL
	,PHOTOFILE       VARCHAR(300)   NULL
    ,STATUS          CHAR(1)   DEFAULT '0' NULL
	,PROJECTID       BIGINT      NOT NULL
	,ADDRESS VARCHAR(500)  NULL
	,ERRCODE VARCHAR(8)  DEFAULT '0000'
	,LAMPID   BIGINT
	,VOLTAGE  VARCHAR(3)
	,OLD_LAMP VARCHAR(50)
	,OLD_W    BIGINT
	,CONSTRAINT PK_LED_POLE_IMPORT_1 PRIMARY KEY (ID)
	,CONSTRAINT FK_LED_POLE_IMPORT_1 FOREIGN KEY (PROJECTID)
					REFERENCES LED_POLE_PROJECT(PROJECTID)
	,CONSTRAINT FK_LED_POLE_IMPORT_2 FOREIGN KEY (LAMPID)
			        REFERENCES LED_LAMPS_INFO(LAMPID)
  );
CREATE TABLE GROWTH_TRENDS_STATISTICS (
   GROUPID        BIGINT      NOT NULL
  ,STATISTICTIME  TIMESTAMP DEFAULT '0000-00-00 00:00:00'  NOT NULL
  ,DEVICECOUNT    BIGINT    DEFAULT '0'  NOT NULL
  ,USERCONUT      BIGINT    DEFAULT '0'  NOT NULL
  ,CREATETIME     TIMESTAMP DEFAULT '0000-00-00 00:00:00'  NOT NULL
  ,UPDATETIME     TIMESTAMP DEFAULT '0000-00-00 00:00:00'  NOT NULL
  ,CONSTRAINT PK_GROWTH_TRENDS_STATISTICS_1 PRIMARY KEY (GROUPID,STATISTICTIME)
);
CREATE TABLE LED_CTRL_REPLACE_INFO (
     ID            BIGINT        NOT NULL  AUTO_INCREMENT
    ,DEVICEID      VARCHAR(30)   NULL
    ,DCID           BIGINT        NULL
    ,CREATE_DATE   TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NULL
    ,REPLACE_DATE  TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NULL
    ,CONSTRAINT PK_LED_CTRL_REPLACE_INFO_1 PRIMARY KEY (ID)
);
CREATE TABLE LIGHTSTATISTICS (
	 DEVICEID     VARCHAR(30) NOT NULL
	,STATSTIME    TIMESTAMP DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,STATSTYPE    CHAR(1)     NOT NULL
	,UPDATETIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00'  NULL
	,TOTALENERGY  DECIMAL(20,6)      NULL
	,POWERRATE    DECIMAL(20,6)      NULL
	,CO2          DECIMAL(20,6)      NULL
	,CONSTRAINT PK_LIGHTSTATISTICS_1 PRIMARY KEY (DEVICEID,STATSTIME,STATSTYPE)
);
CREATE INDEX IX_LIGHTSTATISTICS_1 ON LIGHTSTATISTICS (STATSTIME,STATSTYPE);
CREATE INDEX IX_LIGHTSTATISTICS_3 ON LIGHTSTATISTICS (STATSTIME);


CREATE TABLE LIGHTSTATISTICINFO_WMY
(
   CREATETIME	TIMESTAMP DEFAULT '0000-00-00 00:00:00'	NOT NULL
 , UPDATETIME	TIMESTAMP DEFAULT '0000-00-00 00:00:00'	NOT NULL
 , STATISTICTIME	TIMESTAMP DEFAULT '0000-00-00 00:00:00'	NOT NULL
 , TIMEZONE	VARCHAR(10)	NOT NULL
 , STATISTICTYPE	SMALLINT	NOT NULL
 , PROFILEID	BIGINT	NOT NULL
 , DEVICELISTID	BIGINT	NOT NULL
 , ATTRID	BIGINT	NOT NULL
 , SUM	NUMERIC(20, 6)	NOT NULL
 , COUNT	BIGINT	NOT NULL
 , MIN	NUMERIC(20, 6)	NOT NULL
 , MAX	NUMERIC(20, 6)	NOT NULL
 , CONSTRAINT PK_LIGHTSTATISTICINFO_WMY PRIMARY KEY (PROFILEID,STATISTICTIME,TIMEZONE,STATISTICTYPE)
);
CREATE INDEX IX_LIGHTSTATISTICINFO_WMY_1 ON LIGHTSTATISTICINFO_WMY(DEVICELISTID,ATTRID,STATISTICTIME) ;

CREATE TABLE DEVICE_ROLE(
ROLEID BIGINT NOT NULL
,DEVICEID VARCHAR(25) NOT NULL
,CONSTRAINT PK_DEVICE_ROLE_1 PRIMARY KEY (ROLEID,DEVICEID)
);

CREATE TABLE RECALC_BASIC (
     TICKETID       BIGINT        NOT NULL  AUTO_INCREMENT
    ,CREATETIME     TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,UPDATETIME     TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,TRIGGERNAME    VARCHAR(36)  NOT NULL
    ,DATE0          VARCHAR(36)  NOT NULL
    ,DATE1          VARCHAR(36)  NOT NULL
    ,COMPLETEDTIME  TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NULL
    ,RUNMIDTIME     TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NULL
	,CONSTRAINT PK_RECALC_BASIC_1 PRIMARY KEY(TICKETID)
);
CREATE TABLE RECALC_DEVICEINFO  (
     TICKETID       BIGINT        NOT NULL
     ,LISTID         BIGINT        NOT NULL
	,CONSTRAINT PK_RECALC_DEVICEINFO_1 PRIMARY KEY(TICKETID,LISTID)
);
CREATE TABLE IP_CAM_INFO(
     GROUPID    BIGINT       NOT NULL
    ,CAM1_URL   VARCHAR(128) NULL
    ,CAM1_NAME  VARCHAR(128) NULL
    ,CAM2_URL   VARCHAR(128) NULL
    ,CAM2_NAME  VARCHAR(128) NULL
    ,CAM3_URL   VARCHAR(128) NULL
    ,CAM3_NAME  VARCHAR(128) NULL
    ,CAM4_URL   VARCHAR(128) NULL
    ,CAM4_NAME  VARCHAR(128) NULL
    ,CAM5_URL   VARCHAR(128) NULL
    ,CAM5_NAME  VARCHAR(128) NULL
    ,CAM6_URL   VARCHAR(128) NULL
    ,CAM6_NAME  VARCHAR(128) NULL
    ,CAM7_URL   VARCHAR(128) NULL
    ,CAM7_NAME  VARCHAR(128) NULL
    ,CAM8_URL   VARCHAR(128) NULL
    ,CAM8_NAME  VARCHAR(128) NULL
    ,CONSTRAINT PK_IP_CAM_INFO PRIMARY KEY (GROUPID)
);

CREATE TABLE IPCAM_INFO(
	 GROUPID     BIGINT NOT NULL
	,CHANNEL     BIGINT NOT NULL
	,CAM_URL    VARCHAR(128) NOT NULL
	,CAM_NAME   VARCHAR(128) NULL
	,USERNAME    VARCHAR(32)  NULL
	,PASSWORD    VARCHAR(32)  NULL
	,CONSTRAINT PK_IPCAM_INFO_1 PRIMARY KEY (GROUPID,CHANNEL)
	,CONSTRAINT FK_IPCAM_INFO_1 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO(GROUPID)
	);

CREATE TABLE DESCENDANTGROUP(
	 GROUPID     BIGINT NOT NULL
	,DESCENDANTGROUPID     BIGINT NOT NULL
	,CONSTRAINT PK_DESCENDANTGROUP_1 PRIMARY KEY (GROUPID,DESCENDANTGROUPID)
	,CONSTRAINT FK_DESCENDANTGROUP_1 FOREIGN KEY (GROUPID)
                  REFERENCES GROUPINFO(GROUPID)
    ,CONSTRAINT FK_DESCENDANTGROUP_2 FOREIGN KEY (DESCENDANTGROUPID)
                  REFERENCES GROUPINFO(GROUPID)
	);

CREATE TABLE QTRSTATRUNRECORD_PREWMY (
	 TRIGGERNAME  VARCHAR(32)  NOT NULL
	,STATTIME     TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
	,STARTTIME    TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
	,ENDTIME      TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
	,CONSTRAINT PK_QTRSTATRUNRECORD_PREWMY_1 PRIMARY KEY (TRIGGERNAME,STATTIME)
	);

CREATE TABLE QTRJOBFLAG(
	 TRIGGERNAME  VARCHAR(32)  NOT NULL
	,STATUS     SMALLINT  DEFAULT '0'   NOT NULL
	,CONSTRAINT PK_QTRJOBFLAG_1 PRIMARY KEY (TRIGGERNAME)
	);

CREATE TABLE QTRRECALCRECORD  (
     RECALCID      BIGINT         NOT NULL  AUTO_INCREMENT
    ,TRIGGERNAME   VARCHAR(32)   NOT NULL
    ,CREATETIME    TIMESTAMP DEFAULT '0000-00-00 00:00:00'      NOT NULL
    ,DATE0         VARCHAR(16)   NOT NULL
    ,DATE1         VARCHAR(16)   NOT NULL
    ,COMPLETEDTIME TIMESTAMP DEFAULT '0000-00-00 00:00:00'      NULL
    ,ISNORMALDONE  SMALLINT         NULL
	,CONSTRAINT PK_QTRRECALCRECORD_1 PRIMARY KEY (RECALCID)
	);

CREATE TABLE GROUPSTATISTICINFO (
     GROUPID         BIGINT NOT NULL AUTO_INCREMENT
    ,ATTRID          BIGINT NOT NULL
    ,CATEGORYGROUP   SMALLINT NOT NULL
    ,STATISTICTIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,STATISTICTYPE   SMALLINT NOT NULL
    ,UPDATETIME      TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,TIMEZONE        VARCHAR(10) NOT NULL
    ,SUM             DECIMAL(20,6) NOT NULL
    ,COUNT           BIGINT NOT NULL
    ,MIN             DECIMAL(20,6) NULL
    ,MAX             DECIMAL(20,6) NULL
	,CONSTRAINT PK_GROUPSTATISTICINFO_1 PRIMARY KEY (GROUPID,STATISTICTIME,ATTRID,CATEGORYGROUP,STATISTICTYPE)
);
CREATE INDEX IX_GROUPSTATISTICINFO_1 ON GROUPSTATISTICINFO (GROUPID,ATTRID,CATEGORYGROUP,STATISTICTIME);


CREATE TABLE GROUPSTATISTICINFO_HD (
     GROUPID         BIGINT NOT NULL AUTO_INCREMENT
    ,ATTRID          BIGINT NOT NULL
    ,CATEGORYGROUP   SMALLINT NOT NULL
    ,STATISTICTIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,STATISTICTYPE   SMALLINT NOT NULL
    ,UPDATETIME      TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,TIMEZONE        VARCHAR(10) NOT NULL
    ,SUM             DECIMAL(20,6) NOT NULL
    ,COUNT           BIGINT NOT NULL
    ,MIN             DECIMAL(20,6) NULL
    ,MAX             DECIMAL(20,6) NULL
	,CONSTRAINT PK_GROUPSTATISTICINFO_HD_1 PRIMARY KEY (GROUPID,STATISTICTIME,ATTRID,CATEGORYGROUP,STATISTICTYPE)
);
CREATE INDEX IX_GROUPSTATISTICINFO_HD_1 ON GROUPSTATISTICINFO_HD (GROUPID,ATTRID,CATEGORYGROUP,STATISTICTIME);


CREATE TABLE GROUPSTATISTICINFO_WMY (
     GROUPID         BIGINT NOT NULL AUTO_INCREMENT
    ,ATTRID          BIGINT NOT NULL
    ,CATEGORYGROUP   SMALLINT NOT NULL
    ,STATISTICTIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,STATISTICTYPE   SMALLINT NOT NULL
    ,UPDATETIME      TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,TIMEZONE        VARCHAR(10) NOT NULL
    ,SUM             DECIMAL(20,6) NOT NULL
    ,COUNT           BIGINT NOT NULL
    ,MIN             DECIMAL(20,6) NULL
    ,MAX             DECIMAL(20,6) NULL
	,CONSTRAINT PK_GROUPSTATISTICINFO_WMY_1 PRIMARY KEY (GROUPID,STATISTICTIME,ATTRID,CATEGORYGROUP,STATISTICTYPE)
);
CREATE INDEX IX_GROUPSTATISTICINFO_WMY_1 ON GROUPSTATISTICINFO_WMY (GROUPID,ATTRID,CATEGORYGROUP,STATISTICTIME);

CREATE TABLE GROUPCATEGORYSTATINFO  (
     GROUPID         BIGINT NOT NULL AUTO_INCREMENT
    ,CATEGORYGROUP   SMALLINT NOT NULL
    ,ATTRID       BIGINT NOT NULL
    ,CREATETIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,SETID   SMALLINT NOT NULL
    ,ENABLED     SMALLINT  DEFAULT '1' NOT NULL
    ,CANCELTIME      TIMESTAMP DEFAULT '0000-00-00 00:00:00' NULL
	,CONSTRAINT PK_GROUPCATEGORYSTATINFO_1 PRIMARY KEY (GROUPID,CATEGORYGROUP,ATTRID)
);
CREATE INDEX IX_GROUPCATEGORYSTATINFO_1 ON GROUPCATEGORYSTATINFO (GROUPID,SETID,ATTRID);

CREATE TABLE GRPCATSTATTIME  (
     GROUPID         BIGINT NOT NULL AUTO_INCREMENT
    ,CATEGORYGROUP   SMALLINT NOT NULL
    ,ATTRID          BIGINT NOT NULL
    ,STATTIME        TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,COMPLETEDTIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,CONSTRAINT PK_GRPCATSTATTIME_1 PRIMARY KEY (GROUPID,CATEGORYGROUP,ATTRID,STATTIME)
);
CREATE INDEX IX_GRPCATSTATTIME_1 ON GRPCATSTATTIME (GROUPID,STATTIME);

CREATE TABLE PUESTATISTICS (
     STATSTYPE    CHAR(1)    NOT NULL
    ,TOUTYPE      CHAR(1)      NOT NULL
    ,STATSTIME    TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,UPDATETIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00' NULL
    ,MAX          DECIMAL (20, 6)     NULL
    ,MIN          DECIMAL (20, 6)     NULL
    ,AVG          DECIMAL (20, 6)     NULL
    ,TOTALENERGY  DECIMAL (20, 6)     NULL
    ,ITENERGY     DECIMAL (20, 6)     NULL
    ,RECCOUNT     DECIMAL (20, 6)     NULL
    ,CONSTRAINT PK_PUESTATISTICS_1 PRIMARY KEY (STATSTYPE,TOUTYPE,STATSTIME)
);
CREATE INDEX IX_PUESTATISTICS_1 ON PUESTATISTICS (STATSTYPE,TOUTYPE,STATSTIME);

CREATE TABLE TTRI_WARPFEEDBACK (
     FEEDBACKID       BIGINT        NOT NULL  AUTO_INCREMENT
    ,WARPOPNO         VARCHAR(64)  NOT NULL
    ,WARPSPOOLNO      VARCHAR(30)  NOT NULL
    ,ORDERNO          BIGINT        NOT NULL
    ,DEVICEID         VARCHAR(25)  NOT NULL
    ,DEVICENO         VARCHAR(25)  NOT NULL
    ,SHIFTTYPE        VARCHAR(1)   NULL
    ,PROCESSTYPE      VARCHAR(1)   NULL
    ,OPERATORUSER         VARCHAR(64)  NULL
    ,TEXTILENO        VARCHAR(24)  NULL
    ,PROGRESS         BIGINT        NULL
    ,WARPCOND         VARCHAR(36)  NULL
    ,GRANULARITY      BIGINT        DEFAULT '0' NOT NULL
    ,WARPCOEFFICIENT  BIGINT        DEFAULT '0' NOT NULL
    ,FINISHRATE       BIGINT        DEFAULT '0' NOT NULL
    ,INITIALLENGTH    BIGINT        NOT NULL
    ,ENDLENGTH        BIGINT        NOT NULL
    ,WARPSPEED        BIGINT        NOT NULL
    ,COMPLETEMARK     VARCHAR(18)  DEFAULT '0' NULL
    ,BORKENFILAMENT   BIGINT        DEFAULT '0' NOT NULL
    ,BORKENYARN       BIGINT        DEFAULT '0' NOT NULL
    ,ADDYARN          BIGINT        DEFAULT '0' NOT NULL
    ,OTHER            BIGINT        DEFAULT '0' NOT NULL
    ,CREATETIME       TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,ENDTIME          TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,CONSTRAINT PK_TTRI_WARPFEEDBACK_1 PRIMARY KEY (FEEDBACKID)
);
CREATE INDEX IX_TTRI_WARPFEEDBACK_1 ON TTRI_WARPFEEDBACK (WARPOPNO,DEVICEID);
CREATE TABLE TTRI_SIZINGFEEDBACK  (
     FEEDBACKID         BIGINT        NOT NULL AUTO_INCREMENT
    ,SIZINGOPNO         VARCHAR(64)  NOT NULL
    ,SIZINGSPOOLNO      VARCHAR(30)  NOT NULL
    ,ORDERNO            BIGINT        NOT NULL
    ,DEVICEID           VARCHAR(25)  NOT NULL
    ,DEVICENO           VARCHAR(25)  NOT NULL
    ,SHIFTTYPE          VARCHAR(1)   NULL
    ,PROCESSTYPE        VARCHAR(1)   NULL
    ,WARPOPNO           VARCHAR(64)  NOT NULL
    ,WARPSPOOLNO        VARCHAR(30)  NOT NULL
    ,OPERATORUSER       VARCHAR(64)  NULL
    ,TEXTILENO          VARCHAR(24)  NULL
    ,PROGRESS           BIGINT        NULL
    ,SIZINGCOND         VARCHAR(36)  NULL
    ,SIZINGSTRIP        BIGINT        NOT NULL
    ,SIZINGCOEFFICIENT  BIGINT        NOT NULL
    ,FINISHRATE         BIGINT        NOT NULL
    ,CREATETIME         TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,ENDTIME            TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,CONSTRAINT PK_TTRI_SIZINGFEEDBACK_1 PRIMARY KEY (FEEDBACKID)
);
CREATE INDEX IX_TTRI_SIZINGFEEDBACK_1 ON TTRI_SIZINGFEEDBACK  (DEVICEID,SIZINGOPNO);

CREATE TABLE TTRI_BEAMFEEDBACK  (
     FEEDBACKID       BIGINT        NOT NULL  AUTO_INCREMENT
    ,BEAMOPNO         VARCHAR(64)  NOT NULL
    ,BEAMSPOOLNO      VARCHAR(30)  NOT NULL
    ,ORDERNO          BIGINT        NOT NULL
    ,DEVICEID         VARCHAR(25)  NOT NULL
    ,DEVICENO         VARCHAR(25)  NOT NULL
    ,SHIFTTYPE        VARCHAR(1)   NULL
    ,PROCESSTYPE      VARCHAR(1)   NULL
    ,WARPOPNO         VARCHAR(64)  NOT NULL
    ,OPERATORUSER         VARCHAR(64)  NULL
    ,TEXTILENO        VARCHAR(24)  NULL
    ,PROGRESS         BIGINT        NULL
    ,WARPCOND         VARCHAR(36)  NULL
    ,QUANTITY         BIGINT        NULL
    ,COMPLETEMARK     VARCHAR(18)  NULL
    ,SIZINGSPOOLNO1   VARCHAR(30)  NULL
    ,SIZINGSPOOLNO2   VARCHAR(30)  NULL
    ,SIZINGSPOOLNO3   VARCHAR(30)  NULL
    ,SIZINGSPOOLNO4   VARCHAR(30)  NULL
    ,SIZINGSPOOLNO5   VARCHAR(30)  NULL
    ,SIZINGSPOOLNO6   VARCHAR(30)  NULL
    ,SIZINGSPOOLNO7   VARCHAR(30)  NULL
    ,SIZINGSPOOLNO8   VARCHAR(30)  NULL
    ,SIZINGSPOOLNO9   VARCHAR(30)  NULL
    ,SIZINGSPOOLNO10  VARCHAR(30)  NULL
    ,SIZINGSPOOLNO11  VARCHAR(30)  NULL
    ,SIZINGSPOOLNO12  VARCHAR(30)  NULL
    ,SIZINGSPOOLNO13  VARCHAR(30)  NULL
    ,SIZINGSPOOLNO14  VARCHAR(30)  NULL
    ,SIZINGSPOOLNO15  VARCHAR(30)  NULL
    ,SIZINGSPOOLNO16  VARCHAR(30)  NULL
    ,SIZINGSPOOLNO17  VARCHAR(30)  NULL
    ,SIZINGSPOOLNO18  VARCHAR(30)  NULL
    ,CREATETIME       TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,ENDTIME          TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,CONSTRAINT PK_TTRI_BEAMFEEDBACK_1 PRIMARY KEY (FEEDBACKID)
);
CREATE INDEX IX_TTRI_BEAMFEEDBACK_1 ON TTRI_BEAMFEEDBACK  (DEVICEID,BEAMOPNO);

CREATE TABLE TTRI_BEAMSOURCE(
     SOURCEID            BIGINT        NOT NULL  AUTO_INCREMENT
    ,FEEDBACKID           BIGINT        NOT NULL
    ,SOURCESIZINGSPOOLNO  VARCHAR(30)  NOT NULL
    ,CREATETIME           TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,CONSTRAINT PK_TTRI_BEAMSOURCE_1 PRIMARY KEY (SOURCEID)
    ,CONSTRAINT FK_TTRI_BEAMSOURCE_1 FOREIGN KEY (FEEDBACKID)
        REFERENCES TTRI_BEAMFEEDBACK(FEEDBACKID)
);

CREATE TABLE ILTRACKEREVENT (
     ID            BIGINT NOT NULL  AUTO_INCREMENT
    ,DEVICEID      VARCHAR(23) NOT NULL
    ,LAT           BIGINT  NULL
    ,LNG           BIGINT  NULL
    ,REPORTTIME    TIMESTAMP  NULL    DEFAULT '0000-00-00 00:00:00'
    ,CREATETIME    TIMESTAMP NOT NULL   DEFAULT '0000-00-00 00:00:00'
    ,CONSTRAINT PK_ILTRACKEREVENT PRIMARY KEY (ID)
    );
CREATE TABLE ILTRACKERPROJECT (
     VIRTUALSEQNUM  VARCHAR(10)  NOT NULL
    ,NAME           VARCHAR(23)  NOT NULL
    ,LOGINID        VARCHAR(50)   NULL
    ,LOGINPSWD      VARCHAR(50)   NULL
    ,DEVICECOUNT    BIGINT      DEFAULT '0'   NOT NULL
    ,CREATETIME     TIMESTAMP     NOT NULL   DEFAULT '0000-00-00 00:00:00'
    ,CONSTRAINT PK_ILTRACKERPROJECT PRIMARY KEY (VIRTUALSEQNUM)
    );

CREATE TABLE GEE_GEO_RULE (
     ID          BIGINT          NOT NULL  AUTO_INCREMENT
    ,DEVICEID    VARCHAR(30)    NOT NULL
    ,TYPE        VARCHAR(10)    NOT NULL
    ,CREATETIME  TIMESTAMP    DEFAULT '0000-00-00 00:00:00'   NULL
    ,UPDATETIME  TIMESTAMP    DEFAULT '0000-00-00 00:00:00'   NULL
    ,GEORULE     VARCHAR(1000)  NOT NULL
    ,CONSTRAINT PK_GEE_GEO_RULE_1 PRIMARY KEY (ID)
);

create table ILRoadscanProject (
     pid          VARCHAR(32)  NOT NULL
    ,projname     VARCHAR(60)  NOT NULL
    ,groupid      bigint        NOT NULL
    ,scantime     bigint        NOT NULL
    ,createtime   TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,CONSTRAINT PK_ILRoadscanProject_1 PRIMARY KEY (pid)
);

create table ILSenslinkDevicelist (
     pqid          VARCHAR(40)  NOT NULL
    ,name          VARCHAR(60)  NOT NULL
    ,groupid       bigint        NOT NULL
    ,apiurl        VARCHAR(200) NOT NULL
    ,apiid         VARCHAR(40)
    ,apikey        VARCHAR(60)
    ,devicetype    VARCHAR(5)
    ,pqcategory    VARCHAR(30)
    ,enablestatus  char(1)  default '1'
    ,createtime    TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,CONSTRAINT PK_ILSenslinkDevicelist_1 PRIMARY KEY (pqid)
);

create table DeviceShare(
     LISTID       BIGINT       NOT NULL
    ,OWNERID      BIGINT       NOT NULL
    ,SHAREDID     BIGINT       NOT NULL
    ,PERMISSION   BIGINT       DEFAULT '0' NOT NULL
    ,CREATETIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,UPDATETIME   TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,CONSTRAINT PK_DeviceShare_1 PRIMARY KEY (LISTID,OWNERID,SHAREDID)
    ,CONSTRAINT FK_DeviceShare_1 FOREIGN KEY (LISTID)
            REFERENCES DEVICELIST(LISTID)
    ,CONSTRAINT FK_DeviceShare_2 FOREIGN KEY (OWNERID)
            REFERENCES USERINFO(ID)
    ,CONSTRAINT FK_DeviceShare_3 FOREIGN KEY (SHAREDID)
          REFERENCES USERINFO(ID)
);

create table im_productlinelist (
     productlineid      BIGINT        NOT NULL AUTO_INCREMENT
    ,productlineidname  VARCHAR(64)
    ,areaid             BIGINT        NOT NULL
    ,createtime         TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,updatetime         TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,CONSTRAINT PK_im_productlinelist_1 PRIMARY KEY (productlineid)
);
create index IX_im_productlinelist_1 ON im_productlinelist(areaid);


create table im_linedevicelist(
     ldlistid       BIGINT        NOT NULL   AUTO_INCREMENT
    ,productlineid  BIGINT        NOT NULL
    ,deviceid       VARCHAR(25)  NOT NULL
    ,devicelistid   BIGINT        NOT NULL
    ,device     VARCHAR(5)   NOT NULL
    ,createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,CONSTRAINT PK_im_linedevicelist_1 PRIMARY KEY (ldlistid)
);
create index IX_im_linedevicelist_1 ON im_linedevicelist(deviceid);



create table im_linemachinelist (
     machineid     BIGINT       NOT NULL    AUTO_INCREMENT
    ,machinename   VARCHAR(64)
    ,productlineid BIGINT       NOT NULL
    ,createtime    TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime    TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,CONSTRAINT PK_im_linemachinelist_1 PRIMARY KEY (machineid)
);
create index IX_im_linemachinelist_1 ON im_linemachinelist(productlineid);


create table im_machinedevicelist  (
     listid        BIGINT       NOT NULL AUTO_INCREMENT
    ,machineid     BIGINT       NOT NULL
    ,deviceid      VARCHAR(25) NOT NULL
    ,devicelistid  BIGINT       NOT NULL
    ,device    VARCHAR(5)  NOT NULL
    ,point     VARCHAR(20)
    ,createtime    TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime    TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,CONSTRAINT PK_im_machinedevicelist_1 PRIMARY KEY (listid)
);
create index IX_im_machinedevicelist_1 ON im_machinedevicelist(deviceid);
create index IX_im_machinedevicelist_2 ON im_machinedevicelist(machineid);

create table camerastatisticinfo(
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_camerastatisticinfo_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_camerastatisticinfo_1 ON camerastatisticinfo(devicelistid,attrid,statistictime);

create table camerastatisticinfo_wmy(
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_camerastatisticinfo_wmy_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_camerastatisticinfo_wmy_1 ON camerastatisticinfo_wmy(devicelistid,attrid,statistictime);


create table TextileStatisticInfo(
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_TextileStatisticInfo_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_TextileStatisticInfo_1 ON TextileStatisticInfo(devicelistid,attrid,statistictime);

create table TextileStatisticInfo_WMY (
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_TextileStatisticInfo_WMY_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_TextileStatisticInfo_WMY_1 ON TextileStatisticInfo_WMY(devicelistid,attrid,statistictime);

create table GatewayStatisticInfo (
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_GatewayStatisticInfo_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_GatewayStatisticInfo_1 ON GatewayStatisticInfo(devicelistid,attrid,statistictime);

create table GatewayStatisticInfo_WMY (
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_GatewayStatisticInfo_WMY_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_GatewayStatisticInfo_WMY_1 ON GatewayStatisticInfo_WMY(devicelistid,attrid,statistictime);

create table CtrllerStatisticInfo (
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_CtrllerStatisticInfo_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_CtrllerStatisticInfo_1 ON CtrllerStatisticInfo(devicelistid,attrid,statistictime);

create table CtrllerStatisticInfo_WMY (
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_CtrllerStatisticInfo_WMY_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_CtrllerStatisticInfo_WMY_1 ON CtrllerStatisticInfo_WMY(devicelistid,attrid,statistictime);

create table IRStatisticInfo (
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_IRStatisticInfo_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_IRStatisticInfo_1 ON IRStatisticInfo(devicelistid,attrid,statistictime);

create table IRStatisticInfo_WMY (
     createtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,updatetime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,statistictime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,timezone       VARCHAR(10) NOT NULL
    ,statistictype  BIGINT       NOT NULL
    ,profileid      BIGINT       NOT NULL
    ,devicelistid   BIGINT       NOT NULL
    ,attrid         BIGINT       NOT NULL
    ,Sum            DECIMAL(20,6)       NOT NULL
    ,Count          BIGINT       NOT NULL
    ,Min            DECIMAL(20,6)       NOT NULL
    ,Max            DECIMAL(20,6)       NOT NULL
    ,CONSTRAINT PK_IRStatisticInfo_WMY_1 PRIMARY KEY (profileid,statistictime,timezone,statistictype)
);
create index IX_IRStatisticInfo_WMY_1 ON IRStatisticInfo_WMY(devicelistid,attrid,statistictime);

CREATE TABLE IM_GROUPPOWERINFO (
     POWERID         BIGINT        NOT NULL  AUTO_INCREMENT
    ,GROUPID         BIGINT        NOT NULL
    ,POWERSUPPLY     VARCHAR(25)  NOT NULL
    ,POWERGENERATOR  VARCHAR(25)  NOT NULL
    ,CREATETIME      TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,CONSTRAINT PK_IM_GROUPPOWERINFO PRIMARY KEY (POWERID)
);
CREATE INDEX IX_IM_GROUPPOWERINFO_1 ON IM_GROUPPOWERINFO (GROUPID ASC);

CREATE TABLE ILRuleDelayTrigger  (
     sid         BIGINT                                   NOT NULL
    ,deviceid    VARCHAR(23)                             NOT NULL
    ,apRuleId    BIGINT                                   NOT NULL
    ,createtime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,reportTime  TIMESTAMP DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,attrId      VARCHAR(25)                             NOT NULL
    ,operator    VARCHAR(25)                             NOT NULL
    ,rightvalue  FLOAT                                    NOT NULL
    ,waittime    BIGINT                                    NULL
    ,runtime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'   NULL
    ,isexecute   VARCHAR(1)                                NULL
    ,CONSTRAINT PK_ILRuleDelayTrigger  PRIMARY KEY (sid)
);

CREATE TABLE NOTICESENDER
(
	 ID				BIGINT	NOT NULL AUTO_INCREMENT
	,AP_SYSTEM		VARCHAR(100) NOT NULL
	,CHANNEL_TYPE	SMALLINT NOT NULL
	,API_KEY			VARCHAR(256) NOT NULL
	,UPDATETIME 		TIMESTAMP DEFAULT '0000-00-00 00:00:00' NOT NULL
	,CLIENT_ALIAS VARCHAR(64) DEFAULT 'A' NOT NULL
	,CONSTRAINT PK_NOTICESENDER PRIMARY KEY (ID)
);
CREATE UNIQUE INDEX UQ_NOTICESENDER_1 ON NOTICESENDER(AP_SYSTEM,CHANNEL_TYPE,CLIENT_ALIAS);

create table IN_AUTHORITYINFO(
     AUTHID      BIGINT        NOT NULL  AUTO_INCREMENT
    ,AUTHNAME    VARCHAR(64)  NOT NULL
    ,AUTHORITY   VARCHAR(512) NOT NULL
    ,CREATETIME  TIMESTAMP   DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,UPDATETIME  TIMESTAMP   DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,CONSTRAINT PK_IN_AUTHORITYINFO_1 PRIMARY KEY (AUTHID)
);

create table IN_ROLEAUTHORITY(
     ROLEID      BIGINT        NOT NULL
    ,AUTHID      BIGINT        NOT NULL
    ,CONSTRAINT PK_IN_ROLEAUTHORITY_1 PRIMARY KEY (ROLEID,AUTHID)
    ,CONSTRAINT FK_IN_ROLEAUTHORITY_1 FOREIGN KEY (ROLEID)
			REFERENCES IN_ROLEINFO(ROLEID)
    ,CONSTRAINT FK_IN_ROLEAUTHORITY_2 FOREIGN KEY (AUTHID)
			REFERENCES IN_AUTHORITYINFO(AUTHID)
);

create table IM_USAGECONDITION (
     CONDITIONID      BIGINT       NOT NULL AUTO_INCREMENT
    ,MACHINEID        BIGINT       NOT NULL
    ,CONDITIONTYPE    VARCHAR(20)  NULL
    ,ACTIONSTARTTIME  TIMESTAMP    NOT NULL
    ,ACTIONENDTIME    TIMESTAMP    NOT NULL
    ,WEEKDAY          VARCHAR(20) NOT NULL
    ,TIMEZONE         VARCHAR(20) NOT NULL
    ,CYCLENO          BIGINT       NOT NULL
    ,CREATETIME       TIMESTAMP DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,UPDATETIME       TIMESTAMP DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,CONSTRAINT PK_IM_USAGECONDITION_1 PRIMARY KEY (CONDITIONID)
);

CREATE TABLE MAINTAINSET(
	 ID              BIGINT         NOT NULL     AUTO_INCREMENT
	,CHECKITEM       VARCHAR(50)   NOT NULL
	,CHECKCOMPON     VARCHAR(50)   NOT NULL
	,CHECKPOINT      VARCHAR(50)   NOT NULL
	,CHECKFREQU      CHAR(1)        NOT NULL
	,CHECKMETHOD     VARCHAR(50)   NOT NULL
	,STANDARD        VARCHAR(50)   NOT NULL
	,INSPECTION      TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,NEXTINSPECTION  TIMESTAMP  DEFAULT '0000-00-00 00:00:00'  NOT NULL
	,RESULT          CHAR(1)        NOT NULL
	,ABNORMALISSUE   VARCHAR(255)  NOT NULL
	,PROGRESS        CHAR(1)        NOT NULL
	,GROUPID         BIGINT   NOT NULL
	,AREAID          BIGINT   NOT NULL
	,CONSTRAINT PK_MAINTAINSET_1 PRIMARY KEY (ID)
);

create table HEALTHROLE(
     ID           BIGINT  NOT NULL  AUTO_INCREMENT
    ,DEVICEID     VARCHAR(25)  NOT NULL
    ,GATEWAYID    VARCHAR(25)  NOT NULL
    ,GROUPID      BIGINT  NOT NULL
    ,DEVICETYPE   VARCHAR(25)  NOT NULL
    ,ROLETYPE     CHAR(1)  NOT NULL
    ,TYPENAME     VARCHAR(25)  NOT NULL
    ,ROLE         CHAR(1)  NULL
    ,SETKEY       CHAR(1)  NOT NULL
    ,SETVALUE     VARCHAR(25)  NOT NULL
    ,CREATETIME   TIMESTAMP  DEFAULT '0000-00-00 00:00:00' NOT NULL
    ,AREAID VARCHAR(25) NULL
    ,ATTRID VARCHAR(25) NULL
    ,SETTYPE  CHAR(1) NOT NULL
    ,CONSTRAINT PK_HEALTHROLE_1 PRIMARY KEY (ID)
    ,CONSTRAINT FK_HEALTHROLE_1 FOREIGN KEY (GROUPID)
           REFERENCES GROUPINFO(GROUPID)
);
create table Utilize_Statistics (
     StatisticTime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,StatisticType     BIGINT       NOT NULL
    ,MachineId         BIGINT       NOT NULL
    ,TimeZone          VARCHAR(10) NOT NULL
    ,UpdateTime        TIMESTAMP DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,Point2Minute      BIGINT       NULL
    ,Point3Minute      BIGINT       NULL
    ,Point4Minute      BIGINT       NULL
    ,PlanOnMinute      BIGINT       NULL
    ,UtilizedRate      DECIMAL(20,6)       NULL
    ,MachineUsageRate  DECIMAL(20,6)       NULL
    ,TotalMinute       BIGINT       NULL
    ,PlanOffMinute     BIGINT       NULL
    ,RepairMinute      BIGINT       NULL
    ,PlanOffRate       DECIMAL(20,6)       NULL
    ,OtherWorkRate     DECIMAL(20,6)       NULL
    ,Point2Rate        DECIMAL(20,6)       NULL
    ,Point3Rate        DECIMAL(20,6)       NULL
    ,Point4Rate        DECIMAL(20,6)       NULL
    ,CONSTRAINT PK_Utilize_Statistics_1 PRIMARY KEY (StatisticTime,StatisticType,MachineId)
);
create index Utilize_Statistics_1 ON Utilize_Statistics(StatisticTime,TimeZone);

create table Utilize_Statistics_MY (
     StatisticTime     TIMESTAMP DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,StatisticType     BIGINT       NOT NULL
    ,MachineId         BIGINT       NOT NULL
    ,TimeZone          VARCHAR(10) NOT NULL
    ,UpdateTime        TIMESTAMP DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,Point2Minute      BIGINT       NULL
    ,Point3Minute      BIGINT       NULL
    ,Point4Minute      BIGINT       NULL
    ,PlanOnMinute      BIGINT       NULL
    ,UtilizedRate      DECIMAL(20,6)       NULL
    ,MachineUsageRate  DECIMAL(20,6)       NULL
    ,TotalMinute       BIGINT       NULL
    ,PlanOffMinute     BIGINT       NULL
    ,RepairMinute      BIGINT       NULL
    ,PlanOffRate       DECIMAL(20,6)       NULL
    ,OtherWorkRate     DECIMAL(20,6)       NULL
    ,Point2Rate        DECIMAL(20,6)       NULL
    ,Point3Rate        DECIMAL(20,6)       NULL
    ,Point4Rate        DECIMAL(20,6)       NULL
    ,CONSTRAINT PK_Utilize_Statistics_MY_1 PRIMARY KEY (StatisticTime,StatisticType,MachineId)
);
create index Utilize_Statistics_MY_1 ON Utilize_Statistics_MY(StatisticTime,TimeZone);

create table RELATELINE(
     LINEDIAGID   BIGINT        NOT NULL AUTO_INCREMENT
    ,LINEDIAGNAME VARCHAR(100)   NULL
    ,GROUPID      BIGINT         NOT NULL
    ,SYNCSTATUS   VARCHAR(1)  DEFAULT '1' NOT NULL
    ,AREAID       BIGINT        NOT NULL
    ,CONSTRAINT PK_RELATELINE_1 PRIMARY KEY (LINEDIAGID)
);
create table RELATELINEOBJ(
     LINEOBJID      BIGINT        NOT NULL   AUTO_INCREMENT
    ,DEVICEID       VARCHAR(25)  NOT NULL
    ,PARENTLINEOBJ  BIGINT        NULL
    ,LINEDIAGID     BIGINT        NOT NULL
    ,DEVICETYPE     VARCHAR(5)   NULL
    ,SYNCSTATUS     VARCHAR(1)  DEFAULT '1' NOT NULL
    ,DEVICEID2      VARCHAR(25)  NULL
    ,AREAID         BIGINT        NOT NULL
    ,CONSTRAINT PK_RELATELINEOBJ_1 PRIMARY KEY (LINEOBJID)
);

create table AreaStatisticInfo (
     AREAID         BIGINT         NOT NULL
    ,AttrId         BIGINT         NOT NULL
    ,CategoryGroup  SMALLINT         NOT NULL
    ,StatisticTime  TIMESTAMP  DEFAULT '0000-00-00 00:00:00'      NOT NULL
    ,StatisticType  SMALLINT          NOT NULL
    ,UpdateTime     TIMESTAMP  DEFAULT '0000-00-00 00:00:00'   NOT NULL
    ,TimeZone       VARCHAR(10)     NOT NULL
    ,Sum            DECIMAL(20,6)        NOT NULL
    ,Count          BIGINT            NOT NULL
    ,Min            DECIMAL(20,6)         NULL
    ,Max            DECIMAL(20,6)         NULL
    ,CONSTRAINT PK_AreaStatisticInfo_1 PRIMARY KEY (AREAID,StatisticTime,AttrId,CategoryGroup,StatisticType)
);
create index IX_AreaStatisticInfo_1 ON AreaStatisticInfo(AREAID,AttrId,CategoryGroup,StatisticTime);
create table AreaStatisticInfo_HD (
     AREAID         BIGINT         NOT NULL
    ,AttrId         BIGINT         NOT NULL
    ,CategoryGroup  SMALLINT         NOT NULL
    ,StatisticTime  TIMESTAMP   DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,StatisticType  SMALLINT          NOT NULL
    ,UpdateTime     TIMESTAMP   DEFAULT '0000-00-00 00:00:00'     NOT NULL
    ,TimeZone       VARCHAR(10)     NOT NULL
    ,Sum            DECIMAL(20,6)        NOT NULL
    ,Count          BIGINT            NOT NULL
    ,Min            DECIMAL(20,6)         NULL
    ,Max            DECIMAL(20,6)         NULL
    ,CONSTRAINT PK_AreaStatisticInfo_HD_1 PRIMARY KEY (AREAID,StatisticTime,AttrId,CategoryGroup,StatisticType)
);
create index IX_AreaStatisticInfo_HD_1 ON AreaStatisticInfo_HD(AREAID,AttrId,CategoryGroup,StatisticTime);
create table AreaStatisticInfo_WMY (
     AREAID         BIGINT         NOT NULL
    ,AttrId         BIGINT         NOT NULL
    ,CategoryGroup  SMALLINT         NOT NULL
    ,StatisticTime  TIMESTAMP    DEFAULT '0000-00-00 00:00:00'    NOT NULL
    ,StatisticType  SMALLINT          NOT NULL
    ,UpdateTime     TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,TimeZone       VARCHAR(10)     NOT NULL
    ,Sum            DECIMAL(20,6)        NOT NULL
    ,Count          BIGINT            NOT NULL
    ,Min            DECIMAL(20,6)         NULL
    ,Max            DECIMAL(20,6)         NULL
    ,CONSTRAINT PK_AreaStatisticInfo_WMY_1 PRIMARY KEY (AREAID,StatisticTime,AttrId,CategoryGroup,StatisticType)
);
create index IX_AreaStatisticInfo_WMY_1 ON AreaStatisticInfo_WMY(AREAID,AttrId,CategoryGroup,StatisticTime);
create table DEVICE_ATTRID_MAP(
	 AREAID    BIGINT       NOT NULL
	,DEVICEID  VARCHAR(25)  NOT NULL
	,ATTRID    BIGINT       NOT NULL
	,POSX      BIGINT       NULL
	,POSY      BIGINT       NULL
	,CONSTRAINT PK_DEVICE_ATTRID_MAP_1 PRIMARY KEY (AREAID,DEVICEID,ATTRID)
);


create table LOADUTILIZE_STATISTICS (
     StatisticTime TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,StatisticType SMALLINT     NOT NULL
    ,ListId        BIGINT       NOT NULL
    ,Category      SMALLINT     NULL
    ,GroupId       varchar(10)       NOT NULL
    ,TimeZone      VARCHAR(10)  NOT NULL
    ,UpdateTime    TIMESTAMP    DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,TotalTime     BIGINT        NULL
    ,OverTime      BIGINT        NULL
    ,CONSTRAINT PK_LOADUTILIZE_STATISTICS_1 PRIMARY KEY (StatisticTime,StatisticType,ListId)
);
CREATE INDEX IX_LOADUTILIZE_STATISTICS_1 ON LOADUTILIZE_STATISTICS (StatisticTime, TimeZone ASC);

create table LOADUTIL_GRP_STATS  (
     StatisticTime TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,StatisticType SMALLINT        NOT NULL
    ,Category        SMALLINT        NOT NULL
    ,GroupId        varchar(10)        NOT NULL
    ,TimeZone      VARCHAR(10)  NOT NULL
    ,UpdateTime    TIMESTAMP   DEFAULT '0000-00-00 00:00:00'  NOT NULL
    ,TotalTime     BIGINT        NULL
    ,OverTime      BIGINT        NULL
    ,CONSTRAINT PK_LOADUTIL_GRP_STATS_1 PRIMARY KEY (StatisticTime,StatisticType,Category,GroupId)
);
CREATE INDEX IX_LOADUTIL_GRP_STATS_1 ON LOADUTIL_GRP_STATS (StatisticTime, TimeZone ASC);


DELIMITER $$

DROP TRIGGER /*!50032 IF EXISTS */ `TRI_INS_DEVICELISTEXT`$$

CREATE
    /*!50017 DEFINER = 'insnergydb'@'localhost' */
    TRIGGER `TRI_INS_DEVICELISTEXT` AFTER INSERT ON `DEVICELIST`
    FOR EACH ROW BEGIN
  INSERT INTO DEVICELISTEXT
  (LISTID,GROUPID)
  VALUES(NEW.LISTID,1);
END;
$$
DELIMITER ;

DELIMITER $$

DROP TRIGGER /*!50032 IF EXISTS */ `TRI_DEL_DEVICELISTEXT`$$

CREATE
    /*!50017 DEFINER = 'insnergydb'@'localhost' */
    TRIGGER `TRI_DEL_DEVICELISTEXT` AFTER DELETE ON `DEVICELIST`
    FOR EACH ROW BEGIN
  DELETE FROM DEVICELISTEXT WHERE LISTID=OLD.LISTID;
END;
$$

DELIMITER ;

DELIMITER $$

DROP TRIGGER  /*!50032 IF EXISTS */ TRI_UPD_TEXTILEPROFILE$$

CREATE
    TRIGGER TRI_UPD_TEXTILEPROFILE AFTER UPDATE ON TEXTILEPROFILE
    FOR EACH ROW BEGIN
      IF NEW.ATTRID ='300600' AND NEW.VALUE IS NOT NULL AND IFNULL(NEW.VALUE,'')<>IFNULL(OLD.VALUE,'') THEN
	     INSERT INTO TEXTILESTRINGINFO (REPORTTIME,PROFILEID,DEVICELISTID,ATTRID,VALUE,UPDATETIME)
	     VALUES(DATE_ADD(NEW.REPORTTIME , INTERVAL -1 SECOND),NEW.PROFILEID,NEW.DEVICELISTID,NEW.ATTRID,OLD.VALUE,NEW.UPDATETIME);
    END IF;
END;
$$

DELIMITER ;


DELIMITER $$


DROP TRIGGER /*!50032 IF EXISTS */ `TRI_INS_CUSTOMERINFOINFO`$$

CREATE
    /*!50017 DEFINER = 'insnergydb'@'localhost' */
    TRIGGER `TRI_INS_CUSTOMERINFOINFO` AFTER INSERT ON `CUSTOMERINFO`
    FOR EACH ROW BEGIN
	IF NEW.APTYPE='F' THEN
	   SELECT COUNT(*) INTO @V_CNT FROM USERINFO WHERE USERNAME= NEW.CUSTOMERID
	   AND APSYSTEM='IFA' AND APCATEGORY='F';
	   IF @V_CNT=0 THEN
			INSERT INTO USERINFO
			(APSYSTEM,APCATEGORY,USERNAME,PASSWORD,ALIASNAME,EMAIL,ENABLESTATUS,ACTIVECODE,CREATETIME,UPDATETIME,PIPN_EDITION,LOCALECODE,NOTICEMASK,TIMEZONE,ZONEID,GROUPID)
			VALUES(
			  'IFA',
			  'F',
			  NEW.CUSTOMERID,
			  NEW.CUSTOMERPWD,
			  NEW.CUSTOMERNAME,
			  IFNULL(NEW.EMAIL,' '),
			  NEW.ENABLESTATUS,
			  NEW.ACTIVECODE,
			  IFNULL(NEW.CREATETIME,CURRENT_TIMESTAMP),
			  IFNULL(IFNULL(NEW.UPDATETIME,NEW.CREATETIME),CURRENT_TIMESTAMP),
			  NEW.PIPN_EDITION,
			  NEW.LOCALECODE,
			  IFNULL(NEW.ISEMAIL,0),
			  'GMT+08:00',
			  'ASIA/TAIPEI',
			  3
			);
	   END IF;
   END IF;
END;
$$

DELIMITER ;

DELIMITER $$

DROP PROCEDURE IF EXISTS `SP_Gen_Partition`$$
CREATE DEFINER=`insnergydb`@`%` PROCEDURE `SP_Gen_Partition`()
BEGIN
    DECLARE V_STARTTIME DATE DEFAULT ADDDATE('2017-01-01',INTERVAL 0 MONTH) ;
    DECLARE V_ENDTIME DATE DEFAULT ADDDATE(CURDATE(),INTERVAL 2 MONTH) ;
    SELECT DATABASE() INTO @CURRENT_SCHEMA;
    WHILE V_STARTTIME <=V_ENDTIME DO
      SELECT COUNT(*) INTO @V_CNT FROM information_schema.PARTITIONS WHERE TABLE_SCHEMA=@CURRENT_SCHEMA AND TABLE_NAME='meterinfo2' AND partition_name=CONCAT('p',DATE_FORMAT(v_starttime,'%Y%m'));
      IF @V_CNT =0 THEN
          SET @tolong= UNIX_TIMESTAMP(ADDDATE(V_STARTTIME,INTERVAL 1 MONTH));
          SET @SqlCmd=CONCAT('ALTER TABLE `meterinfo2` ADD PARTITION (PARTITION p',DATE_FORMAT(V_STARTTIME,'%Y%m'),' VALUES  less than (',@TOLONG,'))');
          PREPARE Stmt FROM @SqlCmd;
          EXECUTE Stmt;
          DEALLOCATE PREPARE Stmt;
      END IF;
      SET V_STARTTIME=ADDDATE(V_STARTTIME,INTERVAL 1 DAY);
    END WHILE;
END$$

DELIMITER ;

CREATE EVENT event_gen_positions
    ON SCHEDULE EVERY 1 DAY STARTS '2018-01-01 00:00:00'
    DO
     CALL SP_Gen_Partition();


